{"ast":null,"code":"import { useCallback } from 'react';\nimport { useUrlParams } from '../app';\nimport { useStore } from 'effector-react';\nimport order from '../../Service/order';\nimport { useLocation } from 'react-router-dom';\nimport { $appModel, saveURLMount } from '../../Models/app';\nimport { $accountModel } from '../../Models/account-model';\nimport { getOrgOrderCartsMount } from '../../Models/order-model';\nimport { changeLoadingStatusOffering, changeOrgOfferingStatus } from '../../Models/offerings-model';\nexport function useOrgOrder() {\n  const {\n    pathname\n  } = useLocation();\n  const {\n    $detectLocationInfo\n  } = useStore($appModel);\n  const {\n    urlData: {\n      specialist_id: specId\n    }\n  } = useUrlParams();\n  const {\n    $profiles: {\n      currentProfile\n    }\n  } = useStore($accountModel);\n  const currency = currentProfile ? currentProfile.currency.code : $detectLocationInfo.currency || '';\n  const checkoutOffering = useCallback(event => {\n    const orgSpecList = event.responsible;\n\n    if (!event.loading) {\n      changeLoadingStatusOffering({\n        id: event.id,\n        status: true\n      });\n\n      if (!event.inCart) {\n        const params = {\n          org_slug_name: event.organization,\n          data: {\n            offering_id: event.id,\n            responsible_id: specId ? specId : orgSpecList[0].id\n          }\n        };\n        order.postOrgOrderCart(params).then(res => {\n          if (res) {\n            saveURLMount(pathname);\n            changeOrgOfferingStatus({\n              offering_id: params.data.offering_id,\n              status: true,\n              loadingStatus: false\n            });\n            getOrgOrderCartsMount({\n              org_slug_name: event.organization,\n              params: {\n                limit: 1,\n                offset: 0\n              },\n              clear: true\n            });\n          }\n        }).catch(e => {\n          console.log(e.response);\n        });\n      } else {\n        order.deleteOrderCart({\n          offering_id: event.id\n        }).then(res => {\n          if (res) {\n            changeOrgOfferingStatus({\n              offering_id: event.id,\n              status: false,\n              loadingStatus: false\n            });\n            getOrgOrderCartsMount({\n              org_slug_name: event.organization,\n              params: {\n                limit: 1,\n                offset: 0\n              },\n              clear: true\n            });\n          }\n        }).catch(e => {\n          console.log(e.response);\n        });\n      }\n    }\n  }, [specId, pathname]);\n  return {\n    currency,\n    checkoutOffering\n  };\n}","map":{"version":3,"sources":["/Users/zuhriddinkamilzanov/Desktop/tMed-mobile/src/Hooks/order/use-org-order.js"],"names":["useCallback","useUrlParams","useStore","order","useLocation","$appModel","saveURLMount","$accountModel","getOrgOrderCartsMount","changeLoadingStatusOffering","changeOrgOfferingStatus","useOrgOrder","pathname","$detectLocationInfo","urlData","specialist_id","specId","$profiles","currentProfile","currency","code","checkoutOffering","event","orgSpecList","responsible","loading","id","status","inCart","params","org_slug_name","organization","data","offering_id","responsible_id","postOrgOrderCart","then","res","loadingStatus","limit","offset","clear","catch","e","console","log","response","deleteOrderCart"],"mappings":"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","sourcesContent":["import {useCallback} from 'react'\nimport {useUrlParams} from '../app'\nimport {useStore} from 'effector-react'\nimport order from '../../Service/order'\nimport {useLocation} from 'react-router-dom'\nimport {$appModel, saveURLMount} from '../../Models/app'\nimport {$accountModel} from '../../Models/account-model'\nimport {getOrgOrderCartsMount} from '../../Models/order-model'\nimport {changeLoadingStatusOffering, changeOrgOfferingStatus} from '../../Models/offerings-model'\n\nexport function useOrgOrder() {\n    const {pathname} = useLocation()\n    const {$detectLocationInfo} = useStore($appModel)\n    const {urlData: {specialist_id: specId}} = useUrlParams()\n    const {$profiles: {currentProfile}} = useStore($accountModel)\n    const currency = currentProfile ? currentProfile.currency.code : $detectLocationInfo.currency || ''\n    \n    const checkoutOffering = useCallback((event) => {\n        const orgSpecList = event.responsible\n        \n        if (!event.loading) {\n            changeLoadingStatusOffering({id: event.id, status: true})\n            if (!event.inCart) {\n                const params = {\n                    org_slug_name: event.organization,\n                    data: {\n                        offering_id: event.id,\n                        responsible_id: specId ? specId : orgSpecList[0].id\n                    }\n                }\n                order.postOrgOrderCart(params)\n                    .then((res) => {\n                        if (res) {\n                            saveURLMount(pathname)\n                            changeOrgOfferingStatus({\n                                offering_id: params.data.offering_id,\n                                status: true,\n                                loadingStatus: false\n                            })\n                            getOrgOrderCartsMount({\n                                org_slug_name: event.organization,\n                                params: {limit: 1, offset: 0},\n                                clear: true\n                            })\n                        }\n                    })\n                    .catch((e) => {\n                        console.log(e.response)\n                    })\n            } else {\n                order.deleteOrderCart({offering_id: event.id})\n                    .then((res) => {\n                        if (res) {\n                            changeOrgOfferingStatus({offering_id: event.id, status: false, loadingStatus: false})\n                            getOrgOrderCartsMount({\n                                org_slug_name: event.organization,\n                                params: {limit: 1, offset: 0},\n                                clear: true\n                            })\n                        }\n                    })\n                    .catch((e) => {\n                        console.log(e.response)\n                    })\n            }\n        }\n        \n    }, [specId, pathname])\n    \n    return {\n        currency, checkoutOffering\n    }\n}"]},"metadata":{},"sourceType":"module"}