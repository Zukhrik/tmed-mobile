{"ast":null,"code":"import _objectSpread from\"/Users/zuhriddinkamilzanov/Desktop/t-med(mobile)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/zuhriddinkamilzanov/Desktop/t-med(mobile)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useUrlParams}from'../app';import{URL_KEYS,URL_VALUES}from'../../Constants';import{useCallback,useEffect,useState}from'react';import{useHistory}from'react-router-dom';import{debounce}from'../../utils/debounce-utils';import{$chatModel,chatAllGroupMount,chatAllUserMount}from'../../Models/chat-model';import{useStore}from'effector-react';var initialParams={limit:20,offset:0};export function useChatContactSearch(){var _useUrlParams=useUrlParams(),urlData=_useUrlParams.urlData;var search=urlData[URL_KEYS.SEARCH];var tab=urlData[URL_KEYS.TAB];var _useHistory=useHistory(),push=_useHistory.push,pathname=_useHistory.location.pathname;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),searchText=_useState2[0],setSearchText=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),mounted=_useState4[0],setMounted=_useState4[1];var _useStore=useStore($chatModel),result=_useStore.$searchContact.result;var getList=useCallback(function(params){var validate=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(tab){if(validate){if(tab===URL_VALUES.PEOPLE){chatAllUserMount(params);}// if(tab === URL_VALUES.ORGANIZATION) {\n//     chatAllOrgMount(params)\n// }\nif(tab===URL_VALUES.GROUP){chatAllGroupMount(params);}}else{chatAllUserMount(params);chatAllGroupMount(params);}}},[tab]);var getNextOffset=useCallback(function(){var nextOffset;if(tab===URL_VALUES.PEOPLE){nextOffset=result[URL_VALUES.PEOPLE]&&result[URL_VALUES.PEOPLE].nextOffset;}// if(tab === URL_VALUES.ORGANIZATION) {\n//     chatAllOrgMount(params)\n// }\nif(tab===URL_VALUES.GROUP){nextOffset=result[URL_VALUES.GROUP]&&result[URL_VALUES.GROUP].nextOffset;}return nextOffset;},[result,tab]);var onChange=useCallback(function(value){if(value.length>2){var query=[];var data={clear:true,params:_objectSpread(_objectSpread({},initialParams),{},{search:value})};if(tab){query.push(\"\".concat(URL_KEYS.TAB,\"=\").concat(tab));}else{query.push(\"\".concat(URL_KEYS.TAB,\"=\").concat(URL_VALUES.PEOPLE));}query.push(\"\".concat(URL_KEYS.SEARCH,\"=\").concat(value));push({pathname:pathname,search:query.join('&')});debounce(getList(data),300);}else{push(pathname);}setSearchText(value);},[push,pathname,tab,getList]);var loadMore=useCallback(function(){var nextOffset=getNextOffset();if(nextOffset){var data={params:_objectSpread(_objectSpread({},initialParams),{},{search:search,offset:nextOffset})};getList(data,true);}},[getNextOffset,search,getList]);useEffect(function(){var timeout=null;if(!mounted&&search&&search.length>2){timeout=setTimeout(function(){var data={clear:true,params:_objectSpread(_objectSpread({},initialParams),{},{search:search})};getList(data);setMounted(true);},300);}return function(){clearTimeout(timeout);timeout=null;};},[search,mounted,getList]);useEffect(function(){if(!searchText){if(search){setSearchText(search);}else{setSearchText(null);}}},[search,searchText]);return{searchText:searchText,onChange:onChange,loadMore:loadMore};}","map":null,"metadata":{},"sourceType":"module"}