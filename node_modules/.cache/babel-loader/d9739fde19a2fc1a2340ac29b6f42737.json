{"ast":null,"code":"import _toConsumableArray from\"/Users/zuhriddinkamilzanov/Desktop/t-med(mobile)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/zuhriddinkamilzanov/Desktop/t-med(mobile)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{combine,createStore}from'effector';import{fetchCommentReplyList,fetchCreateComment,fetchPost,fetchPostComments,fetchPostOfferings}from'./effects';import{storeListWithKey,storeWithKey}from'../../utils/store-utils';import{commentLikeMount,createCommentMount,deleteLikeMount,deletePostCommentMount}from'./events';import{tapeLikeMount,tapeRemoveLikesMount}from'../tape-model';var $postOfferings=createStore({loading:false,data:{},result:{},error:false}).on(fetchPostOfferings.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchPostOfferings.fail,function(state,_ref){var error=_ref.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:{}});}).on(fetchPostOfferings.done,function(state,_ref2){var result=_ref2.result,params=_ref2.params;var processed=storeListWithKey(_objectSpread({response:result.data,key:params.post_id,state:state,clear:params.clear},params.params));return _objectSpread(_objectSpread({},state),processed);});var $getPost=createStore({loading:false,data:{},result:{},forceLoading:0,error:false}).on(fetchPost.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchPost.fail,function(state,_ref3){var error=_ref3.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:{},result:{},forceLoading:state.forceLoading===2?state.forceLoading:1});}).on(fetchPost.done,function(state,_ref4){var params=_ref4.params,result=_ref4.result;var processed=storeWithKey(_objectSpread({response:result.data,key:params.post_id,state:state},params.params));return _objectSpread(_objectSpread(_objectSpread({},state),processed),{},{forceLoading:2,result:result});}).on(tapeRemoveLikesMount,function(state,_ref5){var post_id=_ref5.post_id;var data=_objectSpread({},state.data);if(data[post_id]){data[post_id]=_objectSpread(_objectSpread({},data[post_id]),{},{is_liked:false,likes_count:data[post_id].likes_count>0&&data[post_id].likes_count-1});}return _objectSpread(_objectSpread({},state),{},{data:data});}).on(tapeLikeMount,function(state,_ref6){var post_id=_ref6.post_id;var data=_objectSpread({},state.data);if(data[post_id]){data[post_id]=_objectSpread(_objectSpread({},data[post_id]),{},{is_liked:true,likes_count:data[post_id].likes_count+1});}return _objectSpread(_objectSpread({},state),{},{data:data});});var $getPostComments=createStore({loading:false,data:{},forceLoading:0,result:{},error:false}).on(fetchPostComments.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchPostComments.fail,function(state,_ref7){var error=_ref7.error;return _objectSpread(_objectSpread({},state),{},{error:error,result:{},data:[],forceLoading:state.forceLoading===2?state.forceLoading:1});}).on(fetchPostComments.done,function(state,_ref8){var result=_ref8.result,params=_ref8.params;var processed=storeListWithKey(_objectSpread({response:result.data,key:params.post_id,clear:params.clear,state:state},params.params));return _objectSpread(_objectSpread(_objectSpread({},state),processed),{},{forceLoading:2});}).on(createCommentMount,function(state,_ref9){var temp_data=_ref9.temp_data,post_id=_ref9.post_id;var data=_objectSpread({},state.data);if(data[post_id]){data[post_id]=[temp_data].concat(_toConsumableArray(data[post_id]));}return _objectSpread(_objectSpread({},state),{},{data:data});}).on(fetchCreateComment.done,function(state,_ref10){var result=_ref10.result,params=_ref10.params;var data=_objectSpread({},state.data);var post_id=params.post_id,temp_data=params.temp_data;var idx=!!data[post_id]&&data[post_id].findIndex(function(item){return item.id===temp_data.id;});if(idx!==false&&idx!==-1){var item=result.data;data[post_id]=[].concat(_toConsumableArray(data[post_id].slice(0,idx)),[item],_toConsumableArray(data[post_id].slice(idx+1)));}return _objectSpread(_objectSpread({},state),{},{data:data});}).on(commentLikeMount,function(state,_ref11){var post_id=_ref11.post_id,comment_id=_ref11.comment_id;var data=_objectSpread({},state.data);var idx=data[post_id].findIndex(function(item){return item.id===comment_id;});if(idx!==-1&&idx!==false){var oldData=_objectSpread({},data[post_id][idx]);data[post_id]=[].concat(_toConsumableArray(data[post_id].slice(0,idx)),[_objectSpread(_objectSpread({},oldData),{},{is_liked:true,likes_count:oldData.likes_count+1})],_toConsumableArray(data[post_id].slice(idx+1)));}return _objectSpread(_objectSpread({},state),{},{data:data});}).on(deleteLikeMount,function(state,_ref12){var post_id=_ref12.post_id,comment_id=_ref12.comment_id;var data=_objectSpread({},state.data);var idx=data[post_id].findIndex(function(item){return item.id===comment_id;});if(idx!==false&&idx!==-1){var oldData=_objectSpread({},data[post_id][idx]);data[post_id]=[].concat(_toConsumableArray(data[post_id].slice(0,idx)),[_objectSpread(_objectSpread({},oldData),{},{is_liked:false,likes_count:oldData.likes_count-1})],_toConsumableArray(data[post_id].slice(idx+1)));}return _objectSpread(_objectSpread({},state),{},{data:data});}).on(deletePostCommentMount,function(state,_ref13){var post_id=_ref13.post_id,comment_id=_ref13.comment_id;var data=_objectSpread({},state.data);var idx=data[post_id].findIndex(function(item){return item.id===comment_id;});if(data[post_id]){if(idx!==-1&&idx!==false){data[post_id]=[].concat(_toConsumableArray(data[post_id].splice(0,idx)),_toConsumableArray(data[post_id].splice(idx+1)));}}return _objectSpread(_objectSpread({},state),{},{data:data});});var $commentReplyList=createStore({loading:false,data:[],result:{},error:false}).on(fetchCommentReplyList.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchCommentReplyList.fail,function(state,_ref14){var error=_ref14.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:{},result:{}});}).on(fetchCommentReplyList.done,function(state,_ref15){var result=_ref15.result;return _objectSpread(_objectSpread({},state),{},{data:result.data.results,result:result.data});});export var $postModel=combine({$getPost:$getPost,$postOfferings:$postOfferings,$getPostComments:$getPostComments,$commentReplyList:$commentReplyList});","map":null,"metadata":{},"sourceType":"module"}