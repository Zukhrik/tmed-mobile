{"ast":null,"code":"import { $ as f, A as S, G as X, K as q, d as h, f as K, k as b, r as $ } from \"../chunk.XJPT76BQ.js\";\nvar F = \"@photoeditorsdk/root\",\n    w = \"5.11.7\",\n    M = \"The most comprehensive photo editor SDK for HTML5\",\n    E = \"http://github.com/imgly/pesdk-html5\",\n    j = \"PhotoEditorSDK (img.ly GmbH) <contact@img.ly>\",\n    A = \"SEE LICENSE IN LICENSE.md\",\n    H = !0,\n    L = {},\n    V = {\n  start: \"yarn workspace @example/react start\",\n  build: \"yarn sdk-script build\",\n  \"build:rollup\": \"yarn sdk-script build rollup\",\n  \"package:release\": \"cd dist/photoeditorsdk && npm publish\",\n  \"package:pre-release\": \"cd dist/photoeditorsdk && npm publish --tag next\",\n  \"lint:css\": \"stylelint './packages/**/*.tsx'\",\n  \"lint:ts\": \"eslint ./packages\",\n  \"lint:ts-engine\": \"eslint ./engine\",\n  \"lint:types\": \"tsc --noEmit -p tsconfig.json --skipLibCheck\",\n  \"lint:types-engine\": \"tsc --noEmit -p engine/tsconfig.json --skipLibCheck\",\n  lint: \"run-p lint:*\",\n  test: \"$(npm bin)/jest\",\n  e2e: \"cypress open\",\n  \"e2e:server\": \"sdk-script ui -P 3000 -D build\",\n  \"e2e:ci\": \"CYPRESS_RETRIES=2 cypress run --browser chrome --headless\",\n  deploy: \"yarn workspace examp run deploy:pages\",\n  docs: \"rm -rf ./docs && typedoc\",\n  postinstall: \"yarn sdk-script server:build\"\n},\n    D = {\n  \"@elv1n/cypress-plugin-snapshots\": \"1.4.4\",\n  \"@types/jest\": \"^24.0.11\",\n  \"@types/pixelmatch\": \"^5.2.2\",\n  \"@types/pngjs\": \"^3.4.2\",\n  \"@types/react\": \"^16.8.13\",\n  \"@types/react-dom\": \"^16.8.4\",\n  \"@types/styled-components\": \"4.4.0\",\n  \"@typescript-eslint/eslint-plugin\": \"4.6.0\",\n  \"@typescript-eslint/parser\": \"4.6.0\",\n  autoprefixer: \"^9.7.4\",\n  \"cross-env\": \"^7.0.2\",\n  cypress: \"6.6.0\",\n  eslint: \"7.10.0\",\n  \"eslint-config-airbnb\": \"18.2.0\",\n  \"eslint-config-prettier\": \"6.12.0\",\n  \"eslint-import-resolver-typescript\": \"^2.3.0\",\n  \"eslint-plugin-cypress\": \"^2.11.2\",\n  \"eslint-plugin-import\": \"2.22.1\",\n  \"eslint-plugin-jsx-a11y\": \"6.3.1\",\n  \"eslint-plugin-no-only-tests\": \"^2.4.0\",\n  \"eslint-plugin-prettier\": \"3.1.4\",\n  \"eslint-plugin-react\": \"7.21.3\",\n  husky: \"4.3.0\",\n  jest: \"24.9.0\",\n  jsdoc: \"^3.6.3\",\n  \"lint-staged\": \"10.4.0\",\n  \"lodash.defaults\": \"^4.2.0\",\n  \"mobx-react-devtools\": \"^6.1.1\",\n  \"native-url\": \"0.3.4\",\n  \"npm-run-all\": \"^4.1.5\",\n  prettier: \"^2.0.5\",\n  react: \"16.8.6\",\n  \"react-dom\": \"16.8.6\",\n  \"start-server-and-test\": \"1.11.5\",\n  \"styled-components\": \"4.4.1\",\n  stylelint: \"^13.7.2\",\n  \"stylelint-config-recommended\": \"^3.0.0\",\n  \"stylelint-config-standard\": \"^20.0.0\",\n  \"stylelint-config-styled-components\": \"^0.1.1\",\n  \"stylelint-processor-styled-components\": \"^1.10.0\",\n  \"ts-jest\": \"24.3.0\",\n  typedoc: \"^0.17.8\",\n  typescript: \"3.8.3\",\n  \"utility-types\": \"^3.10.0\"\n},\n    B = {\n  \"@juggle/resize-observer\": \"3.2.0\",\n  \"@reach/portal\": \"^0.13.0\",\n  \"can-use-dom\": \"0.1.0\",\n  \"lodash.debounce\": \"4.0.8\",\n  \"lodash.memoize\": \"4.1.2\",\n  \"lodash.throttle\": \"4.1.1\",\n  mobx: \"4.15.7\",\n  \"mobx-react\": \"6.3.1\",\n  photoeditorsdk: \"1.0.0\",\n  \"react-app-polyfill\": \"1.0.6\",\n  \"react-transition-group\": \"^4.4.1\"\n},\n    G = {\n  node: \"10.x || 11.x || 12.x || 13.x || 14.x || 15.x\"\n},\n    N = {\n  eslint: \"7.10.0\"\n},\n    U = [\"examples/server\", \"examples/material-ui\", \"examples/ssr\", \"examples/react\", \"packages/*\", \"!packages/ui\", \"packages/ui/*\", \"!packages/ui/components\", \"packages/ui/components/*\", \"engine/*\", \"test/*\", \"scripts\"],\n    _ = {\n  hooks: {\n    \"pre-commit\": \"lint-staged\",\n    \"pre-push\": \"true\"\n  }\n},\n    I = {\n  name: F,\n  version: w,\n  description: M,\n  repository: E,\n  author: j,\n  license: A,\n  private: H,\n  bin: L,\n  scripts: V,\n  devDependencies: D,\n  dependencies: B,\n  devEngines: G,\n  resolutions: N,\n  workspaces: U,\n  husky: _\n};\nvar u = class {\n  constructor(e, i, t, o, p, s) {\n    this.mapImagePointToRelativeCropPoint = e => {\n      let i = f.pointFromSpaceToSpace(e, this.imageSpace, this.cropSpace, !1);\n      return f.absoluteToRelativePoint(i, this.cropSpace, !1);\n    };\n\n    this.mapSizeToRelativeUnscaledCropSize = e => e / Math.min(this.outputSize.height, this.outputSize.width);\n\n    this.mapSizeToRelativeScaledCropSize = e => e / Math.min(this.outputSize.height * this.outputScale.x, this.outputSize.width * this.outputScale.y);\n\n    this.getPointInDirection = (e, i = 0, t = 3) => {\n      let o = Math.tan(i),\n          p = Math.sqrt(o ** 2 + 1);\n      return {\n        x: e.x + t / p,\n        y: e.y + t * o / p\n      };\n    };\n\n    this.previewPosition = e, this.previewSize = i, this.outputSize = t, this.imageSize = o, this.imageSpace = p, this.cropSpace = s, this.outputScale = s.getScale();\n  }\n\n  static serializeFilters(e) {\n    return {\n      type: \"filter\",\n      options: {\n        intensity: e.intensity,\n        identifier: e.identifier\n      }\n    };\n  }\n\n  static serializeAdjustments(e) {\n    return {\n      type: \"adjustments\",\n      options: e\n    };\n  }\n\n  static serializeOverlay(e) {\n    return {\n      type: \"overlay\",\n      options: {\n        identifier: e.identifier,\n        intensity: e.opacity,\n        blendMode: e.blendMode.replace(/[A-Z]/g, i => ` ${i.toLowerCase()}`)\n      }\n    };\n  }\n\n  static serializeMetaData() {\n    return {\n      platform: \"html5\",\n      version: I.version,\n      createdAt: new Date().toISOString()\n    };\n  }\n\n  serialise(e, i, t) {\n    let o = u.serializeMetaData(),\n        p = {\n      width: this.imageSize.width,\n      height: this.imageSize.height\n    };\n    i && (p.type = t, p.data = i);\n    let s = [],\n        d = [],\n        {\n      adjustment: z\n    } = e;\n    Object.keys(z).map(r => z[r]).filter(Boolean).length && s.push(u.serializeAdjustments(z));\n    let {\n      filter: a\n    } = e;\n    a.identifier !== \"identity\" && s.push(u.serializeFilters(a));\n    let {\n      overlay: c\n    } = e;\n\n    if (c.identifier !== \"identity\" && d.push(u.serializeOverlay(c)), e.transform) {\n      let {\n        transform: r,\n        orientation: m\n      } = this.serializeTransform(e.transform),\n          v = [r.options.start.x !== 0, r.options.start.y !== 0, r.options.end.x !== 1, r.options.end.y !== 1, r.options.rotation !== 0],\n          y = [m.options.rotation !== 0, m.options.flipVertically !== !1, m.options.flipHorizontally !== !1];\n      v.some(g => g) && s.push(r), y.some(g => g) && s.push(m);\n    }\n\n    let {\n      frame: C\n    } = e;\n    C.identifier !== \"identity\" && d.push(this.serialzeFrame(C));\n    let {\n      focus: R\n    } = e;\n\n    if (R.identifier !== \"identity\" && s.push(this.serializeFocus(R)), e.sprite && e.sprite.spriteIdList.forEach(r => {\n      let m = e.sprite.common[r];\n\n      switch (m.tool) {\n        case \"sticker\":\n          let v = e.sprite.sticker[r];\n          d.push(this.serializeSticker(v, m, e.transform));\n          break;\n\n        case \"text\":\n          let y = e.sprite.text[r];\n          d.push(this.serializeText(y, m));\n          break;\n\n        case \"textdesign\":\n          let g = e.sprite.textdesign[r];\n          d.push(this.serializeTextDesign(g, m));\n          break;\n      }\n    }), e.brush.strokes.length && d.push({\n      type: \"brush\",\n      options: {\n        paths: e.brush.strokes.map(r => ({\n          points: r.path.controlPoints.map(this.mapImagePointToRelativeCropPoint),\n          brush: {\n            color: {\n              rgba: r.brush.color\n            },\n            size: r.brush.size,\n            hardness: r.brush.hardness\n          }\n        }))\n      }\n    }), d.length) {\n      let r = {\n        type: \"sprite\",\n        options: {\n          sprites: d\n        }\n      };\n      s.push(r);\n    }\n\n    let x = {\n      assets: {\n        stickers: e.customStickers\n      }\n    };\n    return {\n      version: u.version,\n      meta: o,\n      image: p,\n      operations: s,\n      assetLibrary: x\n    };\n  }\n\n  serialzeFrame(e) {\n    return {\n      type: \"frame\",\n      options: {\n        identifier: e.identifier,\n        alpha: e.opacity,\n        tintColor: {\n          rgba: e.color\n        },\n        size: this.mapSizeToRelativeUnscaledCropSize(e.width)\n      }\n    };\n  }\n\n  serializeFocus(e) {\n    let i = Math.sqrt(this.previewSize.width ** 2 + this.previewSize.height ** 2);\n\n    switch (e.identifier) {\n      case b.LINEAR:\n        return {\n          type: \"focus\",\n          options: {\n            type: \"linear\",\n            options: {\n              start: this.mapImagePointToRelativeCropPoint(e.linear.start),\n              end: this.mapImagePointToRelativeCropPoint(e.linear.end),\n              blurRadius: this.mapSizeToRelativeScaledCropSize(e.linear.blurRadius)\n            }\n          }\n        };\n\n      case b.RADIAL:\n        return {\n          type: \"focus\",\n          options: {\n            type: \"radial\",\n            options: {\n              start: this.mapImagePointToRelativeCropPoint(e.radial.center),\n              end: this.mapImagePointToRelativeCropPoint(this.getPointInDirection(e.radial.center, 0, e.radial.radius)),\n              blurRadius: this.mapSizeToRelativeScaledCropSize(e.radial.blurRadius),\n              gradientRadius: .1\n            }\n          }\n        };\n\n      case b.MIRRORED:\n        let {\n          mirrored: t\n        } = e;\n        return {\n          type: \"focus\",\n          options: {\n            type: \"mirrored\",\n            options: {\n              start: this.mapImagePointToRelativeCropPoint(this.getPointInDirection(t.origin, t.rotation, i / 2)),\n              end: this.mapImagePointToRelativeCropPoint(this.getPointInDirection(t.origin, t.rotation, -i / 2)),\n              size: this.mapSizeToRelativeScaledCropSize(e.mirrored.size),\n              blurRadius: this.mapSizeToRelativeScaledCropSize(e.mirrored.blurRadius),\n              gradientSize: .1\n            }\n          }\n        };\n\n      default:\n        return {\n          type: \"focus\",\n          options: {\n            type: \"gaussian\",\n            options: {\n              blurRadius: this.mapSizeToRelativeScaledCropSize(e.gaussian.blurRadius)\n            }\n          }\n        };\n    }\n  }\n\n  serializeSticker(e, i, t) {\n    return {\n      type: \"sticker\",\n      options: {\n        position: this.mapImagePointToRelativeCropPoint(i.position),\n        dimensions: {\n          x: this.mapSizeToRelativeScaledCropSize(i.size.width),\n          y: this.mapSizeToRelativeScaledCropSize(i.size.height)\n        },\n        rotation: i.rotation,\n        flipVertically: (i.flipVertically || !1) !== (t.flipVertically || !1),\n        flipHorizontally: (i.flipHorizontally || !1) !== (t.flipHorizontally || !1),\n        identifier: e.identifier,\n        alpha: e.opacity,\n        tintColor: {\n          rgba: e.tintColor\n        },\n        tintMode: e.tintMode\n      }\n    };\n  }\n\n  serializeText(e, i) {\n    return {\n      type: \"text\",\n      options: {\n        position: this.mapImagePointToRelativeCropPoint(i.position),\n        rotation: i.rotation,\n        flipVertically: !1,\n        flipHorizontally: !1,\n        fontIdentifier: e.identifier,\n        fontSize: this.mapSizeToRelativeScaledCropSize(e.fontSize),\n        maxWidth: this.mapSizeToRelativeScaledCropSize(e.width),\n        text: e.text,\n        lineHeight: e.lineHeight,\n        color: {\n          rgba: e.textColor\n        },\n        backgroundColor: {\n          rgba: e.backgroundColor\n        },\n        alignment: e.alignment\n      }\n    };\n  }\n\n  serializeTextDesign(e, i) {\n    return {\n      type: \"textdesign\",\n      options: {\n        position: this.mapImagePointToRelativeCropPoint(i.position),\n        rotation: i.rotation,\n        flipVertically: !1,\n        flipHorizontally: !1,\n        identifier: e.identifier,\n        inverted: e.isInverted,\n        text: e.text,\n        seed: e.seed,\n        width: this.mapSizeToRelativeScaledCropSize(e.width),\n        padding: this.mapSizeToRelativeScaledCropSize(e.padding),\n        color: {\n          rgba: e.color\n        }\n      }\n    };\n  }\n\n  serializeTransform(e) {\n    let {\n      start: i,\n      end: t\n    } = e,\n        o = {\n      type: \"transform\",\n      options: {\n        start: i,\n        end: t,\n        rotation: e.rotation,\n        meta: {\n          identifier: e.identifier\n        }\n      }\n    },\n        p = {\n      type: \"orientation\",\n      options: {\n        rotation: e.outputRotation,\n        flipHorizontally: e.flipHorizontally,\n        flipVertically: e.flipVertically\n      }\n    };\n    return {\n      transform: o,\n      orientation: p\n    };\n  }\n\n},\n    O = u;\nO.version = \"3.9.0\";\n\nvar k = (P = K.PNG) => `data:${P};base64,`,\n    n = class {\n  constructor(e) {\n    this.spriteOrder = 0;\n\n    this.mapRelativeCropPointToImageSpace = e => {\n      let i = f.relativeToAbsolutePoint(e, this.cropSpace, !1);\n      return f.pointFromSpaceToSpace(i, this.cropSpace, this.imageSpace, !1);\n    };\n\n    this.mapRelativeCropSizeToScaledImageSize = e => e * Math.min(this.outputSize.height * this.outputScale.x, this.outputSize.width * this.outputScale.y);\n\n    this.mapRelativeCropSizeToUnscaledImageSize = e => e * Math.min(this.outputSize.height, this.outputSize.width);\n\n    this.editor = e;\n  }\n\n  static deserializeFilter(e) {\n    return {\n      intensity: e.intensity,\n      identifier: e.identifier\n    };\n  }\n\n  static deserializeAdjustments(e) {\n    return q({}, e);\n  }\n\n  static deserializeOverlay(e) {\n    return {\n      identifier: e.identifier,\n      opacity: e.intensity,\n      blendMode: e.blendMode.replace(/([ _][a-z])/g, i => i.toUpperCase().replace(\" \", \"\").replace(\"_\", \"\"))\n    };\n  }\n\n  static initializeEmptyTransform() {\n    return {\n      outputRotation: 0,\n      flipHorizontally: !1,\n      flipVertically: !1,\n      start: {\n        x: 0,\n        y: 0\n      },\n      end: {\n        x: 1,\n        y: 1\n      },\n      rotation: 0\n    };\n  }\n\n  static deserialzeColor(e) {\n    return e && e.rgba ? e.rgba : [0, 0, 0, 0];\n  }\n\n  static validateVersion(e) {\n    return n.version === e;\n  }\n\n  static checkIfPlatformHTML(e) {\n    return e === \"html5\";\n  }\n\n  static deserializeStickers(e) {\n    return {\n      identifier: e.identifier,\n      opacity: e.alpha || 0,\n      tintMode: e.tintMode || \"none\",\n      tintColor: n.deserialzeColor(e.tintColor)\n    };\n  }\n\n  static checkIsSerialisationValid(e) {\n    if (typeof e != \"string\" && n.validateVersion(e.version)) return !0;\n    if (typeof e == \"string\") throw new Error(\"Invalid input of type string, please provide an object\");\n    return !1;\n  }\n\n  static deserializeImage(e) {\n    let i = {};\n    return e.image && (i.image = {\n      width: e.image.width,\n      height: e.image.height,\n      data: e.image.data ? e.image.data.replace(k(), \"\") : \"\"\n    }, i.image.data = i.image.data ? k() + i.image.data : \"\"), i;\n  }\n\n  deserializeTransformation(e) {\n    let i = {},\n        t = e.operations.find(s => s.type === \"orientation\"),\n        o = e.operations.find(s => s.type === \"transform\"),\n        [p] = this.editor.engine.getRootContainers();\n    return this.previewPosition = this.editor.transformToolStore.defaultCropMaskPosition, this.previewSize = this.editor.transformToolStore.maxCropMaskSize, this.imageSpace = p, i.transform = n.initializeEmptyTransform(), t != null && (i.transform.outputRotation = t.options.rotation, i.transform.flipHorizontally = t.options.flipHorizontally || !1, i.transform.flipVertically = t.options.flipVertically || !1), o && (i.transform.start = o.options.start, i.transform.end = o.options.end, i.transform.rotation = o.options.rotation || 0, i.transform.identifier = o.options.meta ? o.options.meta.identifier : \"\"), i;\n  }\n\n  deserialize(e) {\n    var p, s;\n    let i = {};\n    (e.meta ? !n.checkIfPlatformHTML(e.meta.platform) : !1) && console.warn(\"Read serialisation from another Platform\");\n    let t = this.editor.engineMediator.output.container.getResolution(),\n        {\n      size: o\n    } = this.editor.engineMediator.image.container.getBounds();\n    return this.outputSize = t, this.imageSize = o, this.cropSpace = this.editor.engine.getOutputContainer(), this.outputScale = this.cropSpace.getScale(), e.operations.forEach(d => {\n      switch (d.type) {\n        case \"filter\":\n          i.filter = n.deserializeFilter(d.options);\n          break;\n\n        case \"adjustments\":\n          i.adjustment = n.deserializeAdjustments(d.options);\n          break;\n\n        case \"focus\":\n          i.focus = this.deserializeFocus(d.options);\n          break;\n\n        case \"sprite\":\n          let {\n            sprites: z\n          } = d.options;\n          z.forEach(a => {\n            switch (a.type) {\n              case \"frame\":\n                i.frame = this.deserializeFrame(a.options);\n                break;\n\n              case \"overlay\":\n                i.overlay = n.deserializeOverlay(a.options);\n                break;\n\n              case \"brush\":\n                i.brush ? i.brush.strokes.push(...this.deserializeBrush(a.options).strokes) : i.brush = this.deserializeBrush(a.options);\n                break;\n\n              case \"sticker\":\n              case \"text\":\n              case \"textdesign\":\n                i.sprite || (i.sprite = {\n                  spriteIdList: [],\n                  sticker: {},\n                  text: {},\n                  textdesign: {},\n                  common: {}\n                });\n                let c = X();\n                i.sprite.spriteIdList.push(c), i.sprite.common[c] = {\n                  order: this.spriteOrder,\n                  position: this.mapRelativeCropPointToImageSpace(a.options.position),\n                  tool: h.STICKER,\n                  rotation: a.options.rotation || 0,\n                  flipHorizontally: a.options.flipHorizontally,\n                  flipVertically: a.options.flipVertically\n                }, this.spriteOrder += 1, a.type === h.STICKER ? (i.sprite.common[c].tool = h.STICKER, i.sprite.common[c].size = {\n                  width: this.mapRelativeCropSizeToScaledImageSize(a.options.dimensions.x),\n                  height: this.mapRelativeCropSizeToScaledImageSize(a.options.dimensions.y)\n                }, i.sprite.sticker[c] = n.deserializeStickers(a.options)) : a.type === h.TEXT ? (i.sprite.common[c].tool = h.TEXT, i.sprite.text[c] = this.deserializeTexts(a.options)) : a.type === h.TEXT_DESIGN && (i.sprite.common[c].tool = h.TEXT_DESIGN, i.sprite.textdesign[c] = this.deserializeTextDesign(a.options));\n                break;\n\n              default:\n                break;\n            }\n          });\n          break;\n\n        default:\n          break;\n      }\n    }), e.assetLibrary && (i.customStickers = ((s = (p = e.assetLibrary) == null ? void 0 : p.assets) == null ? void 0 : s.stickers) || []), i;\n  }\n\n  deserializeFrame(e) {\n    return {\n      identifier: e.identifier,\n      opacity: e.alpha,\n      width: this.mapRelativeCropSizeToUnscaledImageSize(e.size),\n      color: n.deserialzeColor(e.tintColor)\n    };\n  }\n\n  deserializeFocus(e) {\n    switch (e.type) {\n      case \"linear\":\n        return {\n          identifier: \"linear\",\n          linear: this.deserializeLinearFocus(e.options)\n        };\n\n      case \"gaussian\":\n        return {\n          identifier: \"gaussian\",\n          gaussian: this.deserializeGaussianFocus(e.options)\n        };\n\n      case \"radial\":\n        return {\n          identifier: \"radial\",\n          radial: this.deserializeRadialFocus(e.options)\n        };\n\n      case \"mirrored\":\n        return {\n          identifier: \"mirrored\",\n          mirrored: this.deserializeMirroredFocus(e.options)\n        };\n    }\n  }\n\n  deserializeRadialFocus(e) {\n    return {\n      center: this.mapRelativeCropPointToImageSpace(e.start),\n      radius: new S(this.mapRelativeCropPointToImageSpace(e.start)).subtract(new S(this.mapRelativeCropPointToImageSpace(e.end))).magnitude,\n      blurRadius: this.mapRelativeCropSizeToScaledImageSize(e.blurRadius)\n    };\n  }\n\n  deserializeLinearFocus(e) {\n    return {\n      start: this.mapRelativeCropPointToImageSpace(e.start),\n      end: this.mapRelativeCropPointToImageSpace(e.end),\n      blurRadius: this.mapRelativeCropSizeToScaledImageSize(e.blurRadius)\n    };\n  }\n\n  deserializeGaussianFocus(e) {\n    return {\n      blurRadius: this.mapRelativeCropSizeToScaledImageSize(e.blurRadius)\n    };\n  }\n\n  deserializeMirroredFocus(e) {\n    let i = new S(this.mapRelativeCropPointToImageSpace(e.start)).subtract(new S(this.mapRelativeCropPointToImageSpace(e.end)));\n    return {\n      origin: new S(this.mapRelativeCropPointToImageSpace(e.start)).add(new S(this.mapRelativeCropPointToImageSpace(e.end))).divide(2),\n      rotation: Math.atan2(i.y, i.x),\n      size: this.mapRelativeCropSizeToScaledImageSize(e.size),\n      blurRadius: this.mapRelativeCropSizeToScaledImageSize(e.blurRadius)\n    };\n  }\n\n  deserializeTexts(e) {\n    return {\n      identifier: $(e.fontIdentifier),\n      fontSize: this.mapRelativeCropSizeToScaledImageSize(e.fontSize),\n      width: this.mapRelativeCropSizeToScaledImageSize(e.maxWidth),\n      alignment: e.alignment,\n      textColor: n.deserialzeColor(e.color),\n      backgroundColor: n.deserialzeColor(e.backgroundColor),\n      lineHeight: e.lineHeight,\n      text: e.text\n    };\n  }\n\n  deserializeTextDesign(e) {\n    return {\n      identifier: e.identifier,\n      width: this.mapRelativeCropSizeToScaledImageSize(e.width),\n      padding: this.mapRelativeCropSizeToScaledImageSize(e.padding),\n      color: n.deserialzeColor(e.color),\n      seed: e.seed,\n      text: e.text,\n      isInverted: e.inverted\n    };\n  }\n\n  deserializeBrush(e) {\n    return {\n      strokes: e.paths.map(i => ({\n        path: {\n          controlPoints: i.points.map(this.mapRelativeCropPointToImageSpace)\n        },\n        brush: {\n          id: \"imgly_brush_radial\",\n          color: n.deserialzeColor(i.brush.color),\n          size: i.brush.size,\n          hardness: i.brush.hardness\n        }\n      }))\n    };\n  }\n\n},\n    T = n;\n\nT.version = \"3.9.0\";\nexport { T as Deserializer, O as Serializer };","map":{"version":3,"sources":["/Users/zuhriddinkamilzanov/Desktop/tMed-mobile/node_modules/photoeditorsdk/esm/serialization/index.js"],"names":["$","f","A","S","G","X","K","q","d","h","k","b","r","F","w","M","E","j","H","L","V","start","build","lint","test","e2e","deploy","docs","postinstall","D","autoprefixer","cypress","eslint","husky","jest","jsdoc","prettier","react","stylelint","typedoc","typescript","B","mobx","photoeditorsdk","node","N","U","_","hooks","I","name","version","description","repository","author","license","private","bin","scripts","devDependencies","dependencies","devEngines","resolutions","workspaces","u","constructor","e","i","t","o","p","s","mapImagePointToRelativeCropPoint","pointFromSpaceToSpace","imageSpace","cropSpace","absoluteToRelativePoint","mapSizeToRelativeUnscaledCropSize","Math","min","outputSize","height","width","mapSizeToRelativeScaledCropSize","outputScale","x","y","getPointInDirection","tan","sqrt","previewPosition","previewSize","imageSize","getScale","serializeFilters","type","options","intensity","identifier","serializeAdjustments","serializeOverlay","opacity","blendMode","replace","toLowerCase","serializeMetaData","platform","createdAt","Date","toISOString","serialise","data","adjustment","z","Object","keys","map","filter","Boolean","length","push","a","overlay","c","transform","orientation","m","serializeTransform","v","end","rotation","flipVertically","flipHorizontally","some","g","frame","C","serialzeFrame","focus","R","serializeFocus","sprite","spriteIdList","forEach","common","tool","sticker","serializeSticker","text","serializeText","textdesign","serializeTextDesign","brush","strokes","paths","points","path","controlPoints","color","rgba","size","hardness","sprites","assets","stickers","customStickers","meta","image","operations","assetLibrary","alpha","tintColor","LINEAR","linear","blurRadius","RADIAL","radial","center","radius","gradientRadius","MIRRORED","mirrored","origin","gradientSize","gaussian","position","dimensions","tintMode","fontIdentifier","fontSize","maxWidth","lineHeight","textColor","backgroundColor","alignment","inverted","isInverted","seed","padding","outputRotation","O","P","PNG","n","spriteOrder","mapRelativeCropPointToImageSpace","relativeToAbsolutePoint","mapRelativeCropSizeToScaledImageSize","mapRelativeCropSizeToUnscaledImageSize","editor","deserializeFilter","deserializeAdjustments","deserializeOverlay","toUpperCase","initializeEmptyTransform","deserialzeColor","validateVersion","checkIfPlatformHTML","deserializeStickers","checkIsSerialisationValid","Error","deserializeImage","deserializeTransformation","find","engine","getRootContainers","transformToolStore","defaultCropMaskPosition","maxCropMaskSize","deserialize","console","warn","engineMediator","output","container","getResolution","getBounds","getOutputContainer","deserializeFocus","deserializeFrame","deserializeBrush","order","STICKER","TEXT","deserializeTexts","TEXT_DESIGN","deserializeTextDesign","deserializeLinearFocus","deserializeGaussianFocus","deserializeRadialFocus","deserializeMirroredFocus","subtract","magnitude","add","divide","atan2","id","T","Deserializer","Serializer"],"mappings":"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","sourcesContent":["import{$ as f,A as S,G as X,K as q,d as h,f as K,k as b,r as $}from\"../chunk.XJPT76BQ.js\";var F=\"@photoeditorsdk/root\",w=\"5.11.7\",M=\"The most comprehensive photo editor SDK for HTML5\",E=\"http://github.com/imgly/pesdk-html5\",j=\"PhotoEditorSDK (img.ly GmbH) <contact@img.ly>\",A=\"SEE LICENSE IN LICENSE.md\",H=!0,L={},V={start:\"yarn workspace @example/react start\",build:\"yarn sdk-script build\",\"build:rollup\":\"yarn sdk-script build rollup\",\"package:release\":\"cd dist/photoeditorsdk && npm publish\",\"package:pre-release\":\"cd dist/photoeditorsdk && npm publish --tag next\",\"lint:css\":\"stylelint './packages/**/*.tsx'\",\"lint:ts\":\"eslint ./packages\",\"lint:ts-engine\":\"eslint ./engine\",\"lint:types\":\"tsc --noEmit -p tsconfig.json --skipLibCheck\",\"lint:types-engine\":\"tsc --noEmit -p engine/tsconfig.json --skipLibCheck\",lint:\"run-p lint:*\",test:\"$(npm bin)/jest\",e2e:\"cypress open\",\"e2e:server\":\"sdk-script ui -P 3000 -D build\",\"e2e:ci\":\"CYPRESS_RETRIES=2 cypress run --browser chrome --headless\",deploy:\"yarn workspace examp run deploy:pages\",docs:\"rm -rf ./docs && typedoc\",postinstall:\"yarn sdk-script server:build\"},D={\"@elv1n/cypress-plugin-snapshots\":\"1.4.4\",\"@types/jest\":\"^24.0.11\",\"@types/pixelmatch\":\"^5.2.2\",\"@types/pngjs\":\"^3.4.2\",\"@types/react\":\"^16.8.13\",\"@types/react-dom\":\"^16.8.4\",\"@types/styled-components\":\"4.4.0\",\"@typescript-eslint/eslint-plugin\":\"4.6.0\",\"@typescript-eslint/parser\":\"4.6.0\",autoprefixer:\"^9.7.4\",\"cross-env\":\"^7.0.2\",cypress:\"6.6.0\",eslint:\"7.10.0\",\"eslint-config-airbnb\":\"18.2.0\",\"eslint-config-prettier\":\"6.12.0\",\"eslint-import-resolver-typescript\":\"^2.3.0\",\"eslint-plugin-cypress\":\"^2.11.2\",\"eslint-plugin-import\":\"2.22.1\",\"eslint-plugin-jsx-a11y\":\"6.3.1\",\"eslint-plugin-no-only-tests\":\"^2.4.0\",\"eslint-plugin-prettier\":\"3.1.4\",\"eslint-plugin-react\":\"7.21.3\",husky:\"4.3.0\",jest:\"24.9.0\",jsdoc:\"^3.6.3\",\"lint-staged\":\"10.4.0\",\"lodash.defaults\":\"^4.2.0\",\"mobx-react-devtools\":\"^6.1.1\",\"native-url\":\"0.3.4\",\"npm-run-all\":\"^4.1.5\",prettier:\"^2.0.5\",react:\"16.8.6\",\"react-dom\":\"16.8.6\",\"start-server-and-test\":\"1.11.5\",\"styled-components\":\"4.4.1\",stylelint:\"^13.7.2\",\"stylelint-config-recommended\":\"^3.0.0\",\"stylelint-config-standard\":\"^20.0.0\",\"stylelint-config-styled-components\":\"^0.1.1\",\"stylelint-processor-styled-components\":\"^1.10.0\",\"ts-jest\":\"24.3.0\",typedoc:\"^0.17.8\",typescript:\"3.8.3\",\"utility-types\":\"^3.10.0\"},B={\"@juggle/resize-observer\":\"3.2.0\",\"@reach/portal\":\"^0.13.0\",\"can-use-dom\":\"0.1.0\",\"lodash.debounce\":\"4.0.8\",\"lodash.memoize\":\"4.1.2\",\"lodash.throttle\":\"4.1.1\",mobx:\"4.15.7\",\"mobx-react\":\"6.3.1\",photoeditorsdk:\"1.0.0\",\"react-app-polyfill\":\"1.0.6\",\"react-transition-group\":\"^4.4.1\"},G={node:\"10.x || 11.x || 12.x || 13.x || 14.x || 15.x\"},N={eslint:\"7.10.0\"},U=[\"examples/server\",\"examples/material-ui\",\"examples/ssr\",\"examples/react\",\"packages/*\",\"!packages/ui\",\"packages/ui/*\",\"!packages/ui/components\",\"packages/ui/components/*\",\"engine/*\",\"test/*\",\"scripts\"],_={hooks:{\"pre-commit\":\"lint-staged\",\"pre-push\":\"true\"}},I={name:F,version:w,description:M,repository:E,author:j,license:A,private:H,bin:L,scripts:V,devDependencies:D,dependencies:B,devEngines:G,resolutions:N,workspaces:U,husky:_};var u=class{constructor(e,i,t,o,p,s){this.mapImagePointToRelativeCropPoint=e=>{let i=f.pointFromSpaceToSpace(e,this.imageSpace,this.cropSpace,!1);return f.absoluteToRelativePoint(i,this.cropSpace,!1)};this.mapSizeToRelativeUnscaledCropSize=e=>e/Math.min(this.outputSize.height,this.outputSize.width);this.mapSizeToRelativeScaledCropSize=e=>e/Math.min(this.outputSize.height*this.outputScale.x,this.outputSize.width*this.outputScale.y);this.getPointInDirection=(e,i=0,t=3)=>{let o=Math.tan(i),p=Math.sqrt(o**2+1);return{x:e.x+t/p,y:e.y+t*o/p}};this.previewPosition=e,this.previewSize=i,this.outputSize=t,this.imageSize=o,this.imageSpace=p,this.cropSpace=s,this.outputScale=s.getScale()}static serializeFilters(e){return{type:\"filter\",options:{intensity:e.intensity,identifier:e.identifier}}}static serializeAdjustments(e){return{type:\"adjustments\",options:e}}static serializeOverlay(e){return{type:\"overlay\",options:{identifier:e.identifier,intensity:e.opacity,blendMode:e.blendMode.replace(/[A-Z]/g,i=>` ${i.toLowerCase()}`)}}}static serializeMetaData(){return{platform:\"html5\",version:I.version,createdAt:new Date().toISOString()}}serialise(e,i,t){let o=u.serializeMetaData(),p={width:this.imageSize.width,height:this.imageSize.height};i&&(p.type=t,p.data=i);let s=[],d=[],{adjustment:z}=e;Object.keys(z).map(r=>z[r]).filter(Boolean).length&&s.push(u.serializeAdjustments(z));let{filter:a}=e;a.identifier!==\"identity\"&&s.push(u.serializeFilters(a));let{overlay:c}=e;if(c.identifier!==\"identity\"&&d.push(u.serializeOverlay(c)),e.transform){let{transform:r,orientation:m}=this.serializeTransform(e.transform),v=[r.options.start.x!==0,r.options.start.y!==0,r.options.end.x!==1,r.options.end.y!==1,r.options.rotation!==0],y=[m.options.rotation!==0,m.options.flipVertically!==!1,m.options.flipHorizontally!==!1];v.some(g=>g)&&s.push(r),y.some(g=>g)&&s.push(m)}let{frame:C}=e;C.identifier!==\"identity\"&&d.push(this.serialzeFrame(C));let{focus:R}=e;if(R.identifier!==\"identity\"&&s.push(this.serializeFocus(R)),e.sprite&&e.sprite.spriteIdList.forEach(r=>{let m=e.sprite.common[r];switch(m.tool){case\"sticker\":let v=e.sprite.sticker[r];d.push(this.serializeSticker(v,m,e.transform));break;case\"text\":let y=e.sprite.text[r];d.push(this.serializeText(y,m));break;case\"textdesign\":let g=e.sprite.textdesign[r];d.push(this.serializeTextDesign(g,m));break}}),e.brush.strokes.length&&d.push({type:\"brush\",options:{paths:e.brush.strokes.map(r=>({points:r.path.controlPoints.map(this.mapImagePointToRelativeCropPoint),brush:{color:{rgba:r.brush.color},size:r.brush.size,hardness:r.brush.hardness}}))}}),d.length){let r={type:\"sprite\",options:{sprites:d}};s.push(r)}let x={assets:{stickers:e.customStickers}};return{version:u.version,meta:o,image:p,operations:s,assetLibrary:x}}serialzeFrame(e){return{type:\"frame\",options:{identifier:e.identifier,alpha:e.opacity,tintColor:{rgba:e.color},size:this.mapSizeToRelativeUnscaledCropSize(e.width)}}}serializeFocus(e){let i=Math.sqrt(this.previewSize.width**2+this.previewSize.height**2);switch(e.identifier){case b.LINEAR:return{type:\"focus\",options:{type:\"linear\",options:{start:this.mapImagePointToRelativeCropPoint(e.linear.start),end:this.mapImagePointToRelativeCropPoint(e.linear.end),blurRadius:this.mapSizeToRelativeScaledCropSize(e.linear.blurRadius)}}};case b.RADIAL:return{type:\"focus\",options:{type:\"radial\",options:{start:this.mapImagePointToRelativeCropPoint(e.radial.center),end:this.mapImagePointToRelativeCropPoint(this.getPointInDirection(e.radial.center,0,e.radial.radius)),blurRadius:this.mapSizeToRelativeScaledCropSize(e.radial.blurRadius),gradientRadius:.1}}};case b.MIRRORED:let{mirrored:t}=e;return{type:\"focus\",options:{type:\"mirrored\",options:{start:this.mapImagePointToRelativeCropPoint(this.getPointInDirection(t.origin,t.rotation,i/2)),end:this.mapImagePointToRelativeCropPoint(this.getPointInDirection(t.origin,t.rotation,-i/2)),size:this.mapSizeToRelativeScaledCropSize(e.mirrored.size),blurRadius:this.mapSizeToRelativeScaledCropSize(e.mirrored.blurRadius),gradientSize:.1}}};default:return{type:\"focus\",options:{type:\"gaussian\",options:{blurRadius:this.mapSizeToRelativeScaledCropSize(e.gaussian.blurRadius)}}}}}serializeSticker(e,i,t){return{type:\"sticker\",options:{position:this.mapImagePointToRelativeCropPoint(i.position),dimensions:{x:this.mapSizeToRelativeScaledCropSize(i.size.width),y:this.mapSizeToRelativeScaledCropSize(i.size.height)},rotation:i.rotation,flipVertically:(i.flipVertically||!1)!==(t.flipVertically||!1),flipHorizontally:(i.flipHorizontally||!1)!==(t.flipHorizontally||!1),identifier:e.identifier,alpha:e.opacity,tintColor:{rgba:e.tintColor},tintMode:e.tintMode}}}serializeText(e,i){return{type:\"text\",options:{position:this.mapImagePointToRelativeCropPoint(i.position),rotation:i.rotation,flipVertically:!1,flipHorizontally:!1,fontIdentifier:e.identifier,fontSize:this.mapSizeToRelativeScaledCropSize(e.fontSize),maxWidth:this.mapSizeToRelativeScaledCropSize(e.width),text:e.text,lineHeight:e.lineHeight,color:{rgba:e.textColor},backgroundColor:{rgba:e.backgroundColor},alignment:e.alignment}}}serializeTextDesign(e,i){return{type:\"textdesign\",options:{position:this.mapImagePointToRelativeCropPoint(i.position),rotation:i.rotation,flipVertically:!1,flipHorizontally:!1,identifier:e.identifier,inverted:e.isInverted,text:e.text,seed:e.seed,width:this.mapSizeToRelativeScaledCropSize(e.width),padding:this.mapSizeToRelativeScaledCropSize(e.padding),color:{rgba:e.color}}}}serializeTransform(e){let{start:i,end:t}=e,o={type:\"transform\",options:{start:i,end:t,rotation:e.rotation,meta:{identifier:e.identifier}}},p={type:\"orientation\",options:{rotation:e.outputRotation,flipHorizontally:e.flipHorizontally,flipVertically:e.flipVertically}};return{transform:o,orientation:p}}},O=u;O.version=\"3.9.0\";var k=(P=K.PNG)=>`data:${P};base64,`,n=class{constructor(e){this.spriteOrder=0;this.mapRelativeCropPointToImageSpace=e=>{let i=f.relativeToAbsolutePoint(e,this.cropSpace,!1);return f.pointFromSpaceToSpace(i,this.cropSpace,this.imageSpace,!1)};this.mapRelativeCropSizeToScaledImageSize=e=>e*Math.min(this.outputSize.height*this.outputScale.x,this.outputSize.width*this.outputScale.y);this.mapRelativeCropSizeToUnscaledImageSize=e=>e*Math.min(this.outputSize.height,this.outputSize.width);this.editor=e}static deserializeFilter(e){return{intensity:e.intensity,identifier:e.identifier}}static deserializeAdjustments(e){return q({},e)}static deserializeOverlay(e){return{identifier:e.identifier,opacity:e.intensity,blendMode:e.blendMode.replace(/([ _][a-z])/g,i=>i.toUpperCase().replace(\" \",\"\").replace(\"_\",\"\"))}}static initializeEmptyTransform(){return{outputRotation:0,flipHorizontally:!1,flipVertically:!1,start:{x:0,y:0},end:{x:1,y:1},rotation:0}}static deserialzeColor(e){return e&&e.rgba?e.rgba:[0,0,0,0]}static validateVersion(e){return n.version===e}static checkIfPlatformHTML(e){return e===\"html5\"}static deserializeStickers(e){return{identifier:e.identifier,opacity:e.alpha||0,tintMode:e.tintMode||\"none\",tintColor:n.deserialzeColor(e.tintColor)}}static checkIsSerialisationValid(e){if(typeof e!=\"string\"&&n.validateVersion(e.version))return!0;if(typeof e==\"string\")throw new Error(\"Invalid input of type string, please provide an object\");return!1}static deserializeImage(e){let i={};return e.image&&(i.image={width:e.image.width,height:e.image.height,data:e.image.data?e.image.data.replace(k(),\"\"):\"\"},i.image.data=i.image.data?k()+i.image.data:\"\"),i}deserializeTransformation(e){let i={},t=e.operations.find(s=>s.type===\"orientation\"),o=e.operations.find(s=>s.type===\"transform\"),[p]=this.editor.engine.getRootContainers();return this.previewPosition=this.editor.transformToolStore.defaultCropMaskPosition,this.previewSize=this.editor.transformToolStore.maxCropMaskSize,this.imageSpace=p,i.transform=n.initializeEmptyTransform(),t!=null&&(i.transform.outputRotation=t.options.rotation,i.transform.flipHorizontally=t.options.flipHorizontally||!1,i.transform.flipVertically=t.options.flipVertically||!1),o&&(i.transform.start=o.options.start,i.transform.end=o.options.end,i.transform.rotation=o.options.rotation||0,i.transform.identifier=o.options.meta?o.options.meta.identifier:\"\"),i}deserialize(e){var p,s;let i={};(e.meta?!n.checkIfPlatformHTML(e.meta.platform):!1)&&console.warn(\"Read serialisation from another Platform\");let t=this.editor.engineMediator.output.container.getResolution(),{size:o}=this.editor.engineMediator.image.container.getBounds();return this.outputSize=t,this.imageSize=o,this.cropSpace=this.editor.engine.getOutputContainer(),this.outputScale=this.cropSpace.getScale(),e.operations.forEach(d=>{switch(d.type){case\"filter\":i.filter=n.deserializeFilter(d.options);break;case\"adjustments\":i.adjustment=n.deserializeAdjustments(d.options);break;case\"focus\":i.focus=this.deserializeFocus(d.options);break;case\"sprite\":let{sprites:z}=d.options;z.forEach(a=>{switch(a.type){case\"frame\":i.frame=this.deserializeFrame(a.options);break;case\"overlay\":i.overlay=n.deserializeOverlay(a.options);break;case\"brush\":i.brush?i.brush.strokes.push(...this.deserializeBrush(a.options).strokes):i.brush=this.deserializeBrush(a.options);break;case\"sticker\":case\"text\":case\"textdesign\":i.sprite||(i.sprite={spriteIdList:[],sticker:{},text:{},textdesign:{},common:{}});let c=X();i.sprite.spriteIdList.push(c),i.sprite.common[c]={order:this.spriteOrder,position:this.mapRelativeCropPointToImageSpace(a.options.position),tool:h.STICKER,rotation:a.options.rotation||0,flipHorizontally:a.options.flipHorizontally,flipVertically:a.options.flipVertically},this.spriteOrder+=1,a.type===h.STICKER?(i.sprite.common[c].tool=h.STICKER,i.sprite.common[c].size={width:this.mapRelativeCropSizeToScaledImageSize(a.options.dimensions.x),height:this.mapRelativeCropSizeToScaledImageSize(a.options.dimensions.y)},i.sprite.sticker[c]=n.deserializeStickers(a.options)):a.type===h.TEXT?(i.sprite.common[c].tool=h.TEXT,i.sprite.text[c]=this.deserializeTexts(a.options)):a.type===h.TEXT_DESIGN&&(i.sprite.common[c].tool=h.TEXT_DESIGN,i.sprite.textdesign[c]=this.deserializeTextDesign(a.options));break;default:break}});break;default:break}}),e.assetLibrary&&(i.customStickers=((s=(p=e.assetLibrary)==null?void 0:p.assets)==null?void 0:s.stickers)||[]),i}deserializeFrame(e){return{identifier:e.identifier,opacity:e.alpha,width:this.mapRelativeCropSizeToUnscaledImageSize(e.size),color:n.deserialzeColor(e.tintColor)}}deserializeFocus(e){switch(e.type){case\"linear\":return{identifier:\"linear\",linear:this.deserializeLinearFocus(e.options)};case\"gaussian\":return{identifier:\"gaussian\",gaussian:this.deserializeGaussianFocus(e.options)};case\"radial\":return{identifier:\"radial\",radial:this.deserializeRadialFocus(e.options)};case\"mirrored\":return{identifier:\"mirrored\",mirrored:this.deserializeMirroredFocus(e.options)}}}deserializeRadialFocus(e){return{center:this.mapRelativeCropPointToImageSpace(e.start),radius:new S(this.mapRelativeCropPointToImageSpace(e.start)).subtract(new S(this.mapRelativeCropPointToImageSpace(e.end))).magnitude,blurRadius:this.mapRelativeCropSizeToScaledImageSize(e.blurRadius)}}deserializeLinearFocus(e){return{start:this.mapRelativeCropPointToImageSpace(e.start),end:this.mapRelativeCropPointToImageSpace(e.end),blurRadius:this.mapRelativeCropSizeToScaledImageSize(e.blurRadius)}}deserializeGaussianFocus(e){return{blurRadius:this.mapRelativeCropSizeToScaledImageSize(e.blurRadius)}}deserializeMirroredFocus(e){let i=new S(this.mapRelativeCropPointToImageSpace(e.start)).subtract(new S(this.mapRelativeCropPointToImageSpace(e.end)));return{origin:new S(this.mapRelativeCropPointToImageSpace(e.start)).add(new S(this.mapRelativeCropPointToImageSpace(e.end))).divide(2),rotation:Math.atan2(i.y,i.x),size:this.mapRelativeCropSizeToScaledImageSize(e.size),blurRadius:this.mapRelativeCropSizeToScaledImageSize(e.blurRadius)}}deserializeTexts(e){return{identifier:$(e.fontIdentifier),fontSize:this.mapRelativeCropSizeToScaledImageSize(e.fontSize),width:this.mapRelativeCropSizeToScaledImageSize(e.maxWidth),alignment:e.alignment,textColor:n.deserialzeColor(e.color),backgroundColor:n.deserialzeColor(e.backgroundColor),lineHeight:e.lineHeight,text:e.text}}deserializeTextDesign(e){return{identifier:e.identifier,width:this.mapRelativeCropSizeToScaledImageSize(e.width),padding:this.mapRelativeCropSizeToScaledImageSize(e.padding),color:n.deserialzeColor(e.color),seed:e.seed,text:e.text,isInverted:e.inverted}}deserializeBrush(e){return{strokes:e.paths.map(i=>({path:{controlPoints:i.points.map(this.mapRelativeCropPointToImageSpace)},brush:{id:\"imgly_brush_radial\",color:n.deserialzeColor(i.brush.color),size:i.brush.size,hardness:i.brush.hardness}}))}}},T=n;T.version=\"3.9.0\";export{T as Deserializer,O as Serializer};\n"]},"metadata":{},"sourceType":"module"}