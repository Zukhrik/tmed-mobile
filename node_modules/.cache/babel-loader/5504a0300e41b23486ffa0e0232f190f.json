{"ast":null,"code":"import _slicedToArray from\"/Users/zuhriddinkamilzanov/Desktop/t-med(mobile)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useMemo,useState}from'react';import{Col,Radio,Row}from'antd';import{useStore}from'effector-react';import{useParams}from'react-router-dom';import{useTranslation}from'react-i18next';import{CheckoutDetailWrapper}from'../style';import{CreditCardDetail}from'./CreditCardDetail';import{ArrowIosRightSvg}from'../../../../Icons/Arrow';import{$orderModel}from'../../../../Models/order-model';import{Text}from'../../../../UIComponents/Typography/Text';import{$accountModel}from'../../../../Models/account-model';import{OverlaySettings}from'../../../../Components/Overlay';import{Title}from'../../../../UIComponents/Typography/Title';import{$appModel}from'../../../../Models/app';import{INFO_MAT}from'../../../../Constants/app';import{$orgModel}from'../../../../Models/org-model';import{FormControl,FormControlLabel,FormLabel,RadioGroup}from'@material-ui/core';import{PAYMENT_METHOD}from'../../../../Constants/payment';import{AllScreenModal}from'../../../../Components/Modal';import{CouponList}from'./CouponList';export var CheckoutDetail=function CheckoutDetail(_ref){var _data$organization2,_data$organization2$,_data$organization2$$,_currentProfile$curre,_currentProfile$curre2,_data$organization3,_data$organization3$,_data$organization3$$,_currentProfile$curre3,_currentProfile$curre4,_currentProfile$curre5,_currentProfile$curre6;var payment=_ref.payment,setPayment=_ref.setPayment,setCouponId=_ref.setCouponId;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useParams=useParams(),organization=_useParams.organization;var _useStore=useStore($appModel),$device=_useStore.$device;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),discount=_useState2[0],setDiscount=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),openCard=_useState4[0],setOpenCard=_useState4[1];var _useStore2=useStore($orderModel),data=_useStore2.$orgOrderCartList.data;var _useStore3=useStore($accountModel),currentProfile=_useStore3.$profiles.currentProfile;var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),cardWrapper=_useState6[0],setCardWrapper=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),couponView=_useState8[0],setCouponView=_useState8[1];var _useState9=useState(t('select_coupon')),_useState10=_slicedToArray(_useState9,2),couponName=_useState10[0],setCouponName=_useState10[1];var _useStore4=useStore($orgModel),orgPayments=_useStore4.$orgPaymentMethods.data;var onClose=function onClose(){setOpenCard(false);setCardWrapper(false);};var paymentInfo=useMemo(function(){return payment.id!==3?t(payment.title):payment.title;},[payment.id,payment.title,t]);var cardStyle=useCallback(function(number){var tmp='';for(var i=0;i<number.length;i++){if(i%4===0){tmp+=' '+number[i];}else{tmp+=number[i];}}return tmp;},[]);var handleChange=function handleChange(value){var item=arguments.length>1&&arguments[1]!==undefined?arguments[1]:undefined;if(item){setPayment({id:item.id,title:\"\".concat(cardStyle(item.card_number),\" \").concat(item.name),extraId:value});}else{setPayment({id:PAYMENT_METHOD[value].title,title:PAYMENT_METHOD[value].title,extraId:value});}};var generateOrgPayments=useCallback(function(item){if(item.status&&item.method!==3){if(item.method===1){return t('cash');}else if(item.method===2){return t('terminal');}}},[t]);var generateDiscountCost=useCallback(function(){var _data$organization,_data$organization$;var cost=data===null||data===void 0?void 0:(_data$organization=data[organization])===null||_data$organization===void 0?void 0:(_data$organization$=_data$organization[0])===null||_data$organization$===void 0?void 0:_data$organization$.total_cost;if(discount&&data){return cost-cost*(discount/100).toLocaleString('fi-Fi');}else{return cost.toLocaleString('fi-Fi');}},[discount,data,organization]);var handleClick=function handleClick(item){setCouponId(item.id);setCouponView(false);setCouponName(item.title);setDiscount(item.offerings_discount);};return/*#__PURE__*/React.createElement(CheckoutDetailWrapper,null,/*#__PURE__*/React.createElement(OverlaySettings,{openSettings:openCard,onClose:onClose,content:/*#__PURE__*/React.createElement(CreditCardDetail,{onClose:onClose,cardWrapper:cardWrapper,setCardWrapper:setCardWrapper,payment:payment,setPayment:setPayment})}),/*#__PURE__*/React.createElement(AllScreenModal,{visible:couponView,close:function close(){return setCouponView(false);},body:/*#__PURE__*/React.createElement(CouponList,{goBack:function goBack(){return setCouponView(false);},handleClick:handleClick})}),$device&&$device===INFO_MAT?/*#__PURE__*/React.createElement(Row,{gutter:[0,24]},/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(FormControl,null,/*#__PURE__*/React.createElement(FormLabel,{component:\"legend\"},t('select_payment_methods')),/*#__PURE__*/React.createElement(RadioGroup,{row:true,className:\"radio-wrapper\"},orgPayments&&orgPayments.map(function(item){return/*#__PURE__*/React.createElement(FormControlLabel,{className:\"radio\",key:item.id,checked:payment.extraId===item.method,value:item.status&&item.method,label:generateOrgPayments(item),control:item.method!==3?/*#__PURE__*/React.createElement(Radio,{color:\"primary\"}):/*#__PURE__*/React.createElement(\"span\",null),onChange:function onChange(){return handleChange(item.method);}});})))),/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Row,{align:\"middle\",justify:\"space-between\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Title,{color:\"var(--grey-dwed)\"},\"\".concat(t('total_cost'),\":\"))),/*#__PURE__*/React.createElement(Col,null,(data===null||data===void 0?void 0:data[organization])&&currentProfile&&/*#__PURE__*/React.createElement(Title,null,\"\".concat(data===null||data===void 0?void 0:(_data$organization2=data[organization])===null||_data$organization2===void 0?void 0:(_data$organization2$=_data$organization2[0])===null||_data$organization2$===void 0?void 0:(_data$organization2$$=_data$organization2$.total_cost)===null||_data$organization2$$===void 0?void 0:_data$organization2$$.toLocaleString('fi-Fi'),\"\\n                                                \").concat(currentProfile===null||currentProfile===void 0?void 0:(_currentProfile$curre=currentProfile.currency)===null||_currentProfile$curre===void 0?void 0:(_currentProfile$curre2=_currentProfile$curre.code)===null||_currentProfile$curre2===void 0?void 0:_currentProfile$curre2.toUpperCase())))))):/*#__PURE__*/React.createElement(Row,{gutter:[0,12]},/*#__PURE__*/React.createElement(Col,{span:24,onClick:function onClick(){return setOpenCard(true);}},/*#__PURE__*/React.createElement(Row,{justify:\"space-between\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Text,null,t('select_payment_methods'))),/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Text,{color:\"var(--grey-dwed)\"},paymentInfo)))),/*#__PURE__*/React.createElement(Col,{className:\"payment-icon-wrapper\"},/*#__PURE__*/React.createElement(ArrowIosRightSvg,null)))),/*#__PURE__*/React.createElement(Col,{span:24,onClick:function onClick(){return setCouponView(true);}},/*#__PURE__*/React.createElement(Row,{justify:\"space-between\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Text,null,t('coupon_discount'))),/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Text,{color:\"var(--grey-dwed)\"},couponName)))),/*#__PURE__*/React.createElement(Col,{className:\"payment-icon-wrapper\"},/*#__PURE__*/React.createElement(ArrowIosRightSvg,null)))),/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Row,{gutter:[12,0],align:\"middle\",justify:\"space-between\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Title,{color:\"var(--grey-dwed)\"},\"\".concat(t('cost'),\":\"))),/*#__PURE__*/React.createElement(Col,null,(data===null||data===void 0?void 0:data[organization])&&currentProfile&&/*#__PURE__*/React.createElement(Title,null,\"\".concat(data===null||data===void 0?void 0:(_data$organization3=data[organization])===null||_data$organization3===void 0?void 0:(_data$organization3$=_data$organization3[0])===null||_data$organization3$===void 0?void 0:(_data$organization3$$=_data$organization3$.total_cost)===null||_data$organization3$$===void 0?void 0:_data$organization3$$.toLocaleString('fi-Fi'),\"\\n                                                \").concat(currentProfile===null||currentProfile===void 0?void 0:(_currentProfile$curre3=currentProfile.currency)===null||_currentProfile$curre3===void 0?void 0:(_currentProfile$curre4=_currentProfile$curre3.code)===null||_currentProfile$curre4===void 0?void 0:_currentProfile$curre4.toUpperCase()))))),/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Row,{gutter:[12,0],align:\"middle\",justify:\"space-between\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Title,{color:\"var(--grey-dwed)\"},\"\".concat(t('discount'),\":\"))),/*#__PURE__*/React.createElement(Col,null,!!discount&&/*#__PURE__*/React.createElement(Title,null,\"\".concat(discount,\"%\"))))),/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Row,{gutter:[12,0],align:\"middle\",justify:\"space-between\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Title,{color:\"var(--grey-dwed)\"},\"\".concat(t('total_cost'),\":\"))),/*#__PURE__*/React.createElement(Col,null,(data===null||data===void 0?void 0:data[organization])&&currentProfile&&/*#__PURE__*/React.createElement(Title,null,\"\".concat(generateDiscountCost(),\"\\n                                                \").concat(currentProfile===null||currentProfile===void 0?void 0:(_currentProfile$curre5=currentProfile.currency)===null||_currentProfile$curre5===void 0?void 0:(_currentProfile$curre6=_currentProfile$curre5.code)===null||_currentProfile$curre6===void 0?void 0:_currentProfile$curre6.toUpperCase())))))));};","map":null,"metadata":{},"sourceType":"module"}