{"ast":null,"code":"import _defineProperty from\"/Users/zuhriddinkamilzanov/Desktop/tMed-mobile/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/zuhriddinkamilzanov/Desktop/tMed-mobile/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/zuhriddinkamilzanov/Desktop/tMed-mobile/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/zuhriddinkamilzanov/Desktop/tMed-mobile/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/zuhriddinkamilzanov/Desktop/tMed-mobile/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useCallback,useEffect,useState}from'react';import{removeMessageEvent,temporaryMessageMount}from'../../Models/chat-model';import copy from'copy-text-to-clipboard';import moment from'moment';import chat from'../../Service/chat';export function useChatAction(_ref){var partner_slug=_ref.partner_slug,formik=_ref.formik,inputRef=_ref.inputRef;//Local states\nvar _useState=useState(null),_useState2=_slicedToArray(_useState,2),anchorEl=_useState2[0],setAnchorEl=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),msgInfo=_useState4[0],setMsgInfo=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showDelMenu=_useState6[0],setShowDelMenu=_useState6[1];var handleMsgClick=function handleMsgClick(event,data,me){setAnchorEl({el:event.currentTarget,me:me});setMsgInfo(data);};var handleClosePopup=function handleClosePopup(){setAnchorEl(null);setMsgInfo(null);};useEffect(function(){if(!!anchorEl){setShowDelMenu(false);}},[anchorEl]);var handleCopy=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(msgInfo){copy(msgInfo.text);setAnchorEl(null);}case 1:case\"end\":return _context.stop();}}},_callee);})),[msgInfo]);var handleEdit=useCallback(function(){if(msgInfo){setAnchorEl(null);setMsgInfo(null);inputRef.current.focus();temporaryMessageMount(_objectSpread({type:'edit'},msgInfo));formik.setFieldValue('text',msgInfo.text);}},[msgInfo,formik,inputRef]);var handleReply=useCallback(function(){if(msgInfo){temporaryMessageMount(_objectSpread({type:'reply'},msgInfo));setAnchorEl(null);setMsgInfo(null);}},[msgInfo]);var handleCancelEditAndReply=useCallback(function(action){temporaryMessageMount(null);setMsgInfo(null);setShowDelMenu(false);},[]);var handleRemove=useCallback(function(type){if(msgInfo){if(type){var data={id:msgInfo.id,partner:partner_slug};if(type==='irrevocably'){data['params']=_defineProperty({},type,'1');}removeMessageEvent({key:partner_slug,id:msgInfo.id,date:moment(msgInfo.date).format('YYYY-MM-DD')});handleClosePopup();temporaryMessageMount(null);chat.removeMessageToUser(data).then(function(res){console.log(res);});}else{setShowDelMenu(true);}}},[partner_slug,msgInfo]);return{msgInfo:msgInfo,anchorEl:anchorEl,handleCopy:handleCopy,handleEdit:handleEdit,handleReply:handleReply,showDelMenu:showDelMenu,handleRemove:handleRemove,handleMsgClick:handleMsgClick,handleClosePopup:handleClosePopup,handleCancelEditAndReply:handleCancelEditAndReply};}","map":{"version":3,"sources":["/Users/zuhriddinkamilzanov/Desktop/tMed-mobile/src/Hooks/chat/use-chat-action.js"],"names":["useCallback","useEffect","useState","removeMessageEvent","temporaryMessageMount","copy","moment","chat","useChatAction","partner_slug","formik","inputRef","anchorEl","setAnchorEl","msgInfo","setMsgInfo","showDelMenu","setShowDelMenu","handleMsgClick","event","data","me","el","currentTarget","handleClosePopup","handleCopy","text","handleEdit","current","focus","type","setFieldValue","handleReply","handleCancelEditAndReply","action","handleRemove","id","partner","key","date","format","removeMessageToUser","then","res","console","log"],"mappings":"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","sourcesContent":["import {useCallback, useEffect, useState} from 'react'\nimport {removeMessageEvent, temporaryMessageMount} from '../../Models/chat-model'\nimport copy from 'copy-text-to-clipboard'\nimport moment from 'moment'\nimport chat from '../../Service/chat'\n\nexport function useChatAction({partner_slug, formik, inputRef}) {\n    //Local states\n    const [anchorEl, setAnchorEl] = useState(null)\n    const [msgInfo, setMsgInfo] = useState(null)\n    const [showDelMenu, setShowDelMenu] = useState(false)\n\n    const handleMsgClick = (event, data, me) => {\n        setAnchorEl({el: event.currentTarget, me})\n        setMsgInfo(data)\n    }\n\n    const handleClosePopup = () => {\n        setAnchorEl(null)\n        setMsgInfo(null)\n    }\n\n    useEffect(() => {\n        if (!!anchorEl) {\n            setShowDelMenu(false)\n        }\n    }, [anchorEl])\n\n\n    const handleCopy = useCallback(async () => {\n        if (msgInfo) {\n            copy(msgInfo.text)\n            setAnchorEl(null)\n        }\n    }, [msgInfo])\n\n    const handleEdit = useCallback(() => {\n        if (msgInfo) {\n            setAnchorEl(null)\n            setMsgInfo(null)\n            inputRef.current.focus()\n            temporaryMessageMount({type: 'edit', ...msgInfo})\n            formik.setFieldValue('text', msgInfo.text)\n        }\n    }, [msgInfo, formik, inputRef])\n\n    const handleReply = useCallback(() => {\n        if (msgInfo) {\n            temporaryMessageMount({type: 'reply', ...msgInfo})\n            setAnchorEl(null)\n            setMsgInfo(null)\n        }\n    }, [msgInfo])\n\n    const handleCancelEditAndReply = useCallback((action) => {\n        temporaryMessageMount(null)\n        setMsgInfo(null)\n        setShowDelMenu(false)\n    }, [])\n\n    const handleRemove = useCallback((type) => {\n        if (msgInfo) {\n            if (type) {\n                const data = {\n                    id: msgInfo.id,\n                    partner: partner_slug\n                }\n                if (type === 'irrevocably') {\n                    data['params'] = {[type]: '1'}\n                }\n                removeMessageEvent({\n                    key: partner_slug,\n                    id: msgInfo.id,\n                    date: moment(msgInfo.date).format('YYYY-MM-DD')\n                })\n                handleClosePopup()\n                temporaryMessageMount(null)\n\n                chat.removeMessageToUser(data)\n                    .then((res) => {\n                        console.log(res)\n                    })\n            } else {\n                setShowDelMenu(true)\n            }\n        }\n    }, [partner_slug, msgInfo])\n\n    return {\n        msgInfo,\n        anchorEl,\n        handleCopy,\n        handleEdit,\n        handleReply,\n        showDelMenu,\n        handleRemove,\n        handleMsgClick,\n        handleClosePopup,\n        handleCancelEditAndReply,\n    }\n}"]},"metadata":{},"sourceType":"module"}