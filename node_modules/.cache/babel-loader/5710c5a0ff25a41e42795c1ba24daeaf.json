{"ast":null,"code":"import React,{useCallback}from'react';import{useStore}from'effector-react';import{Col,Radio,Row,Space}from'antd';import{useTranslation}from'react-i18next';import payment from'../../../../../Service/payment';import{PlusFillSvg}from'../../../../../Icons/Plus';import{HUMOSvg,UZCARDSvg}from'../../../../../Icons/Cards';import{$paymentModel}from'../../../../../Models/payment-model';import{Title}from'../../../../../UIComponents/Typography/Title';import{CardInfoWrapper,PaymentMethodsWrapper,VerifyCardLink}from'../../style';import{PAYMENT_METHOD}from'../../../../../Constants/payment';import{$orgModel}from'../../../../../Models/org-model';export var PaymentMethod=function PaymentMethod(_ref){var onClose=_ref.onClose,setCardId=_ref.setCardId,setPayment=_ref.setPayment,handleAddCard=_ref.handleAddCard,setCardWrapper=_ref.setCardWrapper,paymentType=_ref.payment;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useStore=useStore($paymentModel),data=_useStore.$accountCard.data;var _useStore2=useStore($orgModel),orgPayments=_useStore2.$orgPaymentMethods.data;var cardStyle=useCallback(function(number){var tmp='';for(var i=0;i<number.length;i++){if(i%4===0){tmp+=' '+number[i];}else{tmp+=number[i];}}return tmp;},[]);var handleChange=function handleChange(value){var item=arguments.length>1&&arguments[1]!==undefined?arguments[1]:undefined;if(item){setPayment({id:item.id,title:\"\".concat(cardStyle(item.card_number),\" \").concat(item.name),extraId:value});}else{setPayment({id:PAYMENT_METHOD[value].title,title:PAYMENT_METHOD[value].title,extraId:value});}onClose();};var handleActivateCard=function handleActivateCard(item){var params={id:item.id};payment.resendPayMeCode(params).then(function(res){if(res){setCardWrapper(true);}}).finally(function(){setCardId(item.id);});};var generateCardType=function generateCardType(item){if(Number(item.card_number.substr(0,4))===8600){return/*#__PURE__*/React.createElement(UZCARDSvg,null);}else{return/*#__PURE__*/React.createElement(HUMOSvg,null);}};return/*#__PURE__*/React.createElement(Row,{gutter:[0,12],className:\"select-card-wrapper\"},/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Title,null,t('payment_method'))),data&&/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(PaymentMethodsWrapper,null,/*#__PURE__*/React.createElement(Radio.Group,{defaultValue:\"1\",value:paymentType.id},/*#__PURE__*/React.createElement(Space,{direction:\"vertical\"},orgPayments.find(function(item){return item.method===1&&item.status;})&&/*#__PURE__*/React.createElement(Radio,{value:\"cash\",onClick:function onClick(e){return handleChange(1);}},t('cash')),orgPayments.find(function(item){return item.method===2&&item.status;})&&/*#__PURE__*/React.createElement(Radio,{value:\"terminal\",onClick:function onClick(e){return handleChange(2);}},t('terminal')),data.map(function(item,idx){return/*#__PURE__*/React.createElement(Radio,{key:\"\".concat(idx+1),disabled:!item.verified,value:item.id,onClick:function onClick(e){return handleChange(3,item);}},generateCardType(item),/*#__PURE__*/React.createElement(CardInfoWrapper,null,\"\".concat(item.card_number.replace(/\\d{4}(?=.)/g,'$& '),\" \").concat(item.name&&item.name),!item.verified&&/*#__PURE__*/React.createElement(VerifyCardLink,{onClick:function onClick(){return handleActivateCard(item);}},t('activate'))));}))))),/*#__PURE__*/React.createElement(Col,{span:24,onClick:handleAddCard,className:\"add-card-wrapper\"},/*#__PURE__*/React.createElement(Row,{gutter:[12,0],align:\"middle\"},/*#__PURE__*/React.createElement(Col,{className:\"plus-svg\"},/*#__PURE__*/React.createElement(PlusFillSvg,null)),/*#__PURE__*/React.createElement(Col,null,t('add_card')))));};","map":null,"metadata":{},"sourceType":"module"}