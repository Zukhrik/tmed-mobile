{"ast":null,"code":"import _slicedToArray from\"/Users/zuhriddinkamilzanov/Desktop/t-med(mobile)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import moment from'moment';import{useUrlParams}from'../app';import{useOrgPayments}from'../org';import{useStore}from'effector-react';import order from'../../Service/order';import{URL_KEYS}from'../../Constants';import{useHistory}from'react-router-dom';import{formatter}from'./use-specialist-date';import{$orgModel}from'../../Models/org-model';import{useCallback,useEffect,useState}from'react';import{resetOrderCartList,resetOrgOrderCart}from'../../Models/order-model';export function useCheckout(couponId){useOrgPayments();var _useStore=useStore($orgModel),data=_useStore.$orgPaymentMethods.data;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),comment=_useState2[0],setComment=_useState2[1];var _useState3=useState(moment(new Date()).format('YYYY-MM-DD')),_useState4=_slicedToArray(_useState3,2),activeDay=_useState4[0],setActiveDay=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),meetDate=_useState6[0],setMeetDate=_useState6[1];var _useState7=useState({id:(data===null||data===void 0?void 0:data.status)?data===null||data===void 0?void 0:data['1'].id:null,title:(data===null||data===void 0?void 0:data.status)?data===null||data===void 0?void 0:data['1'].method:null,extraId:null}),_useState8=_slicedToArray(_useState7,2),payment=_useState8[0],setPayment=_useState8[1];var _useUrlParams=useUrlParams(),urlData=_useUrlParams.urlData;var spec_id=urlData[URL_KEYS.SPECIALIST_ID];var _activeDate=urlData[URL_KEYS.DATE];var time=urlData[URL_KEYS.TIME];var text=urlData[URL_KEYS.TEXT];var _useHistory=useHistory(),push=_useHistory.push;var handleSubmit=useCallback(function(){if(spec_id&&meetDate){var _data={meet_date:moment(new Date(meetDate)).format(formatter),client_comment:comment&&comment.trim().length>0?comment:null,responsible_id:spec_id,payment:payment.extraId,coupon_id:couponId,card_id:Number(payment.extraId)===3?payment.id:null};order.createOrder(_data).then(function(res){if(res){push(\"/records/detail/\".concat(res.data.id));resetOrgOrderCart();resetOrderCartList();}});}},[spec_id,comment,meetDate,payment,push,couponId]);useEffect(function(){var timeout=null;timeout=setTimeout(function(){if(!!activeDay&&!!time){setMeetDate(new Date(moment(\"\".concat(activeDay,\" \").concat(time)).toDate()).getTime());}else{setMeetDate(null);}},100);return function(){clearTimeout(timeout);timeout=null;};},[time,activeDay]);useEffect(function(){var timeout=null;timeout=setTimeout(function(){if(_activeDate){setActiveDay(_activeDate);}else{setActiveDay(moment(new Date()).format('YYYY-MM-DD'));}},100);return function(){clearTimeout(timeout);timeout=null;};},[_activeDate]);useEffect(function(){if(!text){setComment(text);}},[text]);useEffect(function(){var timeout=null;timeout=setTimeout(function(){if(!spec_id){push('/records/unregistered');}},600);return function(){clearTimeout(timeout);timeout=null;};},[spec_id,push]);return{comment:comment,handleSubmit:handleSubmit,activeDay:activeDay,meetDate:meetDate,setComment:setComment,payment:payment,setPayment:setPayment};}","map":null,"metadata":{},"sourceType":"module"}