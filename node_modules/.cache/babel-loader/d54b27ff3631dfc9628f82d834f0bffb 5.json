{"ast":null,"code":"import _slicedToArray from\"/Users/zuhriddinkamilzanov/Desktop/tMed-mobile/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useMemo,useState}from'react';import{Col,Radio,Row}from'antd';import{useStore}from'effector-react';import{useParams}from'react-router-dom';import{useTranslation}from'react-i18next';import{CheckoutDetailWrapper}from'../style';import{CreditCardDetail}from'./CreditCardDetail';import{ArrowIosRightSvg}from'../../../../Icons/Arrow';import{$orderModel}from'../../../../Models/order-model';import{Text}from'../../../../UIComponents/Typography/Text';import{$accountModel}from'../../../../Models/account-model';import{OverlaySettings}from'../../../../Components/Overlay';import{Title}from'../../../../UIComponents/Typography/Title';import{$appModel}from'../../../../Models/app';import{INFO_MAT}from'../../../../Constants/app';import{$orgModel}from'../../../../Models/org-model';import{FormControl,FormControlLabel,FormLabel,RadioGroup}from'@material-ui/core';import{PAYMENT_METHOD}from'../../../../Constants/payment';import{AllScreenModal}from'../../../../Components/Modal';import{CouponList}from'./CouponList';export var CheckoutDetail=function CheckoutDetail(_ref){var _data$organization2,_data$organization2$,_data$organization2$$,_currentProfile$curre,_currentProfile$curre2,_data$organization3,_data$organization3$,_data$organization3$$,_currentProfile$curre3,_currentProfile$curre4,_currentProfile$curre5,_currentProfile$curre6;var payment=_ref.payment,setPayment=_ref.setPayment,setCouponId=_ref.setCouponId;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useParams=useParams(),organization=_useParams.organization;var _useStore=useStore($appModel),$device=_useStore.$device;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),discount=_useState2[0],setDiscount=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),openCard=_useState4[0],setOpenCard=_useState4[1];var _useStore2=useStore($orderModel),data=_useStore2.$orgOrderCartList.data;var _useStore3=useStore($accountModel),currentProfile=_useStore3.$profiles.currentProfile;var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),cardWrapper=_useState6[0],setCardWrapper=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),couponView=_useState8[0],setCouponView=_useState8[1];var _useState9=useState(t('select_coupon')),_useState10=_slicedToArray(_useState9,2),couponName=_useState10[0],setCouponName=_useState10[1];var _useStore4=useStore($orgModel),orgPayments=_useStore4.$orgPaymentMethods.data;var onClose=function onClose(){setOpenCard(false);setCardWrapper(false);};var paymentInfo=useMemo(function(){return payment.id!==3?t(payment.title):payment.title;},[payment.id,payment.title,t]);var cardStyle=useCallback(function(number){var tmp='';for(var i=0;i<number.length;i++){if(i%4===0){tmp+=' '+number[i];}else{tmp+=number[i];}}return tmp;},[]);var handleChange=function handleChange(value){var item=arguments.length>1&&arguments[1]!==undefined?arguments[1]:undefined;if(item){setPayment({id:item.id,title:\"\".concat(cardStyle(item.card_number),\" \").concat(item.name),extraId:value});}else{setPayment({id:PAYMENT_METHOD[value].title,title:PAYMENT_METHOD[value].title,extraId:value});}};var generateOrgPayments=useCallback(function(item){if(item.status&&item.method!==3){if(item.method===1){return t('cash');}else if(item.method===2){return t('terminal');}}},[t]);var generateDiscountCost=useCallback(function(){var _data$organization,_data$organization$;var cost=data===null||data===void 0?void 0:(_data$organization=data[organization])===null||_data$organization===void 0?void 0:(_data$organization$=_data$organization[0])===null||_data$organization$===void 0?void 0:_data$organization$.total_cost;if(discount&&data){return cost-cost*(discount/100).toLocaleString('fi-Fi');}else{return cost.toLocaleString('fi-Fi');}},[discount,data,organization]);var handleClick=function handleClick(item){setCouponId(item.id);setCouponView(false);setCouponName(item.title);setDiscount(item.offerings_discount);};return/*#__PURE__*/React.createElement(CheckoutDetailWrapper,null,/*#__PURE__*/React.createElement(OverlaySettings,{openSettings:openCard,onClose:onClose,content:/*#__PURE__*/React.createElement(CreditCardDetail,{onClose:onClose,cardWrapper:cardWrapper,setCardWrapper:setCardWrapper,payment:payment,setPayment:setPayment})}),/*#__PURE__*/React.createElement(AllScreenModal,{visible:couponView,close:function close(){return setCouponView(false);},body:/*#__PURE__*/React.createElement(CouponList,{goBack:function goBack(){return setCouponView(false);},handleClick:handleClick})}),$device&&$device===INFO_MAT?/*#__PURE__*/React.createElement(Row,{gutter:[0,24]},/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(FormControl,null,/*#__PURE__*/React.createElement(FormLabel,{component:\"legend\"},t('select_payment_methods')),/*#__PURE__*/React.createElement(RadioGroup,{row:true,className:\"radio-wrapper\"},orgPayments&&orgPayments.map(function(item){return/*#__PURE__*/React.createElement(FormControlLabel,{className:\"radio\",key:item.id,checked:payment.extraId===item.method,value:item.status&&item.method,label:generateOrgPayments(item),control:item.method!==3?/*#__PURE__*/React.createElement(Radio,{color:\"primary\"}):/*#__PURE__*/React.createElement(\"span\",null),onChange:function onChange(){return handleChange(item.method);}});})))),/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Row,{align:\"middle\",justify:\"space-between\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Title,{color:\"var(--grey-dwed)\"},\"\".concat(t('total_cost'),\":\"))),/*#__PURE__*/React.createElement(Col,null,(data===null||data===void 0?void 0:data[organization])&&currentProfile&&/*#__PURE__*/React.createElement(Title,null,\"\".concat(data===null||data===void 0?void 0:(_data$organization2=data[organization])===null||_data$organization2===void 0?void 0:(_data$organization2$=_data$organization2[0])===null||_data$organization2$===void 0?void 0:(_data$organization2$$=_data$organization2$.total_cost)===null||_data$organization2$$===void 0?void 0:_data$organization2$$.toLocaleString('fi-Fi'),\"\\n                                                \").concat(currentProfile===null||currentProfile===void 0?void 0:(_currentProfile$curre=currentProfile.currency)===null||_currentProfile$curre===void 0?void 0:(_currentProfile$curre2=_currentProfile$curre.code)===null||_currentProfile$curre2===void 0?void 0:_currentProfile$curre2.toUpperCase())))))):/*#__PURE__*/React.createElement(Row,{gutter:[0,12]},/*#__PURE__*/React.createElement(Col,{span:24,onClick:function onClick(){return setOpenCard(true);}},/*#__PURE__*/React.createElement(Row,{justify:\"space-between\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Text,null,t('select_payment_methods'))),/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Text,{color:\"var(--grey-dwed)\"},paymentInfo)))),/*#__PURE__*/React.createElement(Col,{className:\"payment-icon-wrapper\"},/*#__PURE__*/React.createElement(ArrowIosRightSvg,null)))),/*#__PURE__*/React.createElement(Col,{span:24,onClick:function onClick(){return setCouponView(true);}},/*#__PURE__*/React.createElement(Row,{justify:\"space-between\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Text,null,t('coupon_discount'))),/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Text,{color:\"var(--grey-dwed)\"},couponName)))),/*#__PURE__*/React.createElement(Col,{className:\"payment-icon-wrapper\"},/*#__PURE__*/React.createElement(ArrowIosRightSvg,null)))),/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Row,{gutter:[12,0],align:\"middle\",justify:\"space-between\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Title,{color:\"var(--grey-dwed)\"},\"\".concat(t('cost'),\":\"))),/*#__PURE__*/React.createElement(Col,null,(data===null||data===void 0?void 0:data[organization])&&currentProfile&&/*#__PURE__*/React.createElement(Title,null,\"\".concat(data===null||data===void 0?void 0:(_data$organization3=data[organization])===null||_data$organization3===void 0?void 0:(_data$organization3$=_data$organization3[0])===null||_data$organization3$===void 0?void 0:(_data$organization3$$=_data$organization3$.total_cost)===null||_data$organization3$$===void 0?void 0:_data$organization3$$.toLocaleString('fi-Fi'),\"\\n                                                \").concat(currentProfile===null||currentProfile===void 0?void 0:(_currentProfile$curre3=currentProfile.currency)===null||_currentProfile$curre3===void 0?void 0:(_currentProfile$curre4=_currentProfile$curre3.code)===null||_currentProfile$curre4===void 0?void 0:_currentProfile$curre4.toUpperCase()))))),/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Row,{gutter:[12,0],align:\"middle\",justify:\"space-between\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Title,{color:\"var(--grey-dwed)\"},\"\".concat(t('discount'),\":\"))),/*#__PURE__*/React.createElement(Col,null,!!discount&&/*#__PURE__*/React.createElement(Title,null,\"\".concat(discount,\"%\"))))),/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Row,{gutter:[12,0],align:\"middle\",justify:\"space-between\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Title,{color:\"var(--grey-dwed)\"},\"\".concat(t('total_cost'),\":\"))),/*#__PURE__*/React.createElement(Col,null,(data===null||data===void 0?void 0:data[organization])&&currentProfile&&/*#__PURE__*/React.createElement(Title,null,\"\".concat(generateDiscountCost(),\"\\n                                                \").concat(currentProfile===null||currentProfile===void 0?void 0:(_currentProfile$curre5=currentProfile.currency)===null||_currentProfile$curre5===void 0?void 0:(_currentProfile$curre6=_currentProfile$curre5.code)===null||_currentProfile$curre6===void 0?void 0:_currentProfile$curre6.toUpperCase())))))));};","map":{"version":3,"sources":["/Users/zuhriddinkamilzanov/Desktop/tMed-mobile/src/Views/Checkout/InfoCard/CheckoutDetail/index.jsx"],"names":["React","useCallback","useMemo","useState","Col","Radio","Row","useStore","useParams","useTranslation","CheckoutDetailWrapper","CreditCardDetail","ArrowIosRightSvg","$orderModel","Text","$accountModel","OverlaySettings","Title","$appModel","INFO_MAT","$orgModel","FormControl","FormControlLabel","FormLabel","RadioGroup","PAYMENT_METHOD","AllScreenModal","CouponList","CheckoutDetail","payment","setPayment","setCouponId","t","organization","$device","discount","setDiscount","openCard","setOpenCard","data","$orgOrderCartList","currentProfile","$profiles","cardWrapper","setCardWrapper","couponView","setCouponView","couponName","setCouponName","orgPayments","$orgPaymentMethods","onClose","paymentInfo","id","title","cardStyle","number","tmp","i","length","handleChange","value","item","undefined","card_number","name","extraId","generateOrgPayments","status","method","generateDiscountCost","cost","total_cost","toLocaleString","handleClick","offerings_discount","map","currency","code","toUpperCase"],"mappings":"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","sourcesContent":["import React, {useCallback, useMemo, useState} from 'react'\nimport {Col, Radio, Row} from 'antd'\nimport {useStore} from 'effector-react'\nimport {useParams} from 'react-router-dom'\nimport {useTranslation} from 'react-i18next'\nimport {CheckoutDetailWrapper} from '../style'\nimport {CreditCardDetail} from './CreditCardDetail'\nimport {ArrowIosRightSvg} from '../../../../Icons/Arrow'\nimport {$orderModel} from '../../../../Models/order-model'\nimport {Text} from '../../../../UIComponents/Typography/Text'\nimport {$accountModel} from '../../../../Models/account-model'\nimport {OverlaySettings} from '../../../../Components/Overlay'\nimport {Title} from '../../../../UIComponents/Typography/Title'\nimport {$appModel} from '../../../../Models/app'\nimport {INFO_MAT} from '../../../../Constants/app'\nimport {$orgModel} from '../../../../Models/org-model'\nimport {FormControl, FormControlLabel, FormLabel, RadioGroup} from '@material-ui/core'\nimport {PAYMENT_METHOD} from '../../../../Constants/payment'\nimport {AllScreenModal} from '../../../../Components/Modal'\nimport {CouponList} from './CouponList'\n\nexport const CheckoutDetail = ({payment, setPayment, setCouponId}) => {\n    const {t} = useTranslation()\n    const {organization} = useParams()\n    const {$device} = useStore($appModel)\n    const [discount, setDiscount] = useState(null)\n    const [openCard, setOpenCard] = useState(false)\n    const {$orgOrderCartList: {data}} = useStore($orderModel)\n    const {$profiles: {currentProfile}} = useStore($accountModel)\n    const [cardWrapper, setCardWrapper] = useState(false)\n    const [couponView, setCouponView] = useState(false)\n    const [couponName, setCouponName] = useState(t('select_coupon'))\n    const {$orgPaymentMethods: {data: orgPayments}} = useStore($orgModel)\n    \n    const onClose = () => {\n        setOpenCard(false)\n        setCardWrapper(false)\n    }\n    \n    const paymentInfo = useMemo(() => {\n        return payment.id !== 3\n            ? t(payment.title)\n            : payment.title\n    }, [payment.id, payment.title, t])\n    \n    const cardStyle = useCallback((number) => {\n        let tmp = ''\n        for (let i = 0; i < number.length; i++) {\n            if (i % 4 === 0) {\n                tmp += ' ' + number[i]\n            } else {\n                tmp += number[i]\n            }\n        }\n        return tmp\n    }, [])\n    \n    const handleChange = (value, item = undefined) => {\n        if (item) {\n            setPayment({\n                id: item.id,\n                title: `${cardStyle(item.card_number)} ${item.name}`,\n                extraId: value\n            })\n        } else {\n            setPayment({\n                id: PAYMENT_METHOD[value].title,\n                title: PAYMENT_METHOD[value].title,\n                extraId: value\n            })\n        }\n    }\n    \n    const generateOrgPayments = useCallback((item) => {\n        if (item.status && item.method !== 3) {\n            if (item.method === 1) {\n                return t('cash')\n            } else if (item.method === 2) {\n                return t('terminal')\n            }\n        }\n    }, [t])\n    \n    const generateDiscountCost = useCallback(() => {\n        let cost = data?.[organization]?.[0]?.total_cost\n        if (discount && data) {\n            return cost - cost * (discount / 100).toLocaleString('fi-Fi')\n        } else {\n            return cost.toLocaleString('fi-Fi')\n        }\n    }, [discount, data, organization])\n    \n    const handleClick = (item) => {\n        setCouponId(item.id)\n        setCouponView(false)\n        setCouponName(item.title)\n        setDiscount(item.offerings_discount)\n    }\n    \n    return (\n        <CheckoutDetailWrapper>\n            <OverlaySettings\n                openSettings={openCard}\n                onClose={onClose}\n                content={<CreditCardDetail\n                    onClose={onClose}\n                    cardWrapper={cardWrapper}\n                    setCardWrapper={setCardWrapper}\n                    payment={payment}\n                    setPayment={setPayment}\n                />}\n            />\n            <AllScreenModal\n                visible={couponView}\n                close={() => setCouponView(false)}\n                body={<CouponList\n                    goBack={() => setCouponView(false)}\n                    handleClick={handleClick}\n                />}\n            />\n            {\n                $device && $device === INFO_MAT\n                    ? (\n                        <Row gutter={[0, 24]}>\n                            <Col span={24}>\n                                <FormControl>\n                                    <FormLabel component='legend'>\n                                        {t('select_payment_methods')}\n                                    </FormLabel>\n                                    <RadioGroup row className='radio-wrapper'>\n                                        {\n                                            orgPayments && orgPayments.map(item => (\n                                                <FormControlLabel\n                                                    className='radio'\n                                                    key={item.id}\n                                                    checked={payment.extraId === item.method}\n                                                    value={item.status && item.method}\n                                                    label={generateOrgPayments(item)}\n                                                    control={item.method !== 3 ?\n                                                        <Radio color='primary'/> : <span/>}\n                                                    onChange={() => handleChange(item.method)}\n                                                />\n                                            ))\n                                        }\n                                    </RadioGroup>\n                                </FormControl>\n                            </Col>\n                            <Col span={24}>\n                                <Row align='middle' justify='space-between'>\n                                    <Col>\n                                        <Title color='var(--grey-dwed)'>{`${t('total_cost')}:`}</Title>\n                                    </Col>\n                                    <Col>\n                                        {\n                                            data?.[organization] && currentProfile &&\n                                            <Title>\n                                                {`${data?.[organization]?.[0]?.total_cost?.toLocaleString('fi-Fi')}\n                                                ${currentProfile?.currency?.code?.toUpperCase()}`}\n                                            </Title>\n                                        }\n                                    </Col>\n                                </Row>\n                            </Col>\n                        </Row>\n                    )\n                    : (\n                        <Row gutter={[0, 12]}>\n                            <Col span={24} onClick={() => setOpenCard(true)}>\n                                <Row justify='space-between'>\n                                    <Col>\n                                        <Row>\n                                            <Col span={24}>\n                                                <Text>{t('select_payment_methods')}</Text>\n                                            </Col>\n                                            <Col span={24}>\n                                                <Text color='var(--grey-dwed)'>\n                                                    {paymentInfo}\n                                                </Text>\n                                            </Col>\n                                        </Row>\n                                    </Col>\n                                    <Col className='payment-icon-wrapper'>\n                                        <ArrowIosRightSvg/>\n                                    </Col>\n                                </Row>\n                            </Col>\n                            <Col span={24} onClick={() => setCouponView(true)}>\n                                <Row justify='space-between'>\n                                    <Col>\n                                        <Row>\n                                            <Col span={24}>\n                                                <Text>{t('coupon_discount')}</Text>\n                                            </Col>\n                                            <Col span={24}>\n                                                <Text color='var(--grey-dwed)'>\n                                                    {couponName}\n                                                </Text>\n                                            </Col>\n                                        </Row>\n                                    </Col>\n                                    <Col className='payment-icon-wrapper'>\n                                        <ArrowIosRightSvg/>\n                                    </Col>\n                                </Row>\n                            </Col>\n                            <Col span={24}>\n                                <Row gutter={[12, 0]} align='middle' justify='space-between'>\n                                    <Col>\n                                        <Title color='var(--grey-dwed)'>{`${t('cost')}:`}</Title>\n                                    </Col>\n                                    <Col>\n                                        {\n                                            data?.[organization] && currentProfile &&\n                                            <Title>\n                                                {`${data?.[organization]?.[0]?.total_cost?.toLocaleString('fi-Fi')}\n                                                ${currentProfile?.currency?.code?.toUpperCase()}`}\n                                            </Title>\n                                        }\n                                    </Col>\n                                </Row>\n                            </Col>\n                            <Col span={24}>\n                                <Row gutter={[12, 0]} align='middle' justify='space-between'>\n                                    <Col>\n                                        <Title color='var(--grey-dwed)'>{`${t('discount')}:`}</Title>\n                                    </Col>\n                                    <Col>\n                                        {\n                                            !!discount &&\n                                            <Title>{`${discount}%`}</Title>\n                                        }\n                                    </Col>\n                                </Row>\n                            </Col>\n                            <Col span={24}>\n                                <Row gutter={[12, 0]} align='middle' justify='space-between'>\n                                    <Col>\n                                        <Title color='var(--grey-dwed)'>{`${t('total_cost')}:`}</Title>\n                                    </Col>\n                                    <Col>\n                                        {\n                                            data?.[organization] && currentProfile &&\n                                            <Title>\n                                                {`${generateDiscountCost()}\n                                                ${currentProfile?.currency?.code?.toUpperCase()}`}\n                                            </Title>\n                                        }\n                                    </Col>\n                                </Row>\n                            </Col>\n                        </Row>\n                    )\n            }\n        </CheckoutDetailWrapper>\n    )\n}"]},"metadata":{},"sourceType":"module"}