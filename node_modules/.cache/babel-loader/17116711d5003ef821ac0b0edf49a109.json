{"ast":null,"code":"import _toConsumableArray from\"/Users/zuhriddinkamilzanov/Desktop/tMed-mobile/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/zuhriddinkamilzanov/Desktop/tMed-mobile/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{combine,createStore}from'effector';import{fetchAccountAvatars,fetchAccountCoupons,fetchAccountInfo,fetchAccountPData,fetchAccountVerify,fetchUpdateAccount}from'./effects';import Cookies from'js-cookie';import jwtDecode from'jwt-decode';import{getAccountInfo,getLinkedUsers,getOrganizations,getSpecialisms,getSpecOrganizations,getUpdated}from'./helper';import{PROFILE_TYPE}from'../../Constants';import{getCurrentAccount}from'./events';var $accountInfo=createStore({loading:false,data:null,error:false}).on(fetchAccountInfo.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchAccountInfo.fail,function(state,_ref){var error=_ref.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:{}});}).on(fetchAccountInfo.done,function(state,res){return _objectSpread(_objectSpread({},state),{},{data:res.result.data,error:false});});var $accountAvatars=createStore({loading:false,result:{},data:[],error:false}).on(fetchAccountAvatars.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchAccountAvatars.fail,function(state,_ref2){var error=_ref2.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[],result:{}});}).on(fetchAccountAvatars.done,function(state,res){return _objectSpread(_objectSpread({},state),{},{data:res.result.data.results,error:false});});var $accountPData=createStore({loading:false,data:null,error:false}).on(fetchAccountPData.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchAccountPData.fail,function(state,_ref3){var error=_ref3.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[]});}).on(fetchAccountPData.done,function(state,res){return _objectSpread(_objectSpread({},state),{},{data:res.result.data,error:false});});var $accountVideoVerify=createStore({loading:false,data:{},error:false}).on(fetchAccountVerify.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchAccountVerify.fail,function(state,_ref4){var error=_ref4.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:{}});}).on(fetchAccountVerify.done,function(state,_ref5){var result=_ref5.result;return _objectSpread(_objectSpread({},state),{},{data:result});});var currentProfile=localStorage.getItem('currentProfile');var $profiles=createStore({currentProfile:currentProfile?JSON.parse(currentProfile):null,linkedUsers:[],organizations:[],accountInfo:{},specialisms:[]}).on(fetchAccountInfo.done,function(state,_ref6){var data=_ref6.result.data,params=_ref6.params;var slug_name=jwtDecode(Cookies.get('token')).username;var accountInfo=getAccountInfo(data,slug_name);var linkedUsers=[_objectSpread({},accountInfo)].concat(_toConsumableArray(getLinkedUsers(data.linked_users))).sort(function(a,b){return a.slug_name.localeCompare(b.slug_name);});var specialisms=getSpecialisms(data.specialisms,slug_name);var organizations=[].concat(_toConsumableArray(getOrganizations(data.organizations,data)),_toConsumableArray(getSpecOrganizations(data.specialisms,data)));if(params&&params.actions){params.actions();}var info={category:data.main_cat,lang:data.user_lang,region:data.region,status:data.status,avatar:data.avatar,currency:data.currency||null};if(params&&params.actions){params.actions();}var currentAccount;if(state.currentProfile){if(state.currentProfile.type===PROFILE_TYPE.USER){currentAccount=_objectSpread(_objectSpread({},state.currentProfile),info);}else{var organization=organizations.find(function(item){return item.slug_name===state.currentProfile.slug_name;});if(organization){currentAccount=_objectSpread(_objectSpread({},state.currentProfile),{},{status:organization.status,category:organization.category,region:organization.region});}else{currentAccount=state.currentProfile;}}}else{currentAccount=accountInfo;}return _objectSpread(_objectSpread({},state),{},{accountInfo:accountInfo,linkedUsers:linkedUsers,specialisms:specialisms,organizations:organizations,currentProfile:currentAccount});}).on(getCurrentAccount,function(state){var payloads=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var currentAccount=null;var organizations=state.organizations,linkedUsers=state.linkedUsers;if(payloads){var type=payloads.type,slug_name=payloads.slug_name;if(type===PROFILE_TYPE.ORGANIZATION){currentAccount=organizations.find(function(item){return item.slug_name===slug_name;});}if(type===PROFILE_TYPE.USER){currentAccount=linkedUsers.find(function(item){return item.slug_name===slug_name;});}}return _objectSpread(_objectSpread({},state),{},{currentProfile:currentAccount});}).on(fetchUpdateAccount.done,function(state,_ref7){var result=_ref7.result.data,params=_ref7.params;if(params&&params.actions){params.actions();}var currentProfile=state.currentProfile,linkedUsers=state.linkedUsers,accountInfo=state.accountInfo;var data={category:result.main_cat,lang:result.user_lang,region:result.region,status:result.status,currency:result.currency||null};return _objectSpread(_objectSpread({},state),{},{accountInfo:_objectSpread(_objectSpread({},accountInfo),data),currentProfile:_objectSpread(_objectSpread({},currentProfile),data),linkedUsers:getUpdated(linkedUsers,currentProfile.slug_name,data)});}).on(fetchUpdateAccount.fail,function(state,_ref8){var params=_ref8.params;if(params&&params.actions){params.actions(true);}return _objectSpread({},state);});$profiles.watch(function(state){var currentProfile=state.currentProfile;if(currentProfile&&Object.values(currentProfile).length>0){localStorage.setItem('currentProfile',JSON.stringify(currentProfile));}else{localStorage.removeItem('currentProfile');}});var $accountCoupons=createStore({loading:false,data:[],error:false}).on(fetchAccountCoupons.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchAccountCoupons.fail,function(state,_ref9){var error=_ref9.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[]});}).on(fetchAccountCoupons.done,function(state,_ref10){var result=_ref10.result;return _objectSpread(_objectSpread({},state),{},{data:result.data});});export var $accountModel=combine({$profiles:$profiles,$accountInfo:$accountInfo,$accountPData:$accountPData,$accountAvatars:$accountAvatars,$accountCoupons:$accountCoupons,$accountVideoVerify:$accountVideoVerify});","map":null,"metadata":{},"sourceType":"module"}