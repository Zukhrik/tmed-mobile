{"ast":null,"code":"//---------------------------------------------------------------------\n//\n// QR Code Generator for JavaScript\n//\n// Copyright (c) 2009 Kazuhiko Arase\n//\n// URL: http://www.d-project.com/\n//\n// Licensed under the MIT license:\n//\thttp://www.opensource.org/licenses/mit-license.php\n//\n// The word 'QR Code' is registered trademark of\n// DENSO WAVE INCORPORATED\n//\thttp://www.denso-wave.com/qrcode/faqpatent-e.html\n//\n//---------------------------------------------------------------------\n//---------------微信小程序基于base64生成二维码插件修改-------------------\n\n/*\n * @Modified: Pudon\n * @demoURL: https://github.com/Pudon/weapp-qrcode\n * @Date: 2018-09-11 14:00:05 \n * @Last Modified by: Pudon\n * @Last Modified time: 2018-09-12 16:33:19\n */\n//---------------------------------------------------------------------\n\n/**\n * qrcode\n * @param typeNumber 1 to 40\n * @param errorCorrectLevel 'L','M','Q','H'\n */\nvar qrcode = function (typeNumber, errorCorrectLevel) {\n  var PAD0 = 0xEC;\n  var PAD1 = 0x11;\n  var _typeNumber = typeNumber;\n  var _errorCorrectLevel = QRErrorCorrectLevel[errorCorrectLevel];\n  var _modules = null;\n  var _moduleCount = 0;\n  var _dataCache = null;\n\n  var _dataList = new Array();\n\n  var _this = {};\n\n  var makeImpl = function (test, maskPattern) {\n    _moduleCount = _typeNumber * 4 + 17;\n\n    _modules = function (moduleCount) {\n      var modules = new Array(moduleCount);\n\n      for (var row = 0; row < moduleCount; row += 1) {\n        modules[row] = new Array(moduleCount);\n\n        for (var col = 0; col < moduleCount; col += 1) {\n          modules[row][col] = null;\n        }\n      }\n\n      return modules;\n    }(_moduleCount);\n\n    setupPositionProbePattern(0, 0);\n    setupPositionProbePattern(_moduleCount - 7, 0);\n    setupPositionProbePattern(0, _moduleCount - 7);\n    setupPositionAdjustPattern();\n    setupTimingPattern();\n    setupTypeInfo(test, maskPattern);\n\n    if (_typeNumber >= 7) {\n      setupTypeNumber(test);\n    }\n\n    if (_dataCache == null) {\n      _dataCache = createData(_typeNumber, _errorCorrectLevel, _dataList);\n    }\n\n    mapData(_dataCache, maskPattern);\n  };\n\n  var setupPositionProbePattern = function (row, col) {\n    for (var r = -1; r <= 7; r += 1) {\n      if (row + r <= -1 || _moduleCount <= row + r) continue;\n\n      for (var c = -1; c <= 7; c += 1) {\n        if (col + c <= -1 || _moduleCount <= col + c) continue;\n\n        if (0 <= r && r <= 6 && (c == 0 || c == 6) || 0 <= c && c <= 6 && (r == 0 || r == 6) || 2 <= r && r <= 4 && 2 <= c && c <= 4) {\n          _modules[row + r][col + c] = true;\n        } else {\n          _modules[row + r][col + c] = false;\n        }\n      }\n    }\n  };\n\n  var getBestMaskPattern = function () {\n    var minLostPoint = 0;\n    var pattern = 0;\n\n    for (var i = 0; i < 8; i += 1) {\n      makeImpl(true, i);\n      var lostPoint = QRUtil.getLostPoint(_this);\n\n      if (i == 0 || minLostPoint > lostPoint) {\n        minLostPoint = lostPoint;\n        pattern = i;\n      }\n    }\n\n    return pattern;\n  };\n\n  var setupTimingPattern = function () {\n    for (var r = 8; r < _moduleCount - 8; r += 1) {\n      if (_modules[r][6] != null) {\n        continue;\n      }\n\n      _modules[r][6] = r % 2 == 0;\n    }\n\n    for (var c = 8; c < _moduleCount - 8; c += 1) {\n      if (_modules[6][c] != null) {\n        continue;\n      }\n\n      _modules[6][c] = c % 2 == 0;\n    }\n  };\n\n  var setupPositionAdjustPattern = function () {\n    var pos = QRUtil.getPatternPosition(_typeNumber);\n\n    for (var i = 0; i < pos.length; i += 1) {\n      for (var j = 0; j < pos.length; j += 1) {\n        var row = pos[i];\n        var col = pos[j];\n\n        if (_modules[row][col] != null) {\n          continue;\n        }\n\n        for (var r = -2; r <= 2; r += 1) {\n          for (var c = -2; c <= 2; c += 1) {\n            if (r == -2 || r == 2 || c == -2 || c == 2 || r == 0 && c == 0) {\n              _modules[row + r][col + c] = true;\n            } else {\n              _modules[row + r][col + c] = false;\n            }\n          }\n        }\n      }\n    }\n  };\n\n  var setupTypeNumber = function (test) {\n    var bits = QRUtil.getBCHTypeNumber(_typeNumber);\n\n    for (var i = 0; i < 18; i += 1) {\n      var mod = !test && (bits >> i & 1) == 1;\n      _modules[Math.floor(i / 3)][i % 3 + _moduleCount - 8 - 3] = mod;\n    }\n\n    for (var i = 0; i < 18; i += 1) {\n      var mod = !test && (bits >> i & 1) == 1;\n      _modules[i % 3 + _moduleCount - 8 - 3][Math.floor(i / 3)] = mod;\n    }\n  };\n\n  var setupTypeInfo = function (test, maskPattern) {\n    var data = _errorCorrectLevel << 3 | maskPattern;\n    var bits = QRUtil.getBCHTypeInfo(data); // vertical\n\n    for (var i = 0; i < 15; i += 1) {\n      var mod = !test && (bits >> i & 1) == 1;\n\n      if (i < 6) {\n        _modules[i][8] = mod;\n      } else if (i < 8) {\n        _modules[i + 1][8] = mod;\n      } else {\n        _modules[_moduleCount - 15 + i][8] = mod;\n      }\n    } // horizontal\n\n\n    for (var i = 0; i < 15; i += 1) {\n      var mod = !test && (bits >> i & 1) == 1;\n\n      if (i < 8) {\n        _modules[8][_moduleCount - i - 1] = mod;\n      } else if (i < 9) {\n        _modules[8][15 - i - 1 + 1] = mod;\n      } else {\n        _modules[8][15 - i - 1] = mod;\n      }\n    } // fixed module\n\n\n    _modules[_moduleCount - 8][8] = !test;\n  };\n\n  var mapData = function (data, maskPattern) {\n    var inc = -1;\n    var row = _moduleCount - 1;\n    var bitIndex = 7;\n    var byteIndex = 0;\n    var maskFunc = QRUtil.getMaskFunction(maskPattern);\n\n    for (var col = _moduleCount - 1; col > 0; col -= 2) {\n      if (col == 6) col -= 1;\n\n      while (true) {\n        for (var c = 0; c < 2; c += 1) {\n          if (_modules[row][col - c] == null) {\n            var dark = false;\n\n            if (byteIndex < data.length) {\n              dark = (data[byteIndex] >>> bitIndex & 1) == 1;\n            }\n\n            var mask = maskFunc(row, col - c);\n\n            if (mask) {\n              dark = !dark;\n            }\n\n            _modules[row][col - c] = dark;\n            bitIndex -= 1;\n\n            if (bitIndex == -1) {\n              byteIndex += 1;\n              bitIndex = 7;\n            }\n          }\n        }\n\n        row += inc;\n\n        if (row < 0 || _moduleCount <= row) {\n          row -= inc;\n          inc = -inc;\n          break;\n        }\n      }\n    }\n  };\n\n  var createBytes = function (buffer, rsBlocks) {\n    var offset = 0;\n    var maxDcCount = 0;\n    var maxEcCount = 0;\n    var dcdata = new Array(rsBlocks.length);\n    var ecdata = new Array(rsBlocks.length);\n\n    for (var r = 0; r < rsBlocks.length; r += 1) {\n      var dcCount = rsBlocks[r].dataCount;\n      var ecCount = rsBlocks[r].totalCount - dcCount;\n      maxDcCount = Math.max(maxDcCount, dcCount);\n      maxEcCount = Math.max(maxEcCount, ecCount);\n      dcdata[r] = new Array(dcCount);\n\n      for (var i = 0; i < dcdata[r].length; i += 1) {\n        dcdata[r][i] = 0xff & buffer.getBuffer()[i + offset];\n      }\n\n      offset += dcCount;\n      var rsPoly = QRUtil.getErrorCorrectPolynomial(ecCount);\n      var rawPoly = qrPolynomial(dcdata[r], rsPoly.getLength() - 1);\n      var modPoly = rawPoly.mod(rsPoly);\n      ecdata[r] = new Array(rsPoly.getLength() - 1);\n\n      for (var i = 0; i < ecdata[r].length; i += 1) {\n        var modIndex = i + modPoly.getLength() - ecdata[r].length;\n        ecdata[r][i] = modIndex >= 0 ? modPoly.getAt(modIndex) : 0;\n      }\n    }\n\n    var totalCodeCount = 0;\n\n    for (var i = 0; i < rsBlocks.length; i += 1) {\n      totalCodeCount += rsBlocks[i].totalCount;\n    }\n\n    var data = new Array(totalCodeCount);\n    var index = 0;\n\n    for (var i = 0; i < maxDcCount; i += 1) {\n      for (var r = 0; r < rsBlocks.length; r += 1) {\n        if (i < dcdata[r].length) {\n          data[index] = dcdata[r][i];\n          index += 1;\n        }\n      }\n    }\n\n    for (var i = 0; i < maxEcCount; i += 1) {\n      for (var r = 0; r < rsBlocks.length; r += 1) {\n        if (i < ecdata[r].length) {\n          data[index] = ecdata[r][i];\n          index += 1;\n        }\n      }\n    }\n\n    return data;\n  };\n\n  var createData = function (typeNumber, errorCorrectLevel, dataList) {\n    var rsBlocks = QRRSBlock.getRSBlocks(typeNumber, errorCorrectLevel);\n    var buffer = qrBitBuffer();\n\n    for (var i = 0; i < dataList.length; i += 1) {\n      var data = dataList[i];\n      buffer.put(data.getMode(), 4);\n      buffer.put(data.getLength(), QRUtil.getLengthInBits(data.getMode(), typeNumber));\n      data.write(buffer);\n    } // calc num max data.\n\n\n    var totalDataCount = 0;\n\n    for (var i = 0; i < rsBlocks.length; i += 1) {\n      totalDataCount += rsBlocks[i].dataCount;\n    }\n\n    if (buffer.getLengthInBits() > totalDataCount * 8) {\n      throw new Error('code length overflow. (' + buffer.getLengthInBits() + '>' + totalDataCount * 8 + ')');\n    } // end code\n\n\n    if (buffer.getLengthInBits() + 4 <= totalDataCount * 8) {\n      buffer.put(0, 4);\n    } // padding\n\n\n    while (buffer.getLengthInBits() % 8 != 0) {\n      buffer.putBit(false);\n    } // padding\n\n\n    while (true) {\n      if (buffer.getLengthInBits() >= totalDataCount * 8) {\n        break;\n      }\n\n      buffer.put(PAD0, 8);\n\n      if (buffer.getLengthInBits() >= totalDataCount * 8) {\n        break;\n      }\n\n      buffer.put(PAD1, 8);\n    }\n\n    return createBytes(buffer, rsBlocks);\n  };\n\n  _this.addData = function (data) {\n    var newData = qr8BitByte(data);\n\n    _dataList.push(newData);\n\n    _dataCache = null;\n  };\n\n  _this.isDark = function (row, col) {\n    if (row < 0 || _moduleCount <= row || col < 0 || _moduleCount <= col) {\n      throw new Error(row + ',' + col);\n    }\n\n    return _modules[row][col];\n  };\n\n  _this.getModuleCount = function () {\n    return _moduleCount;\n  };\n\n  _this.make = function () {\n    makeImpl(false, getBestMaskPattern());\n  };\n\n  _this.createTableTag = function (cellSize, margin) {\n    cellSize = cellSize || 2;\n    margin = typeof margin == 'undefined' ? cellSize * 4 : margin;\n    var qrHtml = '';\n    qrHtml += '<table style=\"';\n    qrHtml += ' border-width: 0px; border-style: none;';\n    qrHtml += ' border-collapse: collapse;';\n    qrHtml += ' padding: 0px; margin: ' + margin + 'px;';\n    qrHtml += '\">';\n    qrHtml += '<tbody>';\n\n    for (var r = 0; r < _this.getModuleCount(); r += 1) {\n      qrHtml += '<tr>';\n\n      for (var c = 0; c < _this.getModuleCount(); c += 1) {\n        qrHtml += '<td style=\"';\n        qrHtml += ' border-width: 0px; border-style: none;';\n        qrHtml += ' border-collapse: collapse;';\n        qrHtml += ' padding: 0px; margin: 0px;';\n        qrHtml += ' width: ' + cellSize + 'px;';\n        qrHtml += ' height: ' + cellSize + 'px;';\n        qrHtml += ' background-color: ';\n        qrHtml += _this.isDark(r, c) ? '#000000' : '#ffffff';\n        qrHtml += ';';\n        qrHtml += '\"/>';\n      }\n\n      qrHtml += '</tr>';\n    }\n\n    qrHtml += '</tbody>';\n    qrHtml += '</table>';\n    return qrHtml;\n  };\n\n  _this.createImgTag = function (cellSize, margin, size) {\n    cellSize = cellSize || 2;\n    margin = typeof margin == 'undefined' ? cellSize * 4 : margin;\n    var min = margin;\n    var max = _this.getModuleCount() * cellSize + margin;\n    return createImgTag(size, size, function (x, y) {\n      if (min <= x && x < max && min <= y && y < max) {\n        var c = Math.floor((x - min) / cellSize);\n        var r = Math.floor((y - min) / cellSize);\n        return _this.isDark(r, c) ? 0 : 1;\n      } else {\n        return 1;\n      }\n    });\n  };\n\n  return _this;\n}; //---------------------------------------------------------------------\n// qrcode.stringToBytes\n//---------------------------------------------------------------------\n\n\nqrcode.stringToBytes = function (s) {\n  var bytes = new Array();\n\n  for (var i = 0; i < s.length; i += 1) {\n    var c = s.charCodeAt(i);\n    bytes.push(c & 0xff);\n  }\n\n  return bytes;\n}; //---------------------------------------------------------------------\n// qrcode.createStringToBytes\n//---------------------------------------------------------------------\n\n/**\n * @param unicodeData base64 string of byte array.\n * [16bit Unicode],[16bit Bytes], ...\n * @param numChars\n */\n\n\nqrcode.createStringToBytes = function (unicodeData, numChars) {\n  // create conversion map.\n  var unicodeMap = function () {\n    var bin = base64DecodeInputStream(unicodeData);\n\n    var read = function () {\n      var b = bin.read();\n      if (b == -1) throw new Error();\n      return b;\n    };\n\n    var count = 0;\n    var unicodeMap = {};\n\n    while (true) {\n      var b0 = bin.read();\n      if (b0 == -1) break;\n      var b1 = read();\n      var b2 = read();\n      var b3 = read();\n      var k = String.fromCharCode(b0 << 8 | b1);\n      var v = b2 << 8 | b3;\n      unicodeMap[k] = v;\n      count += 1;\n    }\n\n    if (count != numChars) {\n      throw new Error(count + ' != ' + numChars);\n    }\n\n    return unicodeMap;\n  }();\n\n  var unknownChar = '?'.charCodeAt(0);\n  return function (s) {\n    var bytes = new Array();\n\n    for (var i = 0; i < s.length; i += 1) {\n      var c = s.charCodeAt(i);\n\n      if (c < 128) {\n        bytes.push(c);\n      } else {\n        var b = unicodeMap[s.charAt(i)];\n\n        if (typeof b == 'number') {\n          if ((b & 0xff) == b) {\n            // 1byte\n            bytes.push(b);\n          } else {\n            // 2bytes\n            bytes.push(b >>> 8);\n            bytes.push(b & 0xff);\n          }\n        } else {\n          bytes.push(unknownChar);\n        }\n      }\n    }\n\n    return bytes;\n  };\n}; //---------------------------------------------------------------------\n// QRMode\n//---------------------------------------------------------------------\n\n\nvar QRMode = {\n  MODE_NUMBER: 1 << 0,\n  MODE_ALPHA_NUM: 1 << 1,\n  MODE_8BIT_BYTE: 1 << 2,\n  MODE_KANJI: 1 << 3\n}; //---------------------------------------------------------------------\n// QRErrorCorrectLevel\n//---------------------------------------------------------------------\n\nvar QRErrorCorrectLevel = {\n  L: 1,\n  M: 0,\n  Q: 3,\n  H: 2\n}; //---------------------------------------------------------------------\n// QRMaskPattern\n//---------------------------------------------------------------------\n\nvar QRMaskPattern = {\n  PATTERN000: 0,\n  PATTERN001: 1,\n  PATTERN010: 2,\n  PATTERN011: 3,\n  PATTERN100: 4,\n  PATTERN101: 5,\n  PATTERN110: 6,\n  PATTERN111: 7\n}; //---------------------------------------------------------------------\n// QRUtil\n//---------------------------------------------------------------------\n\nvar QRUtil = function () {\n  var PATTERN_POSITION_TABLE = [[], [6, 18], [6, 22], [6, 26], [6, 30], [6, 34], [6, 22, 38], [6, 24, 42], [6, 26, 46], [6, 28, 50], [6, 30, 54], [6, 32, 58], [6, 34, 62], [6, 26, 46, 66], [6, 26, 48, 70], [6, 26, 50, 74], [6, 30, 54, 78], [6, 30, 56, 82], [6, 30, 58, 86], [6, 34, 62, 90], [6, 28, 50, 72, 94], [6, 26, 50, 74, 98], [6, 30, 54, 78, 102], [6, 28, 54, 80, 106], [6, 32, 58, 84, 110], [6, 30, 58, 86, 114], [6, 34, 62, 90, 118], [6, 26, 50, 74, 98, 122], [6, 30, 54, 78, 102, 126], [6, 26, 52, 78, 104, 130], [6, 30, 56, 82, 108, 134], [6, 34, 60, 86, 112, 138], [6, 30, 58, 86, 114, 142], [6, 34, 62, 90, 118, 146], [6, 30, 54, 78, 102, 126, 150], [6, 24, 50, 76, 102, 128, 154], [6, 28, 54, 80, 106, 132, 158], [6, 32, 58, 84, 110, 136, 162], [6, 26, 54, 82, 110, 138, 166], [6, 30, 58, 86, 114, 142, 170]];\n  var G15 = 1 << 10 | 1 << 8 | 1 << 5 | 1 << 4 | 1 << 2 | 1 << 1 | 1 << 0;\n  var G18 = 1 << 12 | 1 << 11 | 1 << 10 | 1 << 9 | 1 << 8 | 1 << 5 | 1 << 2 | 1 << 0;\n  var G15_MASK = 1 << 14 | 1 << 12 | 1 << 10 | 1 << 4 | 1 << 1;\n  var _this = {};\n\n  var getBCHDigit = function (data) {\n    var digit = 0;\n\n    while (data != 0) {\n      digit += 1;\n      data >>>= 1;\n    }\n\n    return digit;\n  };\n\n  _this.getBCHTypeInfo = function (data) {\n    var d = data << 10;\n\n    while (getBCHDigit(d) - getBCHDigit(G15) >= 0) {\n      d ^= G15 << getBCHDigit(d) - getBCHDigit(G15);\n    }\n\n    return (data << 10 | d) ^ G15_MASK;\n  };\n\n  _this.getBCHTypeNumber = function (data) {\n    var d = data << 12;\n\n    while (getBCHDigit(d) - getBCHDigit(G18) >= 0) {\n      d ^= G18 << getBCHDigit(d) - getBCHDigit(G18);\n    }\n\n    return data << 12 | d;\n  };\n\n  _this.getPatternPosition = function (typeNumber) {\n    return PATTERN_POSITION_TABLE[typeNumber - 1];\n  };\n\n  _this.getMaskFunction = function (maskPattern) {\n    switch (maskPattern) {\n      case QRMaskPattern.PATTERN000:\n        return function (i, j) {\n          return (i + j) % 2 == 0;\n        };\n\n      case QRMaskPattern.PATTERN001:\n        return function (i, j) {\n          return i % 2 == 0;\n        };\n\n      case QRMaskPattern.PATTERN010:\n        return function (i, j) {\n          return j % 3 == 0;\n        };\n\n      case QRMaskPattern.PATTERN011:\n        return function (i, j) {\n          return (i + j) % 3 == 0;\n        };\n\n      case QRMaskPattern.PATTERN100:\n        return function (i, j) {\n          return (Math.floor(i / 2) + Math.floor(j / 3)) % 2 == 0;\n        };\n\n      case QRMaskPattern.PATTERN101:\n        return function (i, j) {\n          return i * j % 2 + i * j % 3 == 0;\n        };\n\n      case QRMaskPattern.PATTERN110:\n        return function (i, j) {\n          return (i * j % 2 + i * j % 3) % 2 == 0;\n        };\n\n      case QRMaskPattern.PATTERN111:\n        return function (i, j) {\n          return (i * j % 3 + (i + j) % 2) % 2 == 0;\n        };\n\n      default:\n        throw new Error('bad maskPattern:' + maskPattern);\n    }\n  };\n\n  _this.getErrorCorrectPolynomial = function (errorCorrectLength) {\n    var a = qrPolynomial([1], 0);\n\n    for (var i = 0; i < errorCorrectLength; i += 1) {\n      a = a.multiply(qrPolynomial([1, QRMath.gexp(i)], 0));\n    }\n\n    return a;\n  };\n\n  _this.getLengthInBits = function (mode, type) {\n    if (1 <= type && type < 10) {\n      // 1 - 9\n      switch (mode) {\n        case QRMode.MODE_NUMBER:\n          return 10;\n\n        case QRMode.MODE_ALPHA_NUM:\n          return 9;\n\n        case QRMode.MODE_8BIT_BYTE:\n          return 8;\n\n        case QRMode.MODE_KANJI:\n          return 8;\n\n        default:\n          throw new Error('mode:' + mode);\n      }\n    } else if (type < 27) {\n      // 10 - 26\n      switch (mode) {\n        case QRMode.MODE_NUMBER:\n          return 12;\n\n        case QRMode.MODE_ALPHA_NUM:\n          return 11;\n\n        case QRMode.MODE_8BIT_BYTE:\n          return 16;\n\n        case QRMode.MODE_KANJI:\n          return 10;\n\n        default:\n          throw new Error('mode:' + mode);\n      }\n    } else if (type < 41) {\n      // 27 - 40\n      switch (mode) {\n        case QRMode.MODE_NUMBER:\n          return 14;\n\n        case QRMode.MODE_ALPHA_NUM:\n          return 13;\n\n        case QRMode.MODE_8BIT_BYTE:\n          return 16;\n\n        case QRMode.MODE_KANJI:\n          return 12;\n\n        default:\n          throw new Error('mode:' + mode);\n      }\n    } else {\n      throw new Error('type:' + type);\n    }\n  };\n\n  _this.getLostPoint = function (qrcode) {\n    var moduleCount = qrcode.getModuleCount();\n    var lostPoint = 0; // LEVEL1\n\n    for (var row = 0; row < moduleCount; row += 1) {\n      for (var col = 0; col < moduleCount; col += 1) {\n        var sameCount = 0;\n        var dark = qrcode.isDark(row, col);\n\n        for (var r = -1; r <= 1; r += 1) {\n          if (row + r < 0 || moduleCount <= row + r) {\n            continue;\n          }\n\n          for (var c = -1; c <= 1; c += 1) {\n            if (col + c < 0 || moduleCount <= col + c) {\n              continue;\n            }\n\n            if (r == 0 && c == 0) {\n              continue;\n            }\n\n            if (dark == qrcode.isDark(row + r, col + c)) {\n              sameCount += 1;\n            }\n          }\n        }\n\n        if (sameCount > 5) {\n          lostPoint += 3 + sameCount - 5;\n        }\n      }\n    }\n\n    ; // LEVEL2\n\n    for (var row = 0; row < moduleCount - 1; row += 1) {\n      for (var col = 0; col < moduleCount - 1; col += 1) {\n        var count = 0;\n        if (qrcode.isDark(row, col)) count += 1;\n        if (qrcode.isDark(row + 1, col)) count += 1;\n        if (qrcode.isDark(row, col + 1)) count += 1;\n        if (qrcode.isDark(row + 1, col + 1)) count += 1;\n\n        if (count == 0 || count == 4) {\n          lostPoint += 3;\n        }\n      }\n    } // LEVEL3\n\n\n    for (var row = 0; row < moduleCount; row += 1) {\n      for (var col = 0; col < moduleCount - 6; col += 1) {\n        if (qrcode.isDark(row, col) && !qrcode.isDark(row, col + 1) && qrcode.isDark(row, col + 2) && qrcode.isDark(row, col + 3) && qrcode.isDark(row, col + 4) && !qrcode.isDark(row, col + 5) && qrcode.isDark(row, col + 6)) {\n          lostPoint += 40;\n        }\n      }\n    }\n\n    for (var col = 0; col < moduleCount; col += 1) {\n      for (var row = 0; row < moduleCount - 6; row += 1) {\n        if (qrcode.isDark(row, col) && !qrcode.isDark(row + 1, col) && qrcode.isDark(row + 2, col) && qrcode.isDark(row + 3, col) && qrcode.isDark(row + 4, col) && !qrcode.isDark(row + 5, col) && qrcode.isDark(row + 6, col)) {\n          lostPoint += 40;\n        }\n      }\n    } // LEVEL4\n\n\n    var darkCount = 0;\n\n    for (var col = 0; col < moduleCount; col += 1) {\n      for (var row = 0; row < moduleCount; row += 1) {\n        if (qrcode.isDark(row, col)) {\n          darkCount += 1;\n        }\n      }\n    }\n\n    var ratio = Math.abs(100 * darkCount / moduleCount / moduleCount - 50) / 5;\n    lostPoint += ratio * 10;\n    return lostPoint;\n  };\n\n  return _this;\n}(); //---------------------------------------------------------------------\n// QRMath\n//---------------------------------------------------------------------\n\n\nvar QRMath = function () {\n  var EXP_TABLE = new Array(256);\n  var LOG_TABLE = new Array(256); // initialize tables\n\n  for (var i = 0; i < 8; i += 1) {\n    EXP_TABLE[i] = 1 << i;\n  }\n\n  for (var i = 8; i < 256; i += 1) {\n    EXP_TABLE[i] = EXP_TABLE[i - 4] ^ EXP_TABLE[i - 5] ^ EXP_TABLE[i - 6] ^ EXP_TABLE[i - 8];\n  }\n\n  for (var i = 0; i < 255; i += 1) {\n    LOG_TABLE[EXP_TABLE[i]] = i;\n  }\n\n  var _this = {};\n\n  _this.glog = function (n) {\n    if (n < 1) {\n      throw new Error('glog(' + n + ')');\n    }\n\n    return LOG_TABLE[n];\n  };\n\n  _this.gexp = function (n) {\n    while (n < 0) {\n      n += 255;\n    }\n\n    while (n >= 256) {\n      n -= 255;\n    }\n\n    return EXP_TABLE[n];\n  };\n\n  return _this;\n}(); //---------------------------------------------------------------------\n// qrPolynomial\n//---------------------------------------------------------------------\n\n\nfunction qrPolynomial(num, shift) {\n  if (typeof num.length == 'undefined') {\n    throw new Error(num.length + '/' + shift);\n  }\n\n  var _num = function () {\n    var offset = 0;\n\n    while (offset < num.length && num[offset] == 0) {\n      offset += 1;\n    }\n\n    var _num = new Array(num.length - offset + shift);\n\n    for (var i = 0; i < num.length - offset; i += 1) {\n      _num[i] = num[i + offset];\n    }\n\n    return _num;\n  }();\n\n  var _this = {};\n\n  _this.getAt = function (index) {\n    return _num[index];\n  };\n\n  _this.getLength = function () {\n    return _num.length;\n  };\n\n  _this.multiply = function (e) {\n    var num = new Array(_this.getLength() + e.getLength() - 1);\n\n    for (var i = 0; i < _this.getLength(); i += 1) {\n      for (var j = 0; j < e.getLength(); j += 1) {\n        num[i + j] ^= QRMath.gexp(QRMath.glog(_this.getAt(i)) + QRMath.glog(e.getAt(j)));\n      }\n    }\n\n    return qrPolynomial(num, 0);\n  };\n\n  _this.mod = function (e) {\n    if (_this.getLength() - e.getLength() < 0) {\n      return _this;\n    }\n\n    var ratio = QRMath.glog(_this.getAt(0)) - QRMath.glog(e.getAt(0));\n    var num = new Array(_this.getLength());\n\n    for (var i = 0; i < _this.getLength(); i += 1) {\n      num[i] = _this.getAt(i);\n    }\n\n    for (var i = 0; i < e.getLength(); i += 1) {\n      num[i] ^= QRMath.gexp(QRMath.glog(e.getAt(i)) + ratio);\n    } // recursive call\n\n\n    return qrPolynomial(num, 0).mod(e);\n  };\n\n  return _this;\n}\n\n; //---------------------------------------------------------------------\n// QRRSBlock\n//---------------------------------------------------------------------\n\nvar QRRSBlock = function () {\n  // [1: [L, M, Q, H], ..]\n  var RS_BLOCK_TABLE = [[1, 26, 19], [1, 26, 16], [1, 26, 13], [1, 26, 9], [1, 44, 34], [1, 44, 28], [1, 44, 22], [1, 44, 16], [1, 70, 55], [1, 70, 44], [2, 35, 17], [2, 35, 13], [1, 100, 80], [2, 50, 32], [2, 50, 24], [4, 25, 9], [1, 134, 108], [2, 67, 43], [2, 33, 15, 2, 34, 16], [2, 33, 11, 2, 34, 12], [2, 86, 68], [4, 43, 27], [4, 43, 19], [4, 43, 15], [2, 98, 78], [4, 49, 31], [2, 32, 14, 4, 33, 15], [4, 39, 13, 1, 40, 14], [2, 121, 97], [2, 60, 38, 2, 61, 39], [4, 40, 18, 2, 41, 19], [4, 40, 14, 2, 41, 15], [2, 146, 116], [3, 58, 36, 2, 59, 37], [4, 36, 16, 4, 37, 17], [4, 36, 12, 4, 37, 13], [2, 86, 68, 2, 87, 69], [4, 69, 43, 1, 70, 44], [6, 43, 19, 2, 44, 20], [6, 43, 15, 2, 44, 16], [4, 101, 81], [1, 80, 50, 4, 81, 51], [4, 50, 22, 4, 51, 23], [3, 36, 12, 8, 37, 13], [2, 116, 92, 2, 117, 93], [6, 58, 36, 2, 59, 37], [4, 46, 20, 6, 47, 21], [7, 42, 14, 4, 43, 15], [4, 133, 107], [8, 59, 37, 1, 60, 38], [8, 44, 20, 4, 45, 21], [12, 33, 11, 4, 34, 12], [3, 145, 115, 1, 146, 116], [4, 64, 40, 5, 65, 41], [11, 36, 16, 5, 37, 17], [11, 36, 12, 5, 37, 13], [5, 109, 87, 1, 110, 88], [5, 65, 41, 5, 66, 42], [5, 54, 24, 7, 55, 25], [11, 36, 12], [5, 122, 98, 1, 123, 99], [7, 73, 45, 3, 74, 46], [15, 43, 19, 2, 44, 20], [3, 45, 15, 13, 46, 16], [1, 135, 107, 5, 136, 108], [10, 74, 46, 1, 75, 47], [1, 50, 22, 15, 51, 23], [2, 42, 14, 17, 43, 15], [5, 150, 120, 1, 151, 121], [9, 69, 43, 4, 70, 44], [17, 50, 22, 1, 51, 23], [2, 42, 14, 19, 43, 15], [3, 141, 113, 4, 142, 114], [3, 70, 44, 11, 71, 45], [17, 47, 21, 4, 48, 22], [9, 39, 13, 16, 40, 14], [3, 135, 107, 5, 136, 108], [3, 67, 41, 13, 68, 42], [15, 54, 24, 5, 55, 25], [15, 43, 15, 10, 44, 16], [4, 144, 116, 4, 145, 117], [17, 68, 42], [17, 50, 22, 6, 51, 23], [19, 46, 16, 6, 47, 17], [2, 139, 111, 7, 140, 112], [17, 74, 46], [7, 54, 24, 16, 55, 25], [34, 37, 13], [4, 151, 121, 5, 152, 122], [4, 75, 47, 14, 76, 48], [11, 54, 24, 14, 55, 25], [16, 45, 15, 14, 46, 16], [6, 147, 117, 4, 148, 118], [6, 73, 45, 14, 74, 46], [11, 54, 24, 16, 55, 25], [30, 46, 16, 2, 47, 17], [8, 132, 106, 4, 133, 107], [8, 75, 47, 13, 76, 48], [7, 54, 24, 22, 55, 25], [22, 45, 15, 13, 46, 16], [10, 142, 114, 2, 143, 115], [19, 74, 46, 4, 75, 47], [28, 50, 22, 6, 51, 23], [33, 46, 16, 4, 47, 17], [8, 152, 122, 4, 153, 123], [22, 73, 45, 3, 74, 46], [8, 53, 23, 26, 54, 24], [12, 45, 15, 28, 46, 16], [3, 147, 117, 10, 148, 118], [3, 73, 45, 23, 74, 46], [4, 54, 24, 31, 55, 25], [11, 45, 15, 31, 46, 16], [7, 146, 116, 7, 147, 117], [21, 73, 45, 7, 74, 46], [1, 53, 23, 37, 54, 24], [19, 45, 15, 26, 46, 16], [5, 145, 115, 10, 146, 116], [19, 75, 47, 10, 76, 48], [15, 54, 24, 25, 55, 25], [23, 45, 15, 25, 46, 16], [13, 145, 115, 3, 146, 116], [2, 74, 46, 29, 75, 47], [42, 54, 24, 1, 55, 25], [23, 45, 15, 28, 46, 16], [17, 145, 115], [10, 74, 46, 23, 75, 47], [10, 54, 24, 35, 55, 25], [19, 45, 15, 35, 46, 16], [17, 145, 115, 1, 146, 116], [14, 74, 46, 21, 75, 47], [29, 54, 24, 19, 55, 25], [11, 45, 15, 46, 46, 16], [13, 145, 115, 6, 146, 116], [14, 74, 46, 23, 75, 47], [44, 54, 24, 7, 55, 25], [59, 46, 16, 1, 47, 17], [12, 151, 121, 7, 152, 122], [12, 75, 47, 26, 76, 48], [39, 54, 24, 14, 55, 25], [22, 45, 15, 41, 46, 16], [6, 151, 121, 14, 152, 122], [6, 75, 47, 34, 76, 48], [46, 54, 24, 10, 55, 25], [2, 45, 15, 64, 46, 16], [17, 152, 122, 4, 153, 123], [29, 74, 46, 14, 75, 47], [49, 54, 24, 10, 55, 25], [24, 45, 15, 46, 46, 16], [4, 152, 122, 18, 153, 123], [13, 74, 46, 32, 75, 47], [48, 54, 24, 14, 55, 25], [42, 45, 15, 32, 46, 16], [20, 147, 117, 4, 148, 118], [40, 75, 47, 7, 76, 48], [43, 54, 24, 22, 55, 25], [10, 45, 15, 67, 46, 16], [19, 148, 118, 6, 149, 119], [18, 75, 47, 31, 76, 48], [34, 54, 24, 34, 55, 25], [20, 45, 15, 61, 46, 16]];\n\n  var qrRSBlock = function (totalCount, dataCount) {\n    var _this = {};\n    _this.totalCount = totalCount;\n    _this.dataCount = dataCount;\n    return _this;\n  };\n\n  var _this = {};\n\n  var getRsBlockTable = function (typeNumber, errorCorrectLevel) {\n    switch (errorCorrectLevel) {\n      case QRErrorCorrectLevel.L:\n        return RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 0];\n\n      case QRErrorCorrectLevel.M:\n        return RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 1];\n\n      case QRErrorCorrectLevel.Q:\n        return RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 2];\n\n      case QRErrorCorrectLevel.H:\n        return RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 3];\n\n      default:\n        return undefined;\n    }\n  };\n\n  _this.getRSBlocks = function (typeNumber, errorCorrectLevel) {\n    var rsBlock = getRsBlockTable(typeNumber, errorCorrectLevel);\n\n    if (typeof rsBlock == 'undefined') {\n      throw new Error('bad rs block @ typeNumber:' + typeNumber + '/errorCorrectLevel:' + errorCorrectLevel);\n    }\n\n    var length = rsBlock.length / 3;\n    var list = new Array();\n\n    for (var i = 0; i < length; i += 1) {\n      var count = rsBlock[i * 3 + 0];\n      var totalCount = rsBlock[i * 3 + 1];\n      var dataCount = rsBlock[i * 3 + 2];\n\n      for (var j = 0; j < count; j += 1) {\n        list.push(qrRSBlock(totalCount, dataCount));\n      }\n    }\n\n    return list;\n  };\n\n  return _this;\n}(); //---------------------------------------------------------------------\n// qrBitBuffer\n//---------------------------------------------------------------------\n\n\nvar qrBitBuffer = function () {\n  var _buffer = new Array();\n\n  var _length = 0;\n  var _this = {};\n\n  _this.getBuffer = function () {\n    return _buffer;\n  };\n\n  _this.getAt = function (index) {\n    var bufIndex = Math.floor(index / 8);\n    return (_buffer[bufIndex] >>> 7 - index % 8 & 1) == 1;\n  };\n\n  _this.put = function (num, length) {\n    for (var i = 0; i < length; i += 1) {\n      _this.putBit((num >>> length - i - 1 & 1) == 1);\n    }\n  };\n\n  _this.getLengthInBits = function () {\n    return _length;\n  };\n\n  _this.putBit = function (bit) {\n    var bufIndex = Math.floor(_length / 8);\n\n    if (_buffer.length <= bufIndex) {\n      _buffer.push(0);\n    }\n\n    if (bit) {\n      _buffer[bufIndex] |= 0x80 >>> _length % 8;\n    }\n\n    _length += 1;\n  };\n\n  return _this;\n}; //---------------------------------------------------------------------\n// qr8BitByte\n//---------------------------------------------------------------------\n\n\nvar qr8BitByte = function (data) {\n  var _mode = QRMode.MODE_8BIT_BYTE;\n  var _data = data;\n  var _parsedData = [];\n  var _this = {}; // Added to support UTF-8 Characters\n\n  for (var i = 0, l = _data.length; i < l; i++) {\n    var byteArray = [];\n\n    var code = _data.charCodeAt(i);\n\n    if (code > 0x10000) {\n      byteArray[0] = 0xF0 | (code & 0x1C0000) >>> 18;\n      byteArray[1] = 0x80 | (code & 0x3F000) >>> 12;\n      byteArray[2] = 0x80 | (code & 0xFC0) >>> 6;\n      byteArray[3] = 0x80 | code & 0x3F;\n    } else if (code > 0x800) {\n      byteArray[0] = 0xE0 | (code & 0xF000) >>> 12;\n      byteArray[1] = 0x80 | (code & 0xFC0) >>> 6;\n      byteArray[2] = 0x80 | code & 0x3F;\n    } else if (code > 0x80) {\n      byteArray[0] = 0xC0 | (code & 0x7C0) >>> 6;\n      byteArray[1] = 0x80 | code & 0x3F;\n    } else {\n      byteArray[0] = code;\n    } // Fix Unicode corruption bug\n\n\n    _parsedData.push(byteArray);\n  }\n\n  _parsedData = Array.prototype.concat.apply([], _parsedData);\n\n  if (_parsedData.length != _data.length) {\n    _parsedData.unshift(191);\n\n    _parsedData.unshift(187);\n\n    _parsedData.unshift(239);\n  }\n\n  var _bytes = _parsedData;\n\n  _this.getMode = function () {\n    return _mode;\n  };\n\n  _this.getLength = function (buffer) {\n    return _bytes.length;\n  };\n\n  _this.write = function (buffer) {\n    for (var i = 0; i < _bytes.length; i += 1) {\n      buffer.put(_bytes[i], 8);\n    }\n  };\n\n  return _this;\n}; //=====================================================================\n// GIF Support etc.\n//\n//---------------------------------------------------------------------\n// byteArrayOutputStream\n//---------------------------------------------------------------------\n\n\nvar byteArrayOutputStream = function () {\n  var _bytes = new Array();\n\n  var _this = {};\n\n  _this.writeByte = function (b) {\n    _bytes.push(b & 0xff);\n  };\n\n  _this.writeShort = function (i) {\n    _this.writeByte(i);\n\n    _this.writeByte(i >>> 8);\n  };\n\n  _this.writeBytes = function (b, off, len) {\n    off = off || 0;\n    len = len || b.length;\n\n    for (var i = 0; i < len; i += 1) {\n      _this.writeByte(b[i + off]);\n    }\n  };\n\n  _this.writeString = function (s) {\n    for (var i = 0; i < s.length; i += 1) {\n      _this.writeByte(s.charCodeAt(i));\n    }\n  };\n\n  _this.toByteArray = function () {\n    return _bytes;\n  };\n\n  _this.toString = function () {\n    var s = '';\n    s += '[';\n\n    for (var i = 0; i < _bytes.length; i += 1) {\n      if (i > 0) {\n        s += ',';\n      }\n\n      s += _bytes[i];\n    }\n\n    s += ']';\n    return s;\n  };\n\n  return _this;\n}; //---------------------------------------------------------------------\n// base64EncodeOutputStream\n//---------------------------------------------------------------------\n\n\nvar base64EncodeOutputStream = function () {\n  var _buffer = 0;\n  var _buflen = 0;\n  var _length = 0;\n  var _base64 = '';\n  var _this = {};\n\n  var writeEncoded = function (b) {\n    _base64 += String.fromCharCode(encode(b & 0x3f));\n  };\n\n  var encode = function (n) {\n    if (n < 0) {// error.\n    } else if (n < 26) {\n      return 0x41 + n;\n    } else if (n < 52) {\n      return 0x61 + (n - 26);\n    } else if (n < 62) {\n      return 0x30 + (n - 52);\n    } else if (n == 62) {\n      return 0x2b;\n    } else if (n == 63) {\n      return 0x2f;\n    }\n\n    throw new Error('n:' + n);\n  };\n\n  _this.writeByte = function (n) {\n    _buffer = _buffer << 8 | n & 0xff;\n    _buflen += 8;\n    _length += 1;\n\n    while (_buflen >= 6) {\n      writeEncoded(_buffer >>> _buflen - 6);\n      _buflen -= 6;\n    }\n  };\n\n  _this.flush = function () {\n    if (_buflen > 0) {\n      writeEncoded(_buffer << 6 - _buflen);\n      _buffer = 0;\n      _buflen = 0;\n    }\n\n    if (_length % 3 != 0) {\n      // padding\n      var padlen = 3 - _length % 3;\n\n      for (var i = 0; i < padlen; i += 1) {\n        _base64 += '=';\n      }\n    }\n  };\n\n  _this.toString = function () {\n    return _base64;\n  };\n\n  return _this;\n}; //---------------------------------------------------------------------\n// base64DecodeInputStream\n//---------------------------------------------------------------------\n\n\nvar base64DecodeInputStream = function (str) {\n  var _str = str;\n  var _pos = 0;\n  var _buffer = 0;\n  var _buflen = 0;\n  var _this = {};\n\n  _this.read = function () {\n    while (_buflen < 8) {\n      if (_pos >= _str.length) {\n        if (_buflen == 0) {\n          return -1;\n        }\n\n        throw new Error('unexpected end of file./' + _buflen);\n      }\n\n      var c = _str.charAt(_pos);\n\n      _pos += 1;\n\n      if (c == '=') {\n        _buflen = 0;\n        return -1;\n      } else if (c.match(/^\\s$/)) {\n        // ignore if whitespace.\n        continue;\n      }\n\n      _buffer = _buffer << 6 | decode(c.charCodeAt(0));\n      _buflen += 6;\n    }\n\n    var n = _buffer >>> _buflen - 8 & 0xff;\n    _buflen -= 8;\n    return n;\n  };\n\n  var decode = function (c) {\n    if (0x41 <= c && c <= 0x5a) {\n      return c - 0x41;\n    } else if (0x61 <= c && c <= 0x7a) {\n      return c - 0x61 + 26;\n    } else if (0x30 <= c && c <= 0x39) {\n      return c - 0x30 + 52;\n    } else if (c == 0x2b) {\n      return 62;\n    } else if (c == 0x2f) {\n      return 63;\n    } else {\n      throw new Error('c:' + c);\n    }\n  };\n\n  return _this;\n}; //---------------------------------------------------------------------\n// gifImage (B/W)\n//---------------------------------------------------------------------\n\n\nvar gifImage = function (width, height) {\n  var _width = width;\n  var _height = height;\n\n  var _data = new Array(width * height);\n\n  var _this = {};\n\n  _this.setPixel = function (x, y, pixel) {\n    _data[y * _width + x] = pixel;\n  };\n\n  _this.write = function (out) {\n    //---------------------------------\n    // GIF Signature\n    out.writeString('GIF87a'); //---------------------------------\n    // Screen Descriptor\n\n    out.writeShort(_width);\n    out.writeShort(_height);\n    out.writeByte(0x80); // 2bit\n\n    out.writeByte(0);\n    out.writeByte(0); //---------------------------------\n    // Global Color Map\n    // black\n\n    out.writeByte(0x00);\n    out.writeByte(0x00);\n    out.writeByte(0x00); // white\n\n    out.writeByte(0xff);\n    out.writeByte(0xff);\n    out.writeByte(0xff); //---------------------------------\n    // Image Descriptor\n\n    out.writeString(',');\n    out.writeShort(0);\n    out.writeShort(0);\n    out.writeShort(_width);\n    out.writeShort(_height);\n    out.writeByte(0); //---------------------------------\n    // Local Color Map\n    //---------------------------------\n    // Raster Data\n\n    var lzwMinCodeSize = 2;\n    var raster = getLZWRaster(lzwMinCodeSize);\n    out.writeByte(lzwMinCodeSize);\n    var offset = 0;\n\n    while (raster.length - offset > 255) {\n      out.writeByte(255);\n      out.writeBytes(raster, offset, 255);\n      offset += 255;\n    }\n\n    out.writeByte(raster.length - offset);\n    out.writeBytes(raster, offset, raster.length - offset);\n    out.writeByte(0x00); //---------------------------------\n    // GIF Terminator\n\n    out.writeString(';');\n  };\n\n  var bitOutputStream = function (out) {\n    var _out = out;\n    var _bitLength = 0;\n    var _bitBuffer = 0;\n    var _this = {};\n\n    _this.write = function (data, length) {\n      if (data >>> length != 0) {\n        throw new Error('length over');\n      }\n\n      while (_bitLength + length >= 8) {\n        _out.writeByte(0xff & (data << _bitLength | _bitBuffer));\n\n        length -= 8 - _bitLength;\n        data >>>= 8 - _bitLength;\n        _bitBuffer = 0;\n        _bitLength = 0;\n      }\n\n      _bitBuffer = data << _bitLength | _bitBuffer;\n      _bitLength = _bitLength + length;\n    };\n\n    _this.flush = function () {\n      if (_bitLength > 0) {\n        _out.writeByte(_bitBuffer);\n      }\n    };\n\n    return _this;\n  };\n\n  var getLZWRaster = function (lzwMinCodeSize) {\n    var clearCode = 1 << lzwMinCodeSize;\n    var endCode = (1 << lzwMinCodeSize) + 1;\n    var bitLength = lzwMinCodeSize + 1; // Setup LZWTable\n\n    var table = lzwTable();\n\n    for (var i = 0; i < clearCode; i += 1) {\n      table.add(String.fromCharCode(i));\n    }\n\n    table.add(String.fromCharCode(clearCode));\n    table.add(String.fromCharCode(endCode));\n    var byteOut = byteArrayOutputStream();\n    var bitOut = bitOutputStream(byteOut); // clear code\n\n    bitOut.write(clearCode, bitLength);\n    var dataIndex = 0;\n    var s = String.fromCharCode(_data[dataIndex]);\n    dataIndex += 1;\n\n    while (dataIndex < _data.length) {\n      var c = String.fromCharCode(_data[dataIndex]);\n      dataIndex += 1;\n\n      if (table.contains(s + c)) {\n        s = s + c;\n      } else {\n        bitOut.write(table.indexOf(s), bitLength);\n\n        if (table.size() < 0xfff) {\n          if (table.size() == 1 << bitLength) {\n            bitLength += 1;\n          }\n\n          table.add(s + c);\n        }\n\n        s = c;\n      }\n    }\n\n    bitOut.write(table.indexOf(s), bitLength); // end code\n\n    bitOut.write(endCode, bitLength);\n    bitOut.flush();\n    return byteOut.toByteArray();\n  };\n\n  var lzwTable = function () {\n    var _map = {};\n    var _size = 0;\n    var _this = {};\n\n    _this.add = function (key) {\n      if (_this.contains(key)) {\n        throw new Error('dup key:' + key);\n      }\n\n      _map[key] = _size;\n      _size += 1;\n    };\n\n    _this.size = function () {\n      return _size;\n    };\n\n    _this.indexOf = function (key) {\n      return _map[key];\n    };\n\n    _this.contains = function (key) {\n      return typeof _map[key] != 'undefined';\n    };\n\n    return _this;\n  };\n\n  return _this;\n};\n\nvar createImgTag = function (width, height, getPixel, alt) {\n  var gif = gifImage(width, height);\n\n  for (var y = 0; y < height; y += 1) {\n    for (var x = 0; x < width; x += 1) {\n      gif.setPixel(x, y, getPixel(x, y));\n    }\n  }\n\n  var b = byteArrayOutputStream();\n  gif.write(b);\n  var base64 = base64EncodeOutputStream();\n  var bytes = b.toByteArray();\n\n  for (var i = 0; i < bytes.length; i += 1) {\n    base64.writeByte(bytes[i]);\n  }\n\n  base64.flush();\n  var img = '';\n  img += 'data:image/gif;base64,';\n  img += base64;\n  return img;\n}; //---------------------------------------------------------------------\n// returns qrcode function.\n\n\nvar drawImg = function (text, options) {\n  options = options || {};\n  var typeNumber = options.typeNumber || 4;\n  var errorCorrectLevel = options.errorCorrectLevel || 'M';\n  var size = options.size || 500;\n  var qr;\n\n  try {\n    qr = qrcode(typeNumber, errorCorrectLevel || 'M');\n    qr.addData(text);\n    qr.make();\n  } catch (e) {\n    if (typeNumber >= 40) {\n      throw new Error('Text too long to encode');\n    } else {\n      return drawImg(text, {\n        size: size,\n        errorCorrectLevel: errorCorrectLevel,\n        typeNumber: typeNumber + 1\n      });\n    }\n  } // calc cellsize and margin\n\n\n  var cellsize = parseInt(size / qr.getModuleCount());\n  var margin = parseInt((size - qr.getModuleCount() * cellsize) / 2);\n  return qr.createImgTag(cellsize, margin, size);\n};\n\nmodule.exports = {\n  drawImg: drawImg\n};","map":{"version":3,"sources":["/Users/zuhriddinkamilzanov/Desktop/tMed-mobile/node_modules/qrcode-base64/index.js"],"names":["qrcode","typeNumber","errorCorrectLevel","PAD0","PAD1","_typeNumber","_errorCorrectLevel","QRErrorCorrectLevel","_modules","_moduleCount","_dataCache","_dataList","Array","_this","makeImpl","test","maskPattern","moduleCount","modules","row","col","setupPositionProbePattern","setupPositionAdjustPattern","setupTimingPattern","setupTypeInfo","setupTypeNumber","createData","mapData","r","c","getBestMaskPattern","minLostPoint","pattern","i","lostPoint","QRUtil","getLostPoint","pos","getPatternPosition","length","j","bits","getBCHTypeNumber","mod","Math","floor","data","getBCHTypeInfo","inc","bitIndex","byteIndex","maskFunc","getMaskFunction","dark","mask","createBytes","buffer","rsBlocks","offset","maxDcCount","maxEcCount","dcdata","ecdata","dcCount","dataCount","ecCount","totalCount","max","getBuffer","rsPoly","getErrorCorrectPolynomial","rawPoly","qrPolynomial","getLength","modPoly","modIndex","getAt","totalCodeCount","index","dataList","QRRSBlock","getRSBlocks","qrBitBuffer","put","getMode","getLengthInBits","write","totalDataCount","Error","putBit","addData","newData","qr8BitByte","push","isDark","getModuleCount","make","createTableTag","cellSize","margin","qrHtml","createImgTag","size","min","x","y","stringToBytes","s","bytes","charCodeAt","createStringToBytes","unicodeData","numChars","unicodeMap","bin","base64DecodeInputStream","read","b","count","b0","b1","b2","b3","k","String","fromCharCode","v","unknownChar","charAt","QRMode","MODE_NUMBER","MODE_ALPHA_NUM","MODE_8BIT_BYTE","MODE_KANJI","L","M","Q","H","QRMaskPattern","PATTERN000","PATTERN001","PATTERN010","PATTERN011","PATTERN100","PATTERN101","PATTERN110","PATTERN111","PATTERN_POSITION_TABLE","G15","G18","G15_MASK","getBCHDigit","digit","d","errorCorrectLength","a","multiply","QRMath","gexp","mode","type","sameCount","darkCount","ratio","abs","EXP_TABLE","LOG_TABLE","glog","n","num","shift","_num","e","RS_BLOCK_TABLE","qrRSBlock","getRsBlockTable","undefined","rsBlock","list","_buffer","_length","bufIndex","bit","_mode","_data","_parsedData","l","byteArray","code","prototype","concat","apply","unshift","_bytes","byteArrayOutputStream","writeByte","writeShort","writeBytes","off","len","writeString","toByteArray","toString","base64EncodeOutputStream","_buflen","_base64","writeEncoded","encode","flush","padlen","str","_str","_pos","match","decode","gifImage","width","height","_width","_height","setPixel","pixel","out","lzwMinCodeSize","raster","getLZWRaster","bitOutputStream","_out","_bitLength","_bitBuffer","clearCode","endCode","bitLength","table","lzwTable","add","byteOut","bitOut","dataIndex","contains","indexOf","_map","_size","key","getPixel","alt","gif","base64","img","drawImg","text","options","qr","cellsize","parseInt","module","exports"],"mappings":"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","sourcesContent":["//---------------------------------------------------------------------\n//\n// QR Code Generator for JavaScript\n//\n// Copyright (c) 2009 Kazuhiko Arase\n//\n// URL: http://www.d-project.com/\n//\n// Licensed under the MIT license:\n//\thttp://www.opensource.org/licenses/mit-license.php\n//\n// The word 'QR Code' is registered trademark of\n// DENSO WAVE INCORPORATED\n//\thttp://www.denso-wave.com/qrcode/faqpatent-e.html\n//\n//---------------------------------------------------------------------\n\n//---------------微信小程序基于base64生成二维码插件修改-------------------\n/*\n * @Modified: Pudon\n * @demoURL: https://github.com/Pudon/weapp-qrcode\n * @Date: 2018-09-11 14:00:05 \n * @Last Modified by: Pudon\n * @Last Modified time: 2018-09-12 16:33:19\n */\n//---------------------------------------------------------------------\n\n/**\n * qrcode\n * @param typeNumber 1 to 40\n * @param errorCorrectLevel 'L','M','Q','H'\n */\nvar qrcode = function(typeNumber, errorCorrectLevel) {\n\n    var PAD0 = 0xEC;\n    var PAD1 = 0x11;\n\n    var _typeNumber = typeNumber;\n    var _errorCorrectLevel = QRErrorCorrectLevel[errorCorrectLevel];\n    var _modules = null;\n    var _moduleCount = 0;\n    var _dataCache = null;\n    var _dataList = new Array();\n\n    var _this = {};\n\n    var makeImpl = function(test, maskPattern) {\n\n\t_moduleCount = _typeNumber * 4 + 17;\n\t_modules = function(moduleCount) {\n\t    var modules = new Array(moduleCount);\n\t    for (var row = 0; row < moduleCount; row += 1) {\n\t\tmodules[row] = new Array(moduleCount);\n\t\tfor (var col = 0; col < moduleCount; col += 1) {\n\t\t    modules[row][col] = null;\n\t\t}\n\t    }\n\t    return modules;\n\t}(_moduleCount);\n\n\tsetupPositionProbePattern(0, 0);\n\tsetupPositionProbePattern(_moduleCount - 7, 0);\n\tsetupPositionProbePattern(0, _moduleCount - 7);\n\tsetupPositionAdjustPattern();\n\tsetupTimingPattern();\n\tsetupTypeInfo(test, maskPattern);\n\n\tif (_typeNumber >= 7) {\n\t    setupTypeNumber(test);\n\t}\n\n\tif (_dataCache == null) {\n\t    _dataCache = createData(_typeNumber, _errorCorrectLevel, _dataList);\n\t}\n\n\tmapData(_dataCache, maskPattern);\n    };\n\n    var setupPositionProbePattern = function(row, col) {\n\n\tfor (var r = -1; r <= 7; r += 1) {\n\n\t    if (row + r <= -1 || _moduleCount <= row + r) continue;\n\n\t    for (var c = -1; c <= 7; c += 1) {\n\n\t\tif (col + c <= -1 || _moduleCount <= col + c) continue;\n\n\t\tif ( (0 <= r && r <= 6 && (c == 0 || c == 6) )\n\t\t     || (0 <= c && c <= 6 && (r == 0 || r == 6) )\n\t\t     || (2 <= r && r <= 4 && 2 <= c && c <= 4) ) {\n\t\t    _modules[row + r][col + c] = true;\n\t\t} else {\n\t\t    _modules[row + r][col + c] = false;\n\t\t}\n\t    }\n\t}\n    };\n\n    var getBestMaskPattern = function() {\n\n\tvar minLostPoint = 0;\n\tvar pattern = 0;\n\n\tfor (var i = 0; i < 8; i += 1) {\n\n\t    makeImpl(true, i);\n\n\t    var lostPoint = QRUtil.getLostPoint(_this);\n\n\t    if (i == 0 || minLostPoint > lostPoint) {\n\t\tminLostPoint = lostPoint;\n\t\tpattern = i;\n\t    }\n\t}\n\n\treturn pattern;\n    };\n\n    var setupTimingPattern = function() {\n\n\tfor (var r = 8; r < _moduleCount - 8; r += 1) {\n\t    if (_modules[r][6] != null) {\n\t\tcontinue;\n\t    }\n\t    _modules[r][6] = (r % 2 == 0);\n\t}\n\n\tfor (var c = 8; c < _moduleCount - 8; c += 1) {\n\t    if (_modules[6][c] != null) {\n\t\tcontinue;\n\t    }\n\t    _modules[6][c] = (c % 2 == 0);\n\t}\n    };\n\n    var setupPositionAdjustPattern = function() {\n\n\tvar pos = QRUtil.getPatternPosition(_typeNumber);\n\n\tfor (var i = 0; i < pos.length; i += 1) {\n\n\t    for (var j = 0; j < pos.length; j += 1) {\n\n\t\tvar row = pos[i];\n\t\tvar col = pos[j];\n\n\t\tif (_modules[row][col] != null) {\n\t\t    continue;\n\t\t}\n\n\t\tfor (var r = -2; r <= 2; r += 1) {\n\n\t\t    for (var c = -2; c <= 2; c += 1) {\n\n\t\t\tif (r == -2 || r == 2 || c == -2 || c == 2\n\t\t\t    || (r == 0 && c == 0) ) {\n\t\t\t    _modules[row + r][col + c] = true;\n\t\t\t} else {\n\t\t\t    _modules[row + r][col + c] = false;\n\t\t\t}\n\t\t    }\n\t\t}\n\t    }\n\t}\n    };\n\n    var setupTypeNumber = function(test) {\n\n\tvar bits = QRUtil.getBCHTypeNumber(_typeNumber);\n\n\tfor (var i = 0; i < 18; i += 1) {\n\t    var mod = (!test && ( (bits >> i) & 1) == 1);\n\t    _modules[Math.floor(i / 3)][i % 3 + _moduleCount - 8 - 3] = mod;\n\t}\n\n\tfor (var i = 0; i < 18; i += 1) {\n\t    var mod = (!test && ( (bits >> i) & 1) == 1);\n\t    _modules[i % 3 + _moduleCount - 8 - 3][Math.floor(i / 3)] = mod;\n\t}\n    };\n\n    var setupTypeInfo = function(test, maskPattern) {\n\n\tvar data = (_errorCorrectLevel << 3) | maskPattern;\n\tvar bits = QRUtil.getBCHTypeInfo(data);\n\n\t// vertical\n\tfor (var i = 0; i < 15; i += 1) {\n\n\t    var mod = (!test && ( (bits >> i) & 1) == 1);\n\n\t    if (i < 6) {\n\t\t_modules[i][8] = mod;\n\t    } else if (i < 8) {\n\t\t_modules[i + 1][8] = mod;\n\t    } else {\n\t\t_modules[_moduleCount - 15 + i][8] = mod;\n\t    }\n\t}\n\n\t// horizontal\n\tfor (var i = 0; i < 15; i += 1) {\n\n\t    var mod = (!test && ( (bits >> i) & 1) == 1);\n\n\t    if (i < 8) {\n\t\t_modules[8][_moduleCount - i - 1] = mod;\n\t    } else if (i < 9) {\n\t\t_modules[8][15 - i - 1 + 1] = mod;\n\t    } else {\n\t\t_modules[8][15 - i - 1] = mod;\n\t    }\n\t}\n\n\t// fixed module\n\t_modules[_moduleCount - 8][8] = (!test);\n    };\n\n    var mapData = function(data, maskPattern) {\n\n\tvar inc = -1;\n\tvar row = _moduleCount - 1;\n\tvar bitIndex = 7;\n\tvar byteIndex = 0;\n\tvar maskFunc = QRUtil.getMaskFunction(maskPattern);\n\n\tfor (var col = _moduleCount - 1; col > 0; col -= 2) {\n\n\t    if (col == 6) col -= 1;\n\n\t    while (true) {\n\n\t\tfor (var c = 0; c < 2; c += 1) {\n\n\t\t    if (_modules[row][col - c] == null) {\n\n\t\t\tvar dark = false;\n\n\t\t\tif (byteIndex < data.length) {\n\t\t\t    dark = ( ( (data[byteIndex] >>> bitIndex) & 1) == 1);\n\t\t\t}\n\n\t\t\tvar mask = maskFunc(row, col - c);\n\n\t\t\tif (mask) {\n\t\t\t    dark = !dark;\n\t\t\t}\n\n\t\t\t_modules[row][col - c] = dark;\n\t\t\tbitIndex -= 1;\n\n\t\t\tif (bitIndex == -1) {\n\t\t\t    byteIndex += 1;\n\t\t\t    bitIndex = 7;\n\t\t\t}\n\t\t    }\n\t\t}\n\n\t\trow += inc;\n\n\t\tif (row < 0 || _moduleCount <= row) {\n\t\t    row -= inc;\n\t\t    inc = -inc;\n\t\t    break;\n\t\t}\n\t    }\n\t}\n    };\n\n    var createBytes = function(buffer, rsBlocks) {\n\n\tvar offset = 0;\n\n\tvar maxDcCount = 0;\n\tvar maxEcCount = 0;\n\n\tvar dcdata = new Array(rsBlocks.length);\n\tvar ecdata = new Array(rsBlocks.length);\n\n\tfor (var r = 0; r < rsBlocks.length; r += 1) {\n\n\t    var dcCount = rsBlocks[r].dataCount;\n\t    var ecCount = rsBlocks[r].totalCount - dcCount;\n\n\t    maxDcCount = Math.max(maxDcCount, dcCount);\n\t    maxEcCount = Math.max(maxEcCount, ecCount);\n\n\t    dcdata[r] = new Array(dcCount);\n\n\t    for (var i = 0; i < dcdata[r].length; i += 1) {\n\t\tdcdata[r][i] = 0xff & buffer.getBuffer()[i + offset];\n\t    }\n\t    offset += dcCount;\n\n\t    var rsPoly = QRUtil.getErrorCorrectPolynomial(ecCount);\n\t    var rawPoly = qrPolynomial(dcdata[r], rsPoly.getLength() - 1);\n\n\t    var modPoly = rawPoly.mod(rsPoly);\n\t    ecdata[r] = new Array(rsPoly.getLength() - 1);\n\t    for (var i = 0; i < ecdata[r].length; i += 1) {\n\t\tvar modIndex = i + modPoly.getLength() - ecdata[r].length;\n\t\tecdata[r][i] = (modIndex >= 0)? modPoly.getAt(modIndex) : 0;\n\t    }\n\t}\n\n\tvar totalCodeCount = 0;\n\tfor (var i = 0; i < rsBlocks.length; i += 1) {\n\t    totalCodeCount += rsBlocks[i].totalCount;\n\t}\n\n\tvar data = new Array(totalCodeCount);\n\tvar index = 0;\n\n\tfor (var i = 0; i < maxDcCount; i += 1) {\n\t    for (var r = 0; r < rsBlocks.length; r += 1) {\n\t\tif (i < dcdata[r].length) {\n\t\t    data[index] = dcdata[r][i];\n\t\t    index += 1;\n\t\t}\n\t    }\n\t}\n\n\tfor (var i = 0; i < maxEcCount; i += 1) {\n\t    for (var r = 0; r < rsBlocks.length; r += 1) {\n\t\tif (i < ecdata[r].length) {\n\t\t    data[index] = ecdata[r][i];\n\t\t    index += 1;\n\t\t}\n\t    }\n\t}\n\n\treturn data;\n    };\n\n    var createData = function(typeNumber, errorCorrectLevel, dataList) {\n\n\tvar rsBlocks = QRRSBlock.getRSBlocks(typeNumber, errorCorrectLevel);\n\n\tvar buffer = qrBitBuffer();\n\n\tfor (var i = 0; i < dataList.length; i += 1) {\n\t    var data = dataList[i];\n\t    buffer.put(data.getMode(), 4);\n\t    buffer.put(data.getLength(), QRUtil.getLengthInBits(data.getMode(), typeNumber) );\n\t    data.write(buffer);\n\t}\n\n\t// calc num max data.\n\tvar totalDataCount = 0;\n\tfor (var i = 0; i < rsBlocks.length; i += 1) {\n\t    totalDataCount += rsBlocks[i].dataCount;\n\t}\n\n\tif (buffer.getLengthInBits() > totalDataCount * 8) {\n\t    throw new Error('code length overflow. ('\n\t\t\t    + buffer.getLengthInBits()\n\t\t\t    + '>'\n\t\t\t    + totalDataCount * 8\n\t\t\t    + ')');\n\t}\n\n\t// end code\n\tif (buffer.getLengthInBits() + 4 <= totalDataCount * 8) {\n\t    buffer.put(0, 4);\n\t}\n\n\t// padding\n\twhile (buffer.getLengthInBits() % 8 != 0) {\n\t    buffer.putBit(false);\n\t}\n\n\t// padding\n\twhile (true) {\n\n\t    if (buffer.getLengthInBits() >= totalDataCount * 8) {\n\t\tbreak;\n\t    }\n\t    buffer.put(PAD0, 8);\n\n\t    if (buffer.getLengthInBits() >= totalDataCount * 8) {\n\t\tbreak;\n\t    }\n\t    buffer.put(PAD1, 8);\n\t}\n\n\treturn createBytes(buffer, rsBlocks);\n    };\n\n    _this.addData = function(data) {\n\tvar newData = qr8BitByte(data);\n\t_dataList.push(newData);\n\t_dataCache = null;\n    };\n\n    _this.isDark = function(row, col) {\n\tif (row < 0 || _moduleCount <= row || col < 0 || _moduleCount <= col) {\n\t    throw new Error(row + ',' + col);\n\t}\n\treturn _modules[row][col];\n    };\n\n    _this.getModuleCount = function() {\n\treturn _moduleCount;\n    };\n\n    _this.make = function() {\n\tmakeImpl(false, getBestMaskPattern() );\n    };\n\n    _this.createTableTag = function(cellSize, margin) {\n\n\tcellSize = cellSize || 2;\n\tmargin = (typeof margin == 'undefined')? cellSize * 4 : margin;\n\n\tvar qrHtml = '';\n\n\tqrHtml += '<table style=\"';\n\tqrHtml += ' border-width: 0px; border-style: none;';\n\tqrHtml += ' border-collapse: collapse;';\n\tqrHtml += ' padding: 0px; margin: ' + margin + 'px;';\n\tqrHtml += '\">';\n\tqrHtml += '<tbody>';\n\n\tfor (var r = 0; r < _this.getModuleCount(); r += 1) {\n\n\t    qrHtml += '<tr>';\n\n\t    for (var c = 0; c < _this.getModuleCount(); c += 1) {\n\t\tqrHtml += '<td style=\"';\n\t\tqrHtml += ' border-width: 0px; border-style: none;';\n\t\tqrHtml += ' border-collapse: collapse;';\n\t\tqrHtml += ' padding: 0px; margin: 0px;';\n\t\tqrHtml += ' width: ' + cellSize + 'px;';\n\t\tqrHtml += ' height: ' + cellSize + 'px;';\n\t\tqrHtml += ' background-color: ';\n\t\tqrHtml += _this.isDark(r, c)? '#000000' : '#ffffff';\n\t\tqrHtml += ';';\n\t\tqrHtml += '\"/>';\n\t    }\n\n\t    qrHtml += '</tr>';\n\t}\n\n\tqrHtml += '</tbody>';\n\tqrHtml += '</table>';\n\n\treturn qrHtml;\n    };\n\n    _this.createImgTag = function(cellSize, margin, size) {\n\n\tcellSize = cellSize || 2;\n\tmargin = (typeof margin == 'undefined')? cellSize * 4 : margin;\n\n\tvar min = margin;\n\tvar max = _this.getModuleCount() * cellSize + margin;\n\n\treturn createImgTag(size, size, function(x, y) {\n\t    if (min <= x && x < max && min <= y && y < max) {\n\t\tvar c = Math.floor( (x - min) / cellSize);\n\t\tvar r = Math.floor( (y - min) / cellSize);\n\t\treturn _this.isDark(r, c)? 0 : 1;\n\t    } else {\n\t\treturn 1;\n\t    }\n\t} );\n    };\n\n    return _this;\n};\n\n//---------------------------------------------------------------------\n// qrcode.stringToBytes\n//---------------------------------------------------------------------\n\nqrcode.stringToBytes = function(s) {\n    var bytes = new Array();\n    for (var i = 0; i < s.length; i += 1) {\n\tvar c = s.charCodeAt(i);\n\tbytes.push(c & 0xff);\n    }\n    return bytes;\n};\n\n//---------------------------------------------------------------------\n// qrcode.createStringToBytes\n//---------------------------------------------------------------------\n\n/**\n * @param unicodeData base64 string of byte array.\n * [16bit Unicode],[16bit Bytes], ...\n * @param numChars\n */\nqrcode.createStringToBytes = function(unicodeData, numChars) {\n\n    // create conversion map.\n\n    var unicodeMap = function() {\n\n\tvar bin = base64DecodeInputStream(unicodeData);\n\tvar read = function() {\n\t    var b = bin.read();\n\t    if (b == -1) throw new Error();\n\t    return b;\n\t};\n\n\tvar count = 0;\n\tvar unicodeMap = {};\n\twhile (true) {\n\t    var b0 = bin.read();\n\t    if (b0 == -1) break;\n\t    var b1 = read();\n\t    var b2 = read();\n\t    var b3 = read();\n\t    var k = String.fromCharCode( (b0 << 8) | b1);\n\t    var v = (b2 << 8) | b3;\n\t    unicodeMap[k] = v;\n\t    count += 1;\n\t}\n\tif (count != numChars) {\n\t    throw new Error(count + ' != ' + numChars);\n\t}\n\n\treturn unicodeMap;\n    }();\n\n    var unknownChar = '?'.charCodeAt(0);\n\n    return function(s) {\n\tvar bytes = new Array();\n\tfor (var i = 0; i < s.length; i += 1) {\n\t    var c = s.charCodeAt(i);\n\t    if (c < 128) {\n\t\tbytes.push(c);\n\t    } else {\n\t\tvar b = unicodeMap[s.charAt(i)];\n\t\tif (typeof b == 'number') {\n\t\t    if ( (b & 0xff) == b) {\n\t\t\t// 1byte\n\t\t\tbytes.push(b);\n\t\t    } else {\n\t\t\t// 2bytes\n\t\t\tbytes.push(b >>> 8);\n\t\t\tbytes.push(b & 0xff);\n\t\t    }\n\t\t} else {\n\t\t    bytes.push(unknownChar);\n\t\t}\n\t    }\n\t}\n\treturn bytes;\n    };\n};\n\n//---------------------------------------------------------------------\n// QRMode\n//---------------------------------------------------------------------\n\nvar QRMode = {\n    MODE_NUMBER :\t\t1 << 0,\n    MODE_ALPHA_NUM : \t1 << 1,\n    MODE_8BIT_BYTE : \t1 << 2,\n    MODE_KANJI :\t\t1 << 3\n};\n\n//---------------------------------------------------------------------\n// QRErrorCorrectLevel\n//---------------------------------------------------------------------\n\nvar QRErrorCorrectLevel = {\n    L : 1,\n    M : 0,\n    Q : 3,\n    H : 2\n};\n\n//---------------------------------------------------------------------\n// QRMaskPattern\n//---------------------------------------------------------------------\n\nvar QRMaskPattern = {\n    PATTERN000 : 0,\n    PATTERN001 : 1,\n    PATTERN010 : 2,\n    PATTERN011 : 3,\n    PATTERN100 : 4,\n    PATTERN101 : 5,\n    PATTERN110 : 6,\n    PATTERN111 : 7\n};\n\n//---------------------------------------------------------------------\n// QRUtil\n//---------------------------------------------------------------------\n\nvar QRUtil = function() {\n\n    var PATTERN_POSITION_TABLE = [\n\t[],\n\t[6, 18],\n\t[6, 22],\n\t[6, 26],\n\t[6, 30],\n\t[6, 34],\n\t[6, 22, 38],\n\t[6, 24, 42],\n\t[6, 26, 46],\n\t[6, 28, 50],\n\t[6, 30, 54],\n\t[6, 32, 58],\n\t[6, 34, 62],\n\t[6, 26, 46, 66],\n\t[6, 26, 48, 70],\n\t[6, 26, 50, 74],\n\t[6, 30, 54, 78],\n\t[6, 30, 56, 82],\n\t[6, 30, 58, 86],\n\t[6, 34, 62, 90],\n\t[6, 28, 50, 72, 94],\n\t[6, 26, 50, 74, 98],\n\t[6, 30, 54, 78, 102],\n\t[6, 28, 54, 80, 106],\n\t[6, 32, 58, 84, 110],\n\t[6, 30, 58, 86, 114],\n\t[6, 34, 62, 90, 118],\n\t[6, 26, 50, 74, 98, 122],\n\t[6, 30, 54, 78, 102, 126],\n\t[6, 26, 52, 78, 104, 130],\n\t[6, 30, 56, 82, 108, 134],\n\t[6, 34, 60, 86, 112, 138],\n\t[6, 30, 58, 86, 114, 142],\n\t[6, 34, 62, 90, 118, 146],\n\t[6, 30, 54, 78, 102, 126, 150],\n\t[6, 24, 50, 76, 102, 128, 154],\n\t[6, 28, 54, 80, 106, 132, 158],\n\t[6, 32, 58, 84, 110, 136, 162],\n\t[6, 26, 54, 82, 110, 138, 166],\n\t[6, 30, 58, 86, 114, 142, 170]\n    ];\n    var G15 = (1 << 10) | (1 << 8) | (1 << 5) | (1 << 4) | (1 << 2) | (1 << 1) | (1 << 0);\n    var G18 = (1 << 12) | (1 << 11) | (1 << 10) | (1 << 9) | (1 << 8) | (1 << 5) | (1 << 2) | (1 << 0);\n    var G15_MASK = (1 << 14) | (1 << 12) | (1 << 10) | (1 << 4) | (1 << 1);\n\n    var _this = {};\n\n    var getBCHDigit = function(data) {\n\tvar digit = 0;\n\twhile (data != 0) {\n\t    digit += 1;\n\t    data >>>= 1;\n\t}\n\treturn digit;\n    };\n\n    _this.getBCHTypeInfo = function(data) {\n\tvar d = data << 10;\n\twhile (getBCHDigit(d) - getBCHDigit(G15) >= 0) {\n\t    d ^= (G15 << (getBCHDigit(d) - getBCHDigit(G15) ) );\n\t}\n\treturn ( (data << 10) | d) ^ G15_MASK;\n    };\n\n    _this.getBCHTypeNumber = function(data) {\n\tvar d = data << 12;\n\twhile (getBCHDigit(d) - getBCHDigit(G18) >= 0) {\n\t    d ^= (G18 << (getBCHDigit(d) - getBCHDigit(G18) ) );\n\t}\n\treturn (data << 12) | d;\n    };\n\n    _this.getPatternPosition = function(typeNumber) {\n\treturn PATTERN_POSITION_TABLE[typeNumber - 1];\n    };\n\n    _this.getMaskFunction = function(maskPattern) {\n\n\tswitch (maskPattern) {\n\n\t    case QRMaskPattern.PATTERN000 :\n\t\treturn function(i, j) { return (i + j) % 2 == 0; };\n\t    case QRMaskPattern.PATTERN001 :\n\t\treturn function(i, j) { return i % 2 == 0; };\n\t    case QRMaskPattern.PATTERN010 :\n\t\treturn function(i, j) { return j % 3 == 0; };\n\t    case QRMaskPattern.PATTERN011 :\n\t\treturn function(i, j) { return (i + j) % 3 == 0; };\n\t    case QRMaskPattern.PATTERN100 :\n\t\treturn function(i, j) { return (Math.floor(i / 2) + Math.floor(j / 3) ) % 2 == 0; };\n\t    case QRMaskPattern.PATTERN101 :\n\t\treturn function(i, j) { return (i * j) % 2 + (i * j) % 3 == 0; };\n\t    case QRMaskPattern.PATTERN110 :\n\t\treturn function(i, j) { return ( (i * j) % 2 + (i * j) % 3) % 2 == 0; };\n\t    case QRMaskPattern.PATTERN111 :\n\t\treturn function(i, j) { return ( (i * j) % 3 + (i + j) % 2) % 2 == 0; };\n\n\t\tdefault :\n\t\tthrow new Error('bad maskPattern:' + maskPattern);\n\t}\n    };\n\n    _this.getErrorCorrectPolynomial = function(errorCorrectLength) {\n\tvar a = qrPolynomial([1], 0);\n\tfor (var i = 0; i < errorCorrectLength; i += 1) {\n\t    a = a.multiply(qrPolynomial([1, QRMath.gexp(i)], 0) );\n\t}\n\treturn a;\n    };\n\n    _this.getLengthInBits = function(mode, type) {\n\n\tif (1 <= type && type < 10) {\n\n\t    // 1 - 9\n\n\t    switch(mode) {\n\t\tcase QRMode.MODE_NUMBER \t: return 10;\n\t\tcase QRMode.MODE_ALPHA_NUM \t: return 9;\n\t\tcase QRMode.MODE_8BIT_BYTE\t: return 8;\n\t\tcase QRMode.MODE_KANJI\t\t: return 8;\n\t\t    default :\n\t\t    throw new Error('mode:' + mode);\n\t    }\n\n\t} else if (type < 27) {\n\n\t    // 10 - 26\n\n\t    switch(mode) {\n\t\tcase QRMode.MODE_NUMBER \t: return 12;\n\t\tcase QRMode.MODE_ALPHA_NUM \t: return 11;\n\t\tcase QRMode.MODE_8BIT_BYTE\t: return 16;\n\t\tcase QRMode.MODE_KANJI\t\t: return 10;\n\t\t    default :\n\t\t    throw new Error('mode:' + mode);\n\t    }\n\n\t} else if (type < 41) {\n\n\t    // 27 - 40\n\n\t    switch(mode) {\n\t\tcase QRMode.MODE_NUMBER \t: return 14;\n\t\tcase QRMode.MODE_ALPHA_NUM\t: return 13;\n\t\tcase QRMode.MODE_8BIT_BYTE\t: return 16;\n\t\tcase QRMode.MODE_KANJI\t\t: return 12;\n\t\t    default :\n\t\t    throw new Error('mode:' + mode);\n\t    }\n\n\t} else {\n\t    throw new Error('type:' + type);\n\t}\n    };\n\n    _this.getLostPoint = function(qrcode) {\n\n\tvar moduleCount = qrcode.getModuleCount();\n\n\tvar lostPoint = 0;\n\n\t// LEVEL1\n\n\tfor (var row = 0; row < moduleCount; row += 1) {\n\t    for (var col = 0; col < moduleCount; col += 1) {\n\n\t\tvar sameCount = 0;\n\t\tvar dark = qrcode.isDark(row, col);\n\n\t\tfor (var r = -1; r <= 1; r += 1) {\n\n\t\t    if (row + r < 0 || moduleCount <= row + r) {\n\t\t\tcontinue;\n\t\t    }\n\n\t\t    for (var c = -1; c <= 1; c += 1) {\n\n\t\t\tif (col + c < 0 || moduleCount <= col + c) {\n\t\t\t    continue;\n\t\t\t}\n\n\t\t\tif (r == 0 && c == 0) {\n\t\t\t    continue;\n\t\t\t}\n\n\t\t\tif (dark == qrcode.isDark(row + r, col + c) ) {\n\t\t\t    sameCount += 1;\n\t\t\t}\n\t\t    }\n\t\t}\n\n\t\tif (sameCount > 5) {\n\t\t    lostPoint += (3 + sameCount - 5);\n\t\t}\n\t    }\n\t};\n\n\t// LEVEL2\n\n\tfor (var row = 0; row < moduleCount - 1; row += 1) {\n\t    for (var col = 0; col < moduleCount - 1; col += 1) {\n\t\tvar count = 0;\n\t\tif (qrcode.isDark(row, col) ) count += 1;\n\t\tif (qrcode.isDark(row + 1, col) ) count += 1;\n\t\tif (qrcode.isDark(row, col + 1) ) count += 1;\n\t\tif (qrcode.isDark(row + 1, col + 1) ) count += 1;\n\t\tif (count == 0 || count == 4) {\n\t\t    lostPoint += 3;\n\t\t}\n\t    }\n\t}\n\n\t// LEVEL3\n\n\tfor (var row = 0; row < moduleCount; row += 1) {\n\t    for (var col = 0; col < moduleCount - 6; col += 1) {\n\t\tif (qrcode.isDark(row, col)\n\t\t    && !qrcode.isDark(row, col + 1)\n\t\t    &&  qrcode.isDark(row, col + 2)\n\t\t    &&  qrcode.isDark(row, col + 3)\n\t\t    &&  qrcode.isDark(row, col + 4)\n\t\t    && !qrcode.isDark(row, col + 5)\n\t\t    &&  qrcode.isDark(row, col + 6) ) {\n\t\t    lostPoint += 40;\n\t\t}\n\t    }\n\t}\n\n\tfor (var col = 0; col < moduleCount; col += 1) {\n\t    for (var row = 0; row < moduleCount - 6; row += 1) {\n\t\tif (qrcode.isDark(row, col)\n\t\t    && !qrcode.isDark(row + 1, col)\n\t\t    &&  qrcode.isDark(row + 2, col)\n\t\t    &&  qrcode.isDark(row + 3, col)\n\t\t    &&  qrcode.isDark(row + 4, col)\n\t\t    && !qrcode.isDark(row + 5, col)\n\t\t    &&  qrcode.isDark(row + 6, col) ) {\n\t\t    lostPoint += 40;\n\t\t}\n\t    }\n\t}\n\n\t// LEVEL4\n\n\tvar darkCount = 0;\n\n\tfor (var col = 0; col < moduleCount; col += 1) {\n\t    for (var row = 0; row < moduleCount; row += 1) {\n\t\tif (qrcode.isDark(row, col) ) {\n\t\t    darkCount += 1;\n\t\t}\n\t    }\n\t}\n\n\tvar ratio = Math.abs(100 * darkCount / moduleCount / moduleCount - 50) / 5;\n\tlostPoint += ratio * 10;\n\n\treturn lostPoint;\n    };\n\n    return _this;\n}();\n\n//---------------------------------------------------------------------\n// QRMath\n//---------------------------------------------------------------------\n\nvar QRMath = function() {\n\n    var EXP_TABLE = new Array(256);\n    var LOG_TABLE = new Array(256);\n\n    // initialize tables\n    for (var i = 0; i < 8; i += 1) {\n\tEXP_TABLE[i] = 1 << i;\n    }\n    for (var i = 8; i < 256; i += 1) {\n\tEXP_TABLE[i] = EXP_TABLE[i - 4]\n\t    ^ EXP_TABLE[i - 5]\n\t    ^ EXP_TABLE[i - 6]\n\t    ^ EXP_TABLE[i - 8];\n    }\n    for (var i = 0; i < 255; i += 1) {\n\tLOG_TABLE[EXP_TABLE[i] ] = i;\n    }\n\n    var _this = {};\n\n    _this.glog = function(n) {\n\n\tif (n < 1) {\n\t    throw new Error('glog(' + n + ')');\n\t}\n\n\treturn LOG_TABLE[n];\n    };\n\n    _this.gexp = function(n) {\n\n\twhile (n < 0) {\n\t    n += 255;\n\t}\n\n\twhile (n >= 256) {\n\t    n -= 255;\n\t}\n\n\treturn EXP_TABLE[n];\n    };\n\n    return _this;\n}();\n\n//---------------------------------------------------------------------\n// qrPolynomial\n//---------------------------------------------------------------------\n\nfunction qrPolynomial(num, shift) {\n\n    if (typeof num.length == 'undefined') {\n\tthrow new Error(num.length + '/' + shift);\n    }\n\n    var _num = function() {\n\tvar offset = 0;\n\twhile (offset < num.length && num[offset] == 0) {\n\t    offset += 1;\n\t}\n\tvar _num = new Array(num.length - offset + shift);\n\tfor (var i = 0; i < num.length - offset; i += 1) {\n\t    _num[i] = num[i + offset];\n\t}\n\treturn _num;\n    }();\n\n    var _this = {};\n\n    _this.getAt = function(index) {\n\treturn _num[index];\n    };\n\n    _this.getLength = function() {\n\treturn _num.length;\n    };\n\n    _this.multiply = function(e) {\n\n\tvar num = new Array(_this.getLength() + e.getLength() - 1);\n\n\tfor (var i = 0; i < _this.getLength(); i += 1) {\n\t    for (var j = 0; j < e.getLength(); j += 1) {\n\t\tnum[i + j] ^= QRMath.gexp(QRMath.glog(_this.getAt(i) ) + QRMath.glog(e.getAt(j) ) );\n\t    }\n\t}\n\n\treturn qrPolynomial(num, 0);\n    };\n\n    _this.mod = function(e) {\n\n\tif (_this.getLength() - e.getLength() < 0) {\n\t    return _this;\n\t}\n\n\tvar ratio = QRMath.glog(_this.getAt(0) ) - QRMath.glog(e.getAt(0) );\n\n\tvar num = new Array(_this.getLength() );\n\tfor (var i = 0; i < _this.getLength(); i += 1) {\n\t    num[i] = _this.getAt(i);\n\t}\n\n\tfor (var i = 0; i < e.getLength(); i += 1) {\n\t    num[i] ^= QRMath.gexp(QRMath.glog(e.getAt(i) ) + ratio);\n\t}\n\n\t// recursive call\n\treturn qrPolynomial(num, 0).mod(e);\n    };\n\n    return _this;\n};\n\n//---------------------------------------------------------------------\n// QRRSBlock\n//---------------------------------------------------------------------\n\nvar QRRSBlock = function() {\n\n\n    // [1: [L, M, Q, H], ..]\n    var RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];\n\n    var qrRSBlock = function(totalCount, dataCount) {\n\tvar _this = {};\n\t_this.totalCount = totalCount;\n\t_this.dataCount = dataCount;\n\treturn _this;\n    };\n\n    var _this = {};\n\n    var getRsBlockTable = function(typeNumber, errorCorrectLevel) {\n\n\tswitch(errorCorrectLevel) {\n\t    case QRErrorCorrectLevel.L :\n\t\treturn RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 0];\n\t    case QRErrorCorrectLevel.M :\n\t\treturn RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 1];\n\t    case QRErrorCorrectLevel.Q :\n\t\treturn RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 2];\n\t    case QRErrorCorrectLevel.H :\n\t\treturn RS_BLOCK_TABLE[(typeNumber - 1) * 4 + 3];\n\t\tdefault :\n\t\treturn undefined;\n\t}\n    };\n\n    _this.getRSBlocks = function(typeNumber, errorCorrectLevel) {\n\n\tvar rsBlock = getRsBlockTable(typeNumber, errorCorrectLevel);\n\n\tif (typeof rsBlock == 'undefined') {\n\t    throw new Error('bad rs block @ typeNumber:' + typeNumber +\n\t\t\t    '/errorCorrectLevel:' + errorCorrectLevel);\n\t}\n\n\tvar length = rsBlock.length / 3;\n\n\tvar list = new Array();\n\n\tfor (var i = 0; i < length; i += 1) {\n\n\t    var count = rsBlock[i * 3 + 0];\n\t    var totalCount = rsBlock[i * 3 + 1];\n\t    var dataCount = rsBlock[i * 3 + 2];\n\n\t    for (var j = 0; j < count; j += 1) {\n\t\tlist.push(qrRSBlock(totalCount, dataCount) );\n\t    }\n\t}\n\n\treturn list;\n    };\n\n    return _this;\n}();\n\n//---------------------------------------------------------------------\n// qrBitBuffer\n//---------------------------------------------------------------------\n\nvar qrBitBuffer = function() {\n\n    var _buffer = new Array();\n    var _length = 0;\n\n    var _this = {};\n\n    _this.getBuffer = function() {\n\treturn _buffer;\n    };\n\n    _this.getAt = function(index) {\n\tvar bufIndex = Math.floor(index / 8);\n\treturn ( (_buffer[bufIndex] >>> (7 - index % 8) ) & 1) == 1;\n    };\n\n    _this.put = function(num, length) {\n\tfor (var i = 0; i < length; i += 1) {\n\t    _this.putBit( ( (num >>> (length - i - 1) ) & 1) == 1);\n\t}\n    };\n\n    _this.getLengthInBits = function() {\n\treturn _length;\n    };\n\n    _this.putBit = function(bit) {\n\n\tvar bufIndex = Math.floor(_length / 8);\n\tif (_buffer.length <= bufIndex) {\n\t    _buffer.push(0);\n\t}\n\n\tif (bit) {\n\t    _buffer[bufIndex] |= (0x80 >>> (_length % 8) );\n\t}\n\n\t_length += 1;\n    };\n\n    return _this;\n};\n\n//---------------------------------------------------------------------\n// qr8BitByte\n//---------------------------------------------------------------------\n\nvar qr8BitByte = function(data) {\n\n    var _mode = QRMode.MODE_8BIT_BYTE;\n    var _data = data;\n    var _parsedData = [];\n\n    var _this = {};\n\n\n    // Added to support UTF-8 Characters\n    for (var i = 0, l = _data.length; i < l; i++) {\n\tvar byteArray = [];\n\tvar code = _data.charCodeAt(i);\n\n\tif (code > 0x10000) {\n\t    byteArray[0] = 0xF0 | ((code & 0x1C0000) >>> 18);\n\t    byteArray[1] = 0x80 | ((code & 0x3F000) >>> 12);\n\t    byteArray[2] = 0x80 | ((code & 0xFC0) >>> 6);\n\t    byteArray[3] = 0x80 | (code & 0x3F);\n\t} else if (code > 0x800) {\n\t    byteArray[0] = 0xE0 | ((code & 0xF000) >>> 12);\n\t    byteArray[1] = 0x80 | ((code & 0xFC0) >>> 6);\n\t    byteArray[2] = 0x80 | (code & 0x3F);\n\t} else if (code > 0x80) {\n\t    byteArray[0] = 0xC0 | ((code & 0x7C0) >>> 6);\n\t    byteArray[1] = 0x80 | (code & 0x3F);\n\t} else {\n\t    byteArray[0] = code;\n\t}\n\n        // Fix Unicode corruption bug\n        _parsedData.push(byteArray);\n    }\n\n    _parsedData = Array.prototype.concat.apply([], _parsedData);\n\n    if (_parsedData.length != _data.length) {\n\t_parsedData.unshift(191);\n\t_parsedData.unshift(187);\n\t_parsedData.unshift(239);\n    }\n\n    var _bytes = _parsedData;\n\n    _this.getMode = function() {\n\treturn _mode;\n    };\n\n    _this.getLength = function(buffer) {\n\treturn _bytes.length;\n    };\n\n    _this.write = function(buffer) {\n\tfor (var i = 0; i < _bytes.length; i += 1) {\n\t    buffer.put(_bytes[i], 8);\n\t}\n    };\n\n    return _this;\n};\n\n//=====================================================================\n// GIF Support etc.\n//\n\n//---------------------------------------------------------------------\n// byteArrayOutputStream\n//---------------------------------------------------------------------\n\nvar byteArrayOutputStream = function() {\n\n    var _bytes = new Array();\n\n    var _this = {};\n\n    _this.writeByte = function(b) {\n\t_bytes.push(b & 0xff);\n    };\n\n    _this.writeShort = function(i) {\n\t_this.writeByte(i);\n\t_this.writeByte(i >>> 8);\n    };\n\n    _this.writeBytes = function(b, off, len) {\n\toff = off || 0;\n\tlen = len || b.length;\n\tfor (var i = 0; i < len; i += 1) {\n\t    _this.writeByte(b[i + off]);\n\t}\n    };\n\n    _this.writeString = function(s) {\n\tfor (var i = 0; i < s.length; i += 1) {\n\t    _this.writeByte(s.charCodeAt(i) );\n\t}\n    };\n\n    _this.toByteArray = function() {\n\treturn _bytes;\n    };\n\n    _this.toString = function() {\n\tvar s = '';\n\ts += '[';\n\tfor (var i = 0; i < _bytes.length; i += 1) {\n\t    if (i > 0) {\n\t\ts += ',';\n\t    }\n\t    s += _bytes[i];\n\t}\n\ts += ']';\n\treturn s;\n    };\n\n    return _this;\n};\n\n//---------------------------------------------------------------------\n// base64EncodeOutputStream\n//---------------------------------------------------------------------\n\nvar base64EncodeOutputStream = function() {\n\n    var _buffer = 0;\n    var _buflen = 0;\n    var _length = 0;\n    var _base64 = '';\n\n    var _this = {};\n\n    var writeEncoded = function(b) {\n\t_base64 += String.fromCharCode(encode(b & 0x3f) );\n    };\n\n    var encode = function(n) {\n\tif (n < 0) {\n\t    // error.\n\t} else if (n < 26) {\n\t    return 0x41 + n;\n\t} else if (n < 52) {\n\t    return 0x61 + (n - 26);\n\t} else if (n < 62) {\n\t    return 0x30 + (n - 52);\n\t} else if (n == 62) {\n\t    return 0x2b;\n\t} else if (n == 63) {\n\t    return 0x2f;\n\t}\n\tthrow new Error('n:' + n);\n    };\n\n    _this.writeByte = function(n) {\n\n\t_buffer = (_buffer << 8) | (n & 0xff);\n\t_buflen += 8;\n\t_length += 1;\n\n\twhile (_buflen >= 6) {\n\t    writeEncoded(_buffer >>> (_buflen - 6) );\n\t    _buflen -= 6;\n\t}\n    };\n\n    _this.flush = function() {\n\n\tif (_buflen > 0) {\n\t    writeEncoded(_buffer << (6 - _buflen) );\n\t    _buffer = 0;\n\t    _buflen = 0;\n\t}\n\n\tif (_length % 3 != 0) {\n\t    // padding\n\t    var padlen = 3 - _length % 3;\n\t    for (var i = 0; i < padlen; i += 1) {\n\t\t_base64 += '=';\n\t    }\n\t}\n    };\n\n    _this.toString = function() {\n\treturn _base64;\n    };\n\n    return _this;\n};\n\n//---------------------------------------------------------------------\n// base64DecodeInputStream\n//---------------------------------------------------------------------\n\nvar base64DecodeInputStream = function(str) {\n\n    var _str = str;\n    var _pos = 0;\n    var _buffer = 0;\n    var _buflen = 0;\n\n    var _this = {};\n\n    _this.read = function() {\n\n\twhile (_buflen < 8) {\n\n\t    if (_pos >= _str.length) {\n\t\tif (_buflen == 0) {\n\t\t    return -1;\n\t\t}\n\t\tthrow new Error('unexpected end of file./' + _buflen);\n\t    }\n\n\t    var c = _str.charAt(_pos);\n\t    _pos += 1;\n\n\t    if (c == '=') {\n\t\t_buflen = 0;\n\t\treturn -1;\n\t    } else if (c.match(/^\\s$/) ) {\n\t\t// ignore if whitespace.\n\t\tcontinue;\n\t    }\n\n\t    _buffer = (_buffer << 6) | decode(c.charCodeAt(0) );\n\t    _buflen += 6;\n\t}\n\n\tvar n = (_buffer >>> (_buflen - 8) ) & 0xff;\n\t_buflen -= 8;\n\treturn n;\n    };\n\n    var decode = function(c) {\n\tif (0x41 <= c && c <= 0x5a) {\n\t    return c - 0x41;\n\t} else if (0x61 <= c && c <= 0x7a) {\n\t    return c - 0x61 + 26;\n\t} else if (0x30 <= c && c <= 0x39) {\n\t    return c - 0x30 + 52;\n\t} else if (c == 0x2b) {\n\t    return 62;\n\t} else if (c == 0x2f) {\n\t    return 63;\n\t} else {\n\t    throw new Error('c:' + c);\n\t}\n    };\n\n    return _this;\n};\n\n//---------------------------------------------------------------------\n// gifImage (B/W)\n//---------------------------------------------------------------------\n\nvar gifImage = function(width, height) {\n\n    var _width = width;\n    var _height = height;\n    var _data = new Array(width * height);\n\n    var _this = {};\n\n    _this.setPixel = function(x, y, pixel) {\n\t_data[y * _width + x] = pixel;\n    };\n\n    _this.write = function(out) {\n\n\t//---------------------------------\n\t// GIF Signature\n\n\tout.writeString('GIF87a');\n\n\t//---------------------------------\n\t// Screen Descriptor\n\n\tout.writeShort(_width);\n\tout.writeShort(_height);\n\n\tout.writeByte(0x80); // 2bit\n\tout.writeByte(0);\n\tout.writeByte(0);\n\n\t//---------------------------------\n\t// Global Color Map\n\n\t// black\n\tout.writeByte(0x00);\n\tout.writeByte(0x00);\n\tout.writeByte(0x00);\n\n\t// white\n\tout.writeByte(0xff);\n\tout.writeByte(0xff);\n\tout.writeByte(0xff);\n\n\t//---------------------------------\n\t// Image Descriptor\n\n\tout.writeString(',');\n\tout.writeShort(0);\n\tout.writeShort(0);\n\tout.writeShort(_width);\n\tout.writeShort(_height);\n\tout.writeByte(0);\n\n\t//---------------------------------\n\t// Local Color Map\n\n\t//---------------------------------\n\t// Raster Data\n\n\tvar lzwMinCodeSize = 2;\n\tvar raster = getLZWRaster(lzwMinCodeSize);\n\n\tout.writeByte(lzwMinCodeSize);\n\n\tvar offset = 0;\n\n\twhile (raster.length - offset > 255) {\n\t    out.writeByte(255);\n\t    out.writeBytes(raster, offset, 255);\n\t    offset += 255;\n\t}\n\n\tout.writeByte(raster.length - offset);\n\tout.writeBytes(raster, offset, raster.length - offset);\n\tout.writeByte(0x00);\n\n\t//---------------------------------\n\t// GIF Terminator\n\tout.writeString(';');\n    };\n\n    var bitOutputStream = function(out) {\n\n\tvar _out = out;\n\tvar _bitLength = 0;\n\tvar _bitBuffer = 0;\n\n\tvar _this = {};\n\n\t_this.write = function(data, length) {\n\n\t    if ( (data >>> length) != 0) {\n\t\tthrow new Error('length over');\n\t    }\n\n\t    while (_bitLength + length >= 8) {\n\t\t_out.writeByte(0xff & ( (data << _bitLength) | _bitBuffer) );\n\t\tlength -= (8 - _bitLength);\n\t\tdata >>>= (8 - _bitLength);\n\t\t_bitBuffer = 0;\n\t\t_bitLength = 0;\n\t    }\n\n\t    _bitBuffer = (data << _bitLength) | _bitBuffer;\n\t    _bitLength = _bitLength + length;\n\t};\n\n\t_this.flush = function() {\n\t    if (_bitLength > 0) {\n\t\t_out.writeByte(_bitBuffer);\n\t    }\n\t};\n\n\treturn _this;\n    };\n\n    var getLZWRaster = function(lzwMinCodeSize) {\n\n\tvar clearCode = 1 << lzwMinCodeSize;\n\tvar endCode = (1 << lzwMinCodeSize) + 1;\n\tvar bitLength = lzwMinCodeSize + 1;\n\n\t// Setup LZWTable\n\tvar table = lzwTable();\n\n\tfor (var i = 0; i < clearCode; i += 1) {\n\t    table.add(String.fromCharCode(i) );\n\t}\n\ttable.add(String.fromCharCode(clearCode) );\n\ttable.add(String.fromCharCode(endCode) );\n\n\tvar byteOut = byteArrayOutputStream();\n\tvar bitOut = bitOutputStream(byteOut);\n\n\t// clear code\n\tbitOut.write(clearCode, bitLength);\n\n\tvar dataIndex = 0;\n\n\tvar s = String.fromCharCode(_data[dataIndex]);\n\tdataIndex += 1;\n\n\twhile (dataIndex < _data.length) {\n\n\t    var c = String.fromCharCode(_data[dataIndex]);\n\t    dataIndex += 1;\n\n\t    if (table.contains(s + c) ) {\n\n\t\ts = s + c;\n\n\t    } else {\n\n\t\tbitOut.write(table.indexOf(s), bitLength);\n\n\t\tif (table.size() < 0xfff) {\n\n\t\t    if (table.size() == (1 << bitLength) ) {\n\t\t\tbitLength += 1;\n\t\t    }\n\n\t\t    table.add(s + c);\n\t\t}\n\n\t\ts = c;\n\t    }\n\t}\n\n\tbitOut.write(table.indexOf(s), bitLength);\n\n\t// end code\n\tbitOut.write(endCode, bitLength);\n\n\tbitOut.flush();\n\n\treturn byteOut.toByteArray();\n    };\n\n    var lzwTable = function() {\n\n\tvar _map = {};\n\tvar _size = 0;\n\n\tvar _this = {};\n\n\t_this.add = function(key) {\n\t    if (_this.contains(key) ) {\n\t\tthrow new Error('dup key:' + key);\n\t    }\n\t    _map[key] = _size;\n\t    _size += 1;\n\t};\n\n\t_this.size = function() {\n\t    return _size;\n\t};\n\n\t_this.indexOf = function(key) {\n\t    return _map[key];\n\t};\n\n\t_this.contains = function(key) {\n\t    return typeof _map[key] != 'undefined';\n\t};\n\n\treturn _this;\n    };\n\n    return _this;\n};\n\nvar createImgTag = function(width, height, getPixel, alt) {\n\n    var gif = gifImage(width, height);\n    for (var y = 0; y < height; y += 1) {\n\tfor (var x = 0; x < width; x += 1) {\n\t    gif.setPixel(x, y, getPixel(x, y) );\n\t}\n    }\n\n    var b = byteArrayOutputStream();\n    gif.write(b);\n\n    var base64 = base64EncodeOutputStream();\n    var bytes = b.toByteArray();\n    for (var i = 0; i < bytes.length; i += 1) {\n\tbase64.writeByte(bytes[i]);\n    }\n    base64.flush();\n\n    var img = '';\n    img += 'data:image/gif;base64,';\n    img += base64;\n\n    return img;\n};\n\n//---------------------------------------------------------------------\n// returns qrcode function.\n\nvar drawImg = function(text, options) {\n    options = options || {};\n    var typeNumber = options.typeNumber || 4;\n    var errorCorrectLevel = options.errorCorrectLevel || 'M';\n    var size = options.size || 500;\n\n    var qr;\n\n    try {\n        qr = qrcode(typeNumber, errorCorrectLevel || 'M');\n        qr.addData(text);\n        qr.make();\n    } catch (e) {\n        if(typeNumber >= 40) {\n            throw new Error('Text too long to encode');\n        } else {\n            return drawImg(text, {\n                size: size,\n                errorCorrectLevel: errorCorrectLevel,\n                typeNumber: typeNumber + 1\n            });\n        }\n    }\n\n    // calc cellsize and margin\n    var cellsize = parseInt(size / qr.getModuleCount());\n    var margin = parseInt((size - qr.getModuleCount() * cellsize) / 2);\n\n    return qr.createImgTag(cellsize, margin, size);\n};\nmodule.exports = {\n\tdrawImg: drawImg\n};"]},"metadata":{},"sourceType":"script"}