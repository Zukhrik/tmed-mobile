{"ast":null,"code":"import _toConsumableArray from\"/Users/zuhriddinkamilzanov/Desktop/tMed-mobile/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/zuhriddinkamilzanov/Desktop/tMed-mobile/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{combine,createStore}from'effector';import{fetchOfferingGallery,fetchOfferingInfo,fetchOfferings,fetchOfferingsCharacs,fetchOrgOfferGroupList,fetchOrgOfferings,fetchPeopleOfferings,fetchUserOfferGroupList}from'./effects';import i18next from'i18next';import*as moment from'moment';import{PARAMS_CHARACTER_TYPE}from'../../Constants';import{commonStoreList}from'../../utils/store-utils';import{changeLoadingStatusOffering,changeOrgOfferingStatus,offeringForceLoading,resetOfferingModelStoreList,resetOrgOfferingList}from'./events';var $offeringsList=createStore({loading:false,data:[],result:{},forceLoading:0,error:false}).on(fetchOfferings.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchOfferings.fail,function(state,_ref){var error=_ref.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[],result:{},forceLoading:state.forceLoading===2?state.forceLoading:1});}).on(fetchOfferings.done,function(state,_ref2){var params=_ref2.params,result=_ref2.result;var processed=commonStoreList(_objectSpread({response:result.data,state:state,clear:params.clear},params.params));return _objectSpread(_objectSpread(_objectSpread({},state),processed),{},{forceLoading:2});}).on(fetchOrgOfferings.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchOrgOfferings.fail,function(state,_ref3){var error=_ref3.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[],result:{}});}).on(fetchOrgOfferings.done,function(state,_ref4){var result=_ref4.result,params=_ref4.params;var processed=commonStoreList(_objectSpread({response:result.data,state:state,clear:params.clear},params.params));return _objectSpread(_objectSpread(_objectSpread({},state),processed),{},{forceLoading:2});}).on(changeOrgOfferingStatus,function(state,_ref5){var offering_id=_ref5.offering_id,status=_ref5.status,loadingStatus=_ref5.loadingStatus;var idx=state.data.findIndex(function(item){return item.id===offering_id;});var newItem=_objectSpread(_objectSpread({},state.data[idx]),{},{is_in_cart:status,loading:loadingStatus});var newData=[].concat(_toConsumableArray(state.data.slice(0,idx)),[_objectSpread({},newItem)],_toConsumableArray(state.data.slice(idx+1)));return _objectSpread(_objectSpread({},state),{},{data:newData});}).on(fetchPeopleOfferings.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchPeopleOfferings.fail,function(state,_ref6){var error=_ref6.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[],result:{}});}).on(fetchPeopleOfferings.done,function(state,res){var clear=res.params.clear;var newData=clear?res.result.data.results:[].concat(_toConsumableArray(state.data),_toConsumableArray(res.result.data.results));return _objectSpread(_objectSpread({},state),{},{result:res.result.data,data:newData,forceLoading:false});}).on(offeringForceLoading,function(state){return _objectSpread(_objectSpread({},state),{},{forceLoading:true});}).on(changeLoadingStatusOffering,function(state,payload){var id=payload.id,status=payload.status;var idx=state.data.findIndex(function(item){return item.id===id;});var newItem=_objectSpread(_objectSpread({},state.data[idx]),{},{loading:status});var newData=[].concat(_toConsumableArray(state.data.slice(0,idx)),[_objectSpread({},newItem)],_toConsumableArray(state.data.slice(idx+1)));return _objectSpread(_objectSpread({},state),{},{data:newData});}).reset(resetOrgOfferingList);var $offeringGroupList=createStore({loading:false,data:[],result:{},forceLoading:0,error:false}).on(fetchOrgOfferGroupList.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchOrgOfferGroupList.fail,function(state,_ref7){var error=_ref7.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[],result:{},forceLoading:state.forceLoading===2?state.forceLoading:1});}).on(fetchOrgOfferGroupList.done,function(state,_ref8){var result=_ref8.result,params=_ref8.params;// const {params: {clear}} = res\n// const newData = clear ? res.result.data.results : [...state.data, ...res.result.data.results]\nvar processed=commonStoreList(_objectSpread({response:result.data,state:state,clear:params.clear},params.params));return _objectSpread(_objectSpread(_objectSpread({},state),processed),{},{forceLoading:2});}).on(fetchUserOfferGroupList.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchUserOfferGroupList.fail,function(state,_ref9){var error=_ref9.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[],result:{}});}).on(fetchUserOfferGroupList.done,function(state,res){return _objectSpread(_objectSpread({},state),{},{result:res.result.data,data:res.result.data.results});}).reset(resetOfferingModelStoreList);var $offeringInfo=createStore({loading:false,data:{},error:false,forceLoading:0,result:{}}).on(fetchOfferingInfo.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchOfferingInfo.fail,function(state,_ref10){var error=_ref10.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:{},result:{},forceLoading:state.forceLoading===2?state.forceLoading:1});}).on(fetchOfferingInfo.done,function(state,res){return _objectSpread(_objectSpread({},state),{},{data:res.result.data,result:res.result.data,forceLoading:2});});var $offeringsCharacs=createStore({loading:false,data:[],error:false}).on(fetchOfferingsCharacs.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchOfferingsCharacs.fail,function(state,_ref11){var error=_ref11.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[]});}).on(fetchOfferingsCharacs.done,function(state,res){var data=res.result.data.filter(function(item){return item.value;});var tmp1={};for(var i=0;i<data.length;i++){var param_value=null;var type=data[i].character.character_type;if(type===PARAMS_CHARACTER_TYPE.YEAR_FIELD){param_value=i18next.t('year_n',{n:moment(data[i].value).format('YYYY')});}else{param_value=data[i].value;}if(tmp1[\"param_\".concat(data[i].character.id)]){var value=null;if(type===PARAMS_CHARACTER_TYPE.COLOUR_FIELD){value=[].concat(_toConsumableArray(tmp1[\"param_\".concat(data[i].character.id)].value),[param_value]);}else{value=\"\".concat(tmp1[\"param_\".concat(data[i].character.id)].value,\", \").concat(param_value);}tmp1[\"param_\".concat(data[i].character.id)]=_objectSpread(_objectSpread({},data[i]),{},{value:value});}else{var _value=null;if(type===PARAMS_CHARACTER_TYPE.COLOUR_FIELD){_value=[param_value];}else{_value=param_value;}tmp1[\"param_\".concat(data[i].character.id)]=_objectSpread(_objectSpread({},data[i]),{},{value:_value});}}return _objectSpread(_objectSpread({},state),{},{data:Object.values(tmp1)});});var $offeringGallery=createStore({loading:false,data:[],forceLoading:0,error:false}).on(fetchOfferingGallery.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchOfferingGallery.fail,function(state,_ref12){var error=_ref12.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[],forceLoading:state.forceLoading===2?state.forceLoading:1});}).on(fetchOfferingGallery.done,function(state,res){var tmp=[];if(res.result.data.length>0){var main=res.result.data.find(function(item){return item.main;});if(main){tmp=[_objectSpread({},main)].concat(_toConsumableArray(res.result.data.filter(function(item){return!item.main;})));}else{tmp=res.result.data;}}return _objectSpread(_objectSpread({},state),{},{data:tmp,forceLoading:2});});export var $offeringsModel=combine({$offeringInfo:$offeringInfo,$offeringsList:$offeringsList,$offeringGallery:$offeringGallery,$offeringsCharacs:$offeringsCharacs,$offeringGroupList:$offeringGroupList});","map":{"version":3,"sources":["/Users/zuhriddinkamilzanov/Desktop/tMed-mobile/src/Models/offerings-model/stores.js"],"names":["combine","createStore","fetchOfferingGallery","fetchOfferingInfo","fetchOfferings","fetchOfferingsCharacs","fetchOrgOfferGroupList","fetchOrgOfferings","fetchPeopleOfferings","fetchUserOfferGroupList","i18next","moment","PARAMS_CHARACTER_TYPE","commonStoreList","changeLoadingStatusOffering","changeOrgOfferingStatus","offeringForceLoading","resetOfferingModelStoreList","resetOrgOfferingList","$offeringsList","loading","data","result","forceLoading","error","on","pending","state","fail","done","params","processed","response","clear","offering_id","status","loadingStatus","idx","findIndex","item","id","newItem","is_in_cart","newData","slice","res","results","payload","reset","$offeringGroupList","$offeringInfo","$offeringsCharacs","filter","value","tmp1","i","length","param_value","type","character","character_type","YEAR_FIELD","t","n","format","COLOUR_FIELD","Object","values","$offeringGallery","tmp","main","find","$offeringsModel"],"mappings":"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","sourcesContent":["import {combine, createStore} from 'effector'\r\nimport {\r\n    fetchOfferingGallery,\r\n    fetchOfferingInfo,\r\n    fetchOfferings,\r\n    fetchOfferingsCharacs,\r\n    fetchOrgOfferGroupList,\r\n    fetchOrgOfferings,\r\n    fetchPeopleOfferings,\r\n    fetchUserOfferGroupList\r\n} from './effects'\r\nimport i18next from 'i18next'\r\nimport * as moment from 'moment'\r\nimport {PARAMS_CHARACTER_TYPE} from '../../Constants'\r\nimport {commonStoreList} from '../../utils/store-utils'\r\nimport {\r\n    changeLoadingStatusOffering,\r\n    changeOrgOfferingStatus,\r\n    offeringForceLoading,\r\n    resetOfferingModelStoreList,\r\n    resetOrgOfferingList\r\n} from './events'\r\n\r\nconst $offeringsList = createStore({loading: false, data: [], result: {}, forceLoading: 0, error: false})\r\n    .on(fetchOfferings.pending, (state, loading) => ({...state, loading}))\r\n    .on(fetchOfferings.fail, (state, {error}) => ({\r\n        ...state, error, data: [], result: {}, forceLoading: state.forceLoading === 2 ? state.forceLoading : 1\r\n    }))\r\n    .on(fetchOfferings.done, (state, {params, result}) => {\r\n        const processed = commonStoreList({\r\n            response: result.data, state, clear: params.clear, ...params.params\r\n        })\r\n        \r\n        return {...state, ...processed, forceLoading: 2}\r\n    })\r\n    .on(fetchOrgOfferings.pending, (state, loading) => ({...state, loading}))\r\n    .on(fetchOrgOfferings.fail, (state, {error}) => ({\r\n        ...state, error, data: [], result: {}\r\n    }))\r\n    .on(fetchOrgOfferings.done, (state, {result, params}) => {\r\n        const processed = commonStoreList({\r\n            response: result.data, state, clear: params.clear, ...params.params\r\n        })\r\n        return {...state, ...processed, forceLoading: 2}\r\n    })\r\n    .on(changeOrgOfferingStatus, (state, {offering_id, status, loadingStatus}) => {\r\n        const idx = state.data.findIndex(item => item.id === offering_id)\r\n        const newItem = {...state.data[idx], is_in_cart: status, loading: loadingStatus}\r\n        const newData = [...state.data.slice(0, idx), {...newItem}, ...state.data.slice(idx + 1)]\r\n        return {...state, data: newData}\r\n    })\r\n    .on(fetchPeopleOfferings.pending, (state, loading) => ({...state, loading}))\r\n    .on(fetchPeopleOfferings.fail, (state, {error}) => ({\r\n        ...state, error, data: [], result: {}\r\n    }))\r\n    .on(fetchPeopleOfferings.done, (state, res) => {\r\n        const {params: {clear}} = res\r\n        const newData = clear ? res.result.data.results : [...state.data, ...res.result.data.results]\r\n        return {\r\n            ...state, result: res.result.data, data: newData, forceLoading: false\r\n        }\r\n    })\r\n    .on(offeringForceLoading, (state) => ({...state, forceLoading: true}))\r\n    .on(changeLoadingStatusOffering, (state, payload) => {\r\n        const {id, status} = payload\r\n        const idx = state.data.findIndex(item => item.id === id)\r\n        const newItem = {...state.data[idx], loading: status}\r\n        const newData = [...state.data.slice(0, idx), {...newItem}, ...state.data.slice(idx + 1)]\r\n        return {...state, data: newData}\r\n    })\r\n    .reset(resetOrgOfferingList)\r\n\r\n\r\nconst $offeringGroupList = createStore(\r\n    {loading: false, data: [], result: {}, forceLoading: 0, error: false}\r\n)\r\n    .on(fetchOrgOfferGroupList.pending, (state, loading) => ({...state, loading}))\r\n    .on(fetchOrgOfferGroupList.fail, (state, {error}) => ({\r\n        ...state, error, data: [], result: {}, forceLoading: state.forceLoading === 2 ? state.forceLoading : 1\r\n    }))\r\n    .on(fetchOrgOfferGroupList.done, (state, {result, params}) => {\r\n        // const {params: {clear}} = res\r\n        // const newData = clear ? res.result.data.results : [...state.data, ...res.result.data.results]\r\n        const processed = commonStoreList({\r\n            response: result.data, state, clear: params.clear, ...params.params\r\n        })\r\n        \r\n        return {\r\n            ...state, ...processed, forceLoading: 2\r\n        }\r\n    })\r\n    .on(fetchUserOfferGroupList.pending, (state, loading) => ({...state, loading}))\r\n    .on(fetchUserOfferGroupList.fail, (state, {error}) => ({\r\n        ...state, error, data: [], result: {}\r\n    }))\r\n    .on(fetchUserOfferGroupList.done, (state, res) => ({\r\n        ...state, result: res.result.data, data: res.result.data.results\r\n    }))\r\n    .reset(resetOfferingModelStoreList)\r\n\r\nconst $offeringInfo = createStore({loading: false, data: {}, error: false, forceLoading: 0, result: {}})\r\n    .on(fetchOfferingInfo.pending, (state, loading) => ({...state, loading}))\r\n    .on(fetchOfferingInfo.fail, (state, {error}) => ({\r\n        ...state, error, data: {}, result: {}, forceLoading: state.forceLoading === 2 ? state.forceLoading : 1\r\n    }))\r\n    .on(fetchOfferingInfo.done, (state, res) => {\r\n        return {\r\n            ...state, data: res.result.data, result: res.result.data, forceLoading: 2\r\n        }\r\n    })\r\n\r\nconst $offeringsCharacs = createStore({loading: false, data: [], error: false})\r\n    .on(fetchOfferingsCharacs.pending, (state, loading) => ({...state, loading}))\r\n    .on(fetchOfferingsCharacs.fail, (state, {error}) => ({\r\n        ...state, error, data: []\r\n    }))\r\n    .on(fetchOfferingsCharacs.done, (state, res) => {\r\n        const data = res.result.data.filter(item => item.value)\r\n        const tmp1 = {}\r\n        for (let i = 0; i < data.length; i++) {\r\n            let param_value = null\r\n            \r\n            const type = data[i].character.character_type\r\n            if (type === PARAMS_CHARACTER_TYPE.YEAR_FIELD) {\r\n                param_value = i18next.t('year_n', {n: moment(data[i].value).format('YYYY')})\r\n            } else {\r\n                param_value = data[i].value\r\n            }\r\n            \r\n            if (tmp1[`param_${data[i].character.id}`]) {\r\n                let value = null\r\n                if (type === PARAMS_CHARACTER_TYPE.COLOUR_FIELD) {\r\n                    value = [...tmp1[`param_${data[i].character.id}`].value, param_value]\r\n                } else {\r\n                    value = `${tmp1[`param_${data[i].character.id}`].value}, ${param_value}`\r\n                }\r\n                \r\n                tmp1[`param_${data[i].character.id}`] = {\r\n                    ...data[i],\r\n                    value\r\n                }\r\n            } else {\r\n                let value = null\r\n                if (type === PARAMS_CHARACTER_TYPE.COLOUR_FIELD) {\r\n                    value = [param_value]\r\n                } else {\r\n                    value = param_value\r\n                }\r\n                tmp1[`param_${data[i].character.id}`] = {...data[i], value}\r\n            }\r\n        }\r\n        \r\n        return {\r\n            ...state, data: Object.values(tmp1)\r\n        }\r\n    })\r\n\r\nconst $offeringGallery = createStore({loading: false, data: [], forceLoading: 0, error: false})\r\n    .on(fetchOfferingGallery.pending, (state, loading) => ({...state, loading}))\r\n    .on(fetchOfferingGallery.fail, (state, {error}) => ({\r\n        ...state, error, data: [], forceLoading: state.forceLoading === 2 ? state.forceLoading : 1\r\n    }))\r\n    .on(fetchOfferingGallery.done, (state, res) => {\r\n        let tmp = []\r\n        if (res.result.data.length > 0) {\r\n            const main = res.result.data.find(item => item.main)\r\n            if (main) {\r\n                tmp = [{...main}, ...res.result.data.filter(item => !item.main)]\r\n            } else {\r\n                tmp = res.result.data\r\n            }\r\n        }\r\n        return {\r\n            ...state, data: tmp, forceLoading: 2\r\n        }\r\n    })\r\n\r\nexport const $offeringsModel = combine({\r\n    $offeringInfo,\r\n    $offeringsList,\r\n    $offeringGallery,\r\n    $offeringsCharacs,\r\n    $offeringGroupList\r\n})\r\n"]},"metadata":{},"sourceType":"module"}