{"ast":null,"code":"import _toConsumableArray from\"/Users/zuhriddinkamilzanov/Desktop/t-med(mobile)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/zuhriddinkamilzanov/Desktop/t-med(mobile)/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{combine,createStore}from'effector';import{fetchOfferingGallery,fetchOfferingInfo,fetchOfferings,fetchOfferingsCharacs,fetchOrgOfferGroupList,fetchOrgOfferings,fetchPeopleOfferings,fetchUserOfferGroupList}from'./effects';import i18next from'i18next';import*as moment from'moment';import{PARAMS_CHARACTER_TYPE}from'../../Constants';import{commonStoreList}from'../../utils/store-utils';import{changeLoadingStatusOffering,changeOrgOfferingStatus,offeringForceLoading,resetOfferingModelStoreList,resetOrgOfferingList}from'./events';var $offeringsList=createStore({loading:false,data:[],result:{},forceLoading:0,error:false}).on(fetchOfferings.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchOfferings.fail,function(state,_ref){var error=_ref.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[],result:{},forceLoading:state.forceLoading===2?state.forceLoading:1});}).on(fetchOfferings.done,function(state,_ref2){var params=_ref2.params,result=_ref2.result;var processed=commonStoreList(_objectSpread({response:result.data,state:state,clear:params.clear},params.params));return _objectSpread(_objectSpread(_objectSpread({},state),processed),{},{forceLoading:2});}).on(fetchOrgOfferings.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchOrgOfferings.fail,function(state,_ref3){var error=_ref3.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[],result:{}});}).on(fetchOrgOfferings.done,function(state,_ref4){var result=_ref4.result,params=_ref4.params;var processed=commonStoreList(_objectSpread({response:result.data,state:state,clear:params.clear},params.params));return _objectSpread(_objectSpread(_objectSpread({},state),processed),{},{forceLoading:2});}).on(changeOrgOfferingStatus,function(state,_ref5){var offering_id=_ref5.offering_id,status=_ref5.status,loadingStatus=_ref5.loadingStatus;var idx=state.data.findIndex(function(item){return item.id===offering_id;});var newItem=_objectSpread(_objectSpread({},state.data[idx]),{},{is_in_cart:status,loading:loadingStatus});var newData=[].concat(_toConsumableArray(state.data.slice(0,idx)),[_objectSpread({},newItem)],_toConsumableArray(state.data.slice(idx+1)));return _objectSpread(_objectSpread({},state),{},{data:newData});}).on(fetchPeopleOfferings.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchPeopleOfferings.fail,function(state,_ref6){var error=_ref6.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[],result:{}});}).on(fetchPeopleOfferings.done,function(state,res){var clear=res.params.clear;var newData=clear?res.result.data.results:[].concat(_toConsumableArray(state.data),_toConsumableArray(res.result.data.results));return _objectSpread(_objectSpread({},state),{},{result:res.result.data,data:newData,forceLoading:false});}).on(offeringForceLoading,function(state){return _objectSpread(_objectSpread({},state),{},{forceLoading:true});}).on(changeLoadingStatusOffering,function(state,payload){var id=payload.id,status=payload.status;var idx=state.data.findIndex(function(item){return item.id===id;});var newItem=_objectSpread(_objectSpread({},state.data[idx]),{},{loading:status});var newData=[].concat(_toConsumableArray(state.data.slice(0,idx)),[_objectSpread({},newItem)],_toConsumableArray(state.data.slice(idx+1)));return _objectSpread(_objectSpread({},state),{},{data:newData});}).reset(resetOrgOfferingList);var $offeringGroupList=createStore({loading:false,data:[],result:{},forceLoading:0,error:false}).on(fetchOrgOfferGroupList.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchOrgOfferGroupList.fail,function(state,_ref7){var error=_ref7.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[],result:{},forceLoading:state.forceLoading===2?state.forceLoading:1});}).on(fetchOrgOfferGroupList.done,function(state,_ref8){var result=_ref8.result,params=_ref8.params;// const {params: {clear}} = res\n// const newData = clear ? res.result.data.results : [...state.data, ...res.result.data.results]\nvar processed=commonStoreList(_objectSpread({response:result.data,state:state,clear:params.clear},params.params));return _objectSpread(_objectSpread(_objectSpread({},state),processed),{},{forceLoading:2});}).on(fetchUserOfferGroupList.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchUserOfferGroupList.fail,function(state,_ref9){var error=_ref9.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[],result:{}});}).on(fetchUserOfferGroupList.done,function(state,res){return _objectSpread(_objectSpread({},state),{},{result:res.result.data,data:res.result.data.results});}).reset(resetOfferingModelStoreList);var $offeringInfo=createStore({loading:false,data:{},error:false,forceLoading:0,result:{}}).on(fetchOfferingInfo.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchOfferingInfo.fail,function(state,_ref10){var error=_ref10.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:{},result:{},forceLoading:state.forceLoading===2?state.forceLoading:1});}).on(fetchOfferingInfo.done,function(state,res){return _objectSpread(_objectSpread({},state),{},{data:res.result.data,result:res.result.data,forceLoading:2});});var $offeringsCharacs=createStore({loading:false,data:[],error:false}).on(fetchOfferingsCharacs.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchOfferingsCharacs.fail,function(state,_ref11){var error=_ref11.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[]});}).on(fetchOfferingsCharacs.done,function(state,res){var data=res.result.data.filter(function(item){return item.value;});var tmp1={};for(var i=0;i<data.length;i++){var param_value=null;var type=data[i].character.character_type;if(type===PARAMS_CHARACTER_TYPE.YEAR_FIELD){param_value=i18next.t('year_n',{n:moment(data[i].value).format('YYYY')});}else{param_value=data[i].value;}if(tmp1[\"param_\".concat(data[i].character.id)]){var value=null;if(type===PARAMS_CHARACTER_TYPE.COLOUR_FIELD){value=[].concat(_toConsumableArray(tmp1[\"param_\".concat(data[i].character.id)].value),[param_value]);}else{value=\"\".concat(tmp1[\"param_\".concat(data[i].character.id)].value,\", \").concat(param_value);}tmp1[\"param_\".concat(data[i].character.id)]=_objectSpread(_objectSpread({},data[i]),{},{value:value});}else{var _value=null;if(type===PARAMS_CHARACTER_TYPE.COLOUR_FIELD){_value=[param_value];}else{_value=param_value;}tmp1[\"param_\".concat(data[i].character.id)]=_objectSpread(_objectSpread({},data[i]),{},{value:_value});}}return _objectSpread(_objectSpread({},state),{},{data:Object.values(tmp1)});});var $offeringGallery=createStore({loading:false,data:[],forceLoading:0,error:false}).on(fetchOfferingGallery.pending,function(state,loading){return _objectSpread(_objectSpread({},state),{},{loading:loading});}).on(fetchOfferingGallery.fail,function(state,_ref12){var error=_ref12.error;return _objectSpread(_objectSpread({},state),{},{error:error,data:[],forceLoading:state.forceLoading===2?state.forceLoading:1});}).on(fetchOfferingGallery.done,function(state,res){var tmp=[];if(res.result.data.length>0){var main=res.result.data.find(function(item){return item.main;});if(main){tmp=[_objectSpread({},main)].concat(_toConsumableArray(res.result.data.filter(function(item){return!item.main;})));}else{tmp=res.result.data;}}return _objectSpread(_objectSpread({},state),{},{data:tmp,forceLoading:2});});export var $offeringsModel=combine({$offeringInfo:$offeringInfo,$offeringsList:$offeringsList,$offeringGallery:$offeringGallery,$offeringsCharacs:$offeringsCharacs,$offeringGroupList:$offeringGroupList});","map":null,"metadata":{},"sourceType":"module"}