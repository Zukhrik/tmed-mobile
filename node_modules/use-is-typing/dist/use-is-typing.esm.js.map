{"version":3,"file":"use-is-typing.esm.js","sources":["../src/index.tsx"],"sourcesContent":["import { useCallback, useEffect, useState, useRef } from 'react';\n\nexport interface UseIsTypingProps {\n  /**\n   * Time in milliseconds before typing indicator gets reset. **Default:** `1000`\n   */\n  timeout?: number;\n}\n\nexport type TextElement = HTMLInputElement | HTMLTextAreaElement;\n\nexport type RegisterElement = <Element extends TextElement = TextElement>(\n  el: Element | null,\n) => void;\n\nexport function useIsTyping({ timeout = 1000 }: UseIsTypingProps = {}): [\n  boolean,\n  RegisterElement,\n] {\n  const [isTyping, setIsTyping] = useState(false);\n  const [currentEl, setCurrentEl] = useState<TextElement | null>(null);\n  const timeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  const reset = useCallback(() => {\n    // Debounce `reset()` based on `timeout`\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n    }\n    timeoutRef.current = setTimeout(() => {\n      setIsTyping(false);\n    }, timeout);\n  }, [timeout]);\n\n  const register: RegisterElement = useCallback(el => {\n    setCurrentEl(el);\n    if (!el) {\n      setIsTyping(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    // Clear timeout on unmount\n    return () => {\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    setIsTyping(false);\n    if (!currentEl) {\n      return;\n    }\n\n    const keyUpDownListener = (e: Event) => {\n      const hasValue = (e.target as TextElement).value !== '';\n\n      setIsTyping(hasValue);\n      reset();\n    };\n    const blurListener = () => {\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current);\n      }\n      setIsTyping(false);\n    };\n\n    currentEl.addEventListener('keyup', keyUpDownListener);\n    currentEl.addEventListener('keydown', keyUpDownListener);\n    currentEl.addEventListener('blur', blurListener);\n\n    return () => {\n      currentEl.removeEventListener('keydown', keyUpDownListener);\n      currentEl.removeEventListener('keyup', keyUpDownListener);\n      currentEl.removeEventListener('blur', blurListener);\n    };\n  }, [currentEl, reset]);\n\n  return [isTyping, register];\n}\n\nexport default useIsTyping;\n"],"names":["useIsTyping","timeout","useState","isTyping","setIsTyping","currentEl","setCurrentEl","timeoutRef","useRef","reset","useCallback","current","clearTimeout","setTimeout","register","el","useEffect","keyUpDownListener","e","hasValue","target","value","blurListener","addEventListener","removeEventListener"],"mappings":";;SAegBA;gCAAmD;0BAArCC;MAAAA,oCAAU;;kBAINC,QAAQ,CAAC,KAAD;MAAjCC;MAAUC;;mBACiBF,QAAQ,CAAqB,IAArB;MAAnCG;MAAWC;;AAClB,MAAMC,UAAU,GAAGC,MAAM,CAAuC,IAAvC,CAAzB;AAEA,MAAMC,KAAK,GAAGC,WAAW,CAAC;AACxB;AACA,QAAIH,UAAU,CAACI,OAAf,EAAwB;AACtBC,MAAAA,YAAY,CAACL,UAAU,CAACI,OAAZ,CAAZ;AACD;;AACDJ,IAAAA,UAAU,CAACI,OAAX,GAAqBE,UAAU,CAAC;AAC9BT,MAAAA,WAAW,CAAC,KAAD,CAAX;AACD,KAF8B,EAE5BH,OAF4B,CAA/B;AAGD,GARwB,EAQtB,CAACA,OAAD,CARsB,CAAzB;AAUA,MAAMa,QAAQ,GAAoBJ,WAAW,CAAC,UAAAK,EAAE;AAC9CT,IAAAA,YAAY,CAACS,EAAD,CAAZ;;AACA,QAAI,CAACA,EAAL,EAAS;AACPX,MAAAA,WAAW,CAAC,KAAD,CAAX;AACD;AACF,GAL4C,EAK1C,EAL0C,CAA7C;AAOAY,EAAAA,SAAS,CAAC;AACR;AACA,WAAO;AACL,UAAIT,UAAU,CAACI,OAAf,EAAwB;AACtBC,QAAAA,YAAY,CAACL,UAAU,CAACI,OAAZ,CAAZ;AACD;AACF,KAJD;AAKD,GAPQ,EAON,EAPM,CAAT;AASAK,EAAAA,SAAS,CAAC;AACRZ,IAAAA,WAAW,CAAC,KAAD,CAAX;;AACA,QAAI,CAACC,SAAL,EAAgB;AACd;AACD;;AAED,QAAMY,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,CAAD;AACxB,UAAMC,QAAQ,GAAID,CAAC,CAACE,MAAF,CAAyBC,KAAzB,KAAmC,EAArD;AAEAjB,MAAAA,WAAW,CAACe,QAAD,CAAX;AACAV,MAAAA,KAAK;AACN,KALD;;AAMA,QAAMa,YAAY,GAAG,SAAfA,YAAe;AACnB,UAAIf,UAAU,CAACI,OAAf,EAAwB;AACtBC,QAAAA,YAAY,CAACL,UAAU,CAACI,OAAZ,CAAZ;AACD;;AACDP,MAAAA,WAAW,CAAC,KAAD,CAAX;AACD,KALD;;AAOAC,IAAAA,SAAS,CAACkB,gBAAV,CAA2B,OAA3B,EAAoCN,iBAApC;AACAZ,IAAAA,SAAS,CAACkB,gBAAV,CAA2B,SAA3B,EAAsCN,iBAAtC;AACAZ,IAAAA,SAAS,CAACkB,gBAAV,CAA2B,MAA3B,EAAmCD,YAAnC;AAEA,WAAO;AACLjB,MAAAA,SAAS,CAACmB,mBAAV,CAA8B,SAA9B,EAAyCP,iBAAzC;AACAZ,MAAAA,SAAS,CAACmB,mBAAV,CAA8B,OAA9B,EAAuCP,iBAAvC;AACAZ,MAAAA,SAAS,CAACmB,mBAAV,CAA8B,MAA9B,EAAsCF,YAAtC;AACD,KAJD;AAKD,GA5BQ,EA4BN,CAACjB,SAAD,EAAYI,KAAZ,CA5BM,CAAT;AA8BA,SAAO,CAACN,QAAD,EAAWW,QAAX,CAAP;AACD;;;;;"}