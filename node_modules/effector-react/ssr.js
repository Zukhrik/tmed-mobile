function e(e){return e&&'object'==typeof e&&'default'in e?e.default:e}function t(e){effector.is.store(e)||d('expect useStore argument to be a store');let t=e.getState(),r=f.useReducer((e=>e+1),0)[1],n=f.useRef({store:e,value:t,pending:0});return p((()=>{let t=e.updates.watch((e=>{let t=n.current;t.pending||(t.value=e,t.pending=1,r(),t.pending=0)})),o=e.getState(),s=n.current;return s.store===e&&s.value!==o&&(s.value=o,s.pending=1,r(),s.pending=0),s.store=e,t}),[e]),t}function r(e,r){let n,o,s,a;r?(n=r,s=e,a=[]):(n=e.fn,s=e.store,a=e.keys,o=e.updateFilter),effector.is.store(s)||d('useStoreMap expects a store'),Array.isArray(a)||d('useStoreMap expects an array as keys'),'function'!=typeof n&&d('useStoreMap expects a function');let u=f.useMemo((()=>effector.createStore(n(s.getState(),a),{updateFilter:o}).on(s,((e,t)=>n(t,a)))),a),l=t(u);return p((()=>()=>{u.off(s),effector.clearNode(u,{deep:1})}),a),l}function n(e,t){return t.displayName=e,t}function o(e){let t=f.useContext(m);if(!t)throw Error('No scope found, consider adding <Provider> to app root');return t.find(e).meta.wrapped}function s(e,t={}){let r=c(e.open),n=c(e.close),o=c(e.set);((e,t={})=>{let r=f.useRef(null);p((()=>(e.open(r.current),()=>e.close(r.current))),[e]),((e,t)=>{if(e===t)return 1;if('object'==typeof e&&null!==e&&'object'==typeof t&&null!==t){let r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return 0;for(let n=0;n<r.length;n++){let o=r[n];if(e[o]!==t[o])return 0}return 1}return 0})(r.current,t)||(r.current=t,e.set(t))})(f.useMemo((()=>({open:r,close:n,set:o})),[e,r]),t)}function a(e,t){return n(`Connect(${t.displayName||t.name||'Unknown'})`,(r=>f.createElement(t,Object.assign({},r,u(e)))))}function u(e){return t(o(e))}function l(e,t){let r=t.find(e);return effector.is.effect(e)?e=>{let n=(()=>{let e={};return e.req=new Promise(((t,r)=>{e.rs=t,e.rj=r})),e.req.catch((()=>{})),e})();return effector.launch({target:r,params:{params:e,req:n},forkPage:t}),n.req}:e=>(effector.launch({target:r,params:e,forkPage:t}),e)}function c(e){let t=f.useContext(m),r=effector.is.unit(e)||'object'!=typeof e?{event:e}:e;return f.useMemo((()=>{if(effector.is.unit(e))return l(e,t);let r=Array.isArray(e)?[]:{};for(let n in e)r[n]=l(e[n],t);return r}),[t,...Object.keys(r),...Object.values(r)])}Object.defineProperty(exports,'__esModule',{value:1});var i=require('react'),effector=require('effector'),f=e(i);let p='undefined'!=typeof window?f.useLayoutEffect:f.useEffect,d=e=>{throw Error(e)};const m=f.createContext(null);let{Provider:y}=m;exports.Provider=y,exports.connect=e=>t=>a(t,e),exports.createComponent=()=>{throw new Error('not implemented')},exports.createContextComponent=(e,t,r)=>n=>{let o=f.useContext(t),s=u(e);return r(n,s,o)},exports.createGate=e=>{if(!e||!effector.is.domain(e.domain))throw Error('config.domain should exists');return(({name:e="gate",domain:t,defaultState:r,hook:o})=>{function s(e){return o(s,e),null}let a=`${t?`${t.compositeName.fullName}/`:''}${e}`,u=effector.createEvent(`${a}.set`),l=effector.createEvent(`${a}.open`),c=effector.createEvent(`${a}.close`),i=effector.createStore(Boolean(0),{name:`${a}.status`}).on(l,(()=>Boolean(1))).on(c,(()=>Boolean(0))),f=effector.createStore(r,{name:`${a}.state`}).on(u,((e,t)=>t)).reset(c);if(t){let{hooks:e}=t;effector.launch({target:[e.store,e.store,e.event,e.event,e.event],params:[i,f,l,c,u]})}return s.open=l,s.close=c,s.status=i,s.state=f,s.set=u,n(`Gate:${a}`,s)})({domain:e.domain,name:e.name,defaultState:'defaultState'in e?e.defaultState:{},hook:s})},exports.createReactState=a,exports.createStoreConsumer=e=>t=>{let r=u(e);return t.children(r)},exports.useEvent=c,exports.useGate=s,exports.useList=(e,s)=>((e,o)=>{let s,a,u=[];'object'==typeof o&&null!==o?(o.keys&&(u=o.keys),s=o.fn,o.getKey&&(a=o.getKey)):s=o,effector.is.store(e)||d('expect useList first argument to be a store'),'function'!=typeof s&&d("expect useList's renderItem to be a function"),Array.isArray(u)||d("expect useList's keys to be an array");let l=f.useMemo((()=>{let t=n(`${e.shortName||'Unknown'}.Item`,(t=>{let{index:n,keys:o,keyVal:s,value:a}=t;if(c.current[1])return c.current[0](a,s);let u=r({store:e,keys:[n,...o],fn:(e,t)=>e[t[0]]});return c.current[0](u,n)}));return f.memo(t)}),[e,!!a]),c=f.useRef([s,a]);c.current=[s,a];let i=f.useMemo((()=>u),u);if(a)return t(e).map((e=>{let t=c.current[1](e);return f.createElement(l,{keyVal:t,key:t,keys:i,value:e})}));{let t=r({store:e,keys:[e],fn:e=>e.length});return Array.from({length:t},((e,t)=>f.createElement(l,{index:t,key:t,keys:i})))}})(o(e),s),exports.useStore=u,exports.useStoreMap=(e,t)=>t?r(o(e),t):r({store:o(e.store),keys:e.keys,fn:e.fn,updateFilter:e.updateFilter});
//# sourceMappingURL=ssr.js.map
