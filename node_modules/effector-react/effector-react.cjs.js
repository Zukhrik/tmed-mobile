function e(e){return e&&'object'==typeof e&&'default'in e?e.default:e}function t(e){effector.is.store(e)||i('expect useStore argument to be a store');let t=e.getState(),r=l.useReducer((e=>e+1),0)[1],n=l.useRef({store:e,value:t,pending:0});return c((()=>{let t=e.updates.watch((e=>{let t=n.current;t.pending||(t.value=e,t.pending=1,r(),t.pending=0)})),o=e.getState(),a=n.current;return a.store===e&&a.value!==o&&(a.value=o,a.pending=1,r(),a.pending=0),a.store=e,t}),[e]),t}function r(e,r){let n,o,a,s;r?(n=r,a=e,s=[]):(n=e.fn,a=e.store,s=e.keys,o=e.updateFilter),effector.is.store(a)||i('useStoreMap expects a store'),Array.isArray(s)||i('useStoreMap expects an array as keys'),'function'!=typeof n&&i('useStoreMap expects a function');let u=l.useMemo((()=>effector.createStore(n(a.getState(),s),{updateFilter:o}).on(a,((e,t)=>n(t,s)))),s),p=t(u);return c((()=>()=>{u.off(a),effector.clearNode(u,{deep:1})}),s),p}function n(e,t){return t.displayName=e,t}function o(e,r){function o(e){let n=l.useRef(e),o=t(a);c((()=>(u({props:n.current,state:a.getState()}),()=>{p({props:n.current,state:a.getState()})})),[]);let s=r(e,o);return n.current=e,s}let a;effector.is.store(e)?a=e:'object'==typeof e&&null!==e?a=effector.combine(e):i('shape should be a store or object with stores');let s='Unknown';a&&a.shortName&&(s=a.shortName);let u=effector.createEvent(),p=effector.createEvent();return o.mounted=u,o.unmounted=p,n(`${s}.View`,o)}function a(e,r){return n(`Connect(${r.displayName||r.name||'Unknown'})`,(n=>l.createElement(r,Object.assign({},n,t(e)))))}function s(e,t={}){let r=l.useRef(null);c((()=>(e.open(r.current),()=>e.close(r.current))),[e]),((e,t)=>{if(e===t)return 1;if('object'==typeof e&&null!==e&&'object'==typeof t&&null!==t){let r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return 0;for(let n=0;n<r.length;n++){let o=r[n];if(e[o]!==t[o])return 0}return 1}return 0})(r.current,t)||(r.current=t,e.set(t))}Object.defineProperty(exports,'__esModule',{value:1});var u=require('react'),effector=require('effector'),l=e(u);let c='undefined'!=typeof window?l.useLayoutEffect:l.useEffect,i=e=>{throw Error(e)};exports.connect=e=>t=>{let r=e;return'function'!=typeof e&&(r=t,t=e),a(t,r)},exports.createComponent=o,exports.createContextComponent=(e,r,o)=>n(`${e.shortName||'Unknown'}.ContextComponent`,(n=>{let a=l.useContext(r),s=t(e);return o(n,s,a)})),exports.createGate=(e="gate",t={})=>{let r;return'object'==typeof e&&null!==e&&('defaultState'in e&&(t=e.defaultState),e.domain&&(r=e.domain),e=e.name),(({name:e="gate",domain:t,defaultState:r,hook:o})=>{function a(e){return o(a,e),null}let s=`${t?`${t.compositeName.fullName}/`:''}${e}`,u=effector.createEvent(`${s}.set`),l=effector.createEvent(`${s}.open`),c=effector.createEvent(`${s}.close`),i=effector.createStore(Boolean(0),{name:`${s}.status`}).on(l,(()=>Boolean(1))).on(c,(()=>Boolean(0))),p=effector.createStore(r,{name:`${s}.state`}).on(u,((e,t)=>t)).reset(c);if(t){let{hooks:e}=t;effector.launch({target:[e.store,e.store,e.event,e.event,e.event],params:[i,p,l,c,u]})}return a.open=l,a.close=c,a.status=i,a.state=p,a.set=u,n(`Gate:${s}`,a)})({name:e,domain:r,defaultState:t,hook:s})},exports.createReactState=a,exports.createStoreConsumer=e=>o(e,(({children:e},t)=>e(t))),exports.useEvent=e=>e,exports.useGate=s,exports.useList=(e,o)=>{let a,s,u=[];'object'==typeof o&&null!==o?(o.keys&&(u=o.keys),a=o.fn,o.getKey&&(s=o.getKey)):a=o,effector.is.store(e)||i('expect useList first argument to be a store'),'function'!=typeof a&&i("expect useList's renderItem to be a function"),Array.isArray(u)||i("expect useList's keys to be an array");let c=l.useMemo((()=>{let t=n(`${e.shortName||'Unknown'}.Item`,(t=>{let{index:n,keys:o,keyVal:a,value:s}=t;if(p.current[1])return p.current[0](s,a);let u=r({store:e,keys:[n,...o],fn:(e,t)=>e[t[0]]});return p.current[0](u,n)}));return l.memo(t)}),[e,!!s]),p=l.useRef([a,s]);p.current=[a,s];let f=l.useMemo((()=>u),u);if(s)return t(e).map((e=>{let t=p.current[1](e);return l.createElement(c,{keyVal:t,key:t,keys:f,value:e})}));{let t=r({store:e,keys:[e],fn:e=>e.length});return Array.from({length:t},((e,t)=>l.createElement(c,{index:t,key:t,keys:f})))}},exports.useStore=t,exports.useStoreMap=r;
//# sourceMappingURL=effector-react.cjs.js.map
