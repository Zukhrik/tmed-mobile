function e(e){i.store(e)||h('expect useStore argument to be a store');let t=e.getState(),n=f.useReducer((e=>e+1),0)[1],r=f.useRef({store:e,value:t,pending:0});return k((()=>{let t=e.updates.watch((e=>{let t=r.current;t.pending||(t.value=e,t.pending=1,n(),t.pending=0)})),o=e.getState(),u=r.current;return u.store===e&&u.value!==o&&(u.value=o,u.pending=1,n(),u.pending=0),u.store=e,t}),[e]),t}function t(t,n){let r,o,u,s;n?(r=n,u=t,s=[]):(r=t.fn,u=t.store,s=t.keys,o=t.updateFilter),i.store(u)||h('useStoreMap expects a store'),Array.isArray(s)||h('useStoreMap expects an array as keys'),'function'!=typeof r&&h('useStoreMap expects a function');let a=f.useMemo((()=>p(r(u.getState(),s),{updateFilter:o}).on(u,((e,t)=>r(t,s)))),s),l=e(a);return k((()=>()=>{a.off(u),m(a,{deep:1})}),s),l}function n(e,t){return t.displayName=e,t}function r(t,r){function o(t){let n=f.useRef(t),o=e(u);k((()=>(a({props:n.current,state:u.getState()}),()=>{l({props:n.current,state:u.getState()})})),[]);let s=r(t,o);return n.current=t,s}let u;i.store(t)?u=t:'object'==typeof t&&null!==t?u=y(t):h('shape should be a store or object with stores');let s='Unknown';u&&u.shortName&&(s=u.shortName);let a=d(),l=d();return o.mounted=a,o.unmounted=l,n(`${s}.View`,o)}function o(e){return r(e,(({children:e},t)=>e(t)))}function u(r,o){let u,s,a=[];'object'==typeof o&&null!==o?(o.keys&&(a=o.keys),u=o.fn,o.getKey&&(s=o.getKey)):u=o,i.store(r)||h('expect useList first argument to be a store'),'function'!=typeof u&&h("expect useList's renderItem to be a function"),Array.isArray(a)||h("expect useList's keys to be an array");let l=f.useMemo((()=>{let e=n(`${r.shortName||'Unknown'}.Item`,(e=>{let{index:n,keys:o,keyVal:u,value:s}=e;if(c.current[1])return c.current[0](s,u);let a=t({store:r,keys:[n,...o],fn:(e,t)=>e[t[0]]});return c.current[0](a,n)}));return f.memo(e)}),[r,!!s]),c=f.useRef([u,s]);c.current=[u,s];let p=f.useMemo((()=>a),a);if(s)return e(r).map((e=>{let t=c.current[1](e);return f.createElement(l,{keyVal:t,key:t,keys:p,value:e})}));{let e=t({store:r,keys:[r],fn:e=>e.length});return Array.from({length:e},((e,t)=>f.createElement(l,{index:t,key:t,keys:p})))}}function s(t,r){return n(`Connect(${r.displayName||r.name||'Unknown'})`,(n=>f.createElement(r,Object.assign({},n,e(t)))))}function a(e,t={}){let n=f.useRef(null);k((()=>(e.open(n.current),()=>e.close(n.current))),[e]),((e,t)=>{if(e===t)return 1;if('object'==typeof e&&null!==e&&'object'==typeof t&&null!==t){let n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return 0;for(let r=0;r<n.length;r++){let o=n[r];if(e[o]!==t[o])return 0}return 1}return 0})(n.current,t)||(n.current=t,e.set(t))}function l(e="gate",t={}){let r;return'object'==typeof e&&null!==e&&('defaultState'in e&&(t=e.defaultState),e.domain&&(r=e.domain),e=e.name),(({name:e="gate",domain:t,defaultState:r,hook:o})=>{function u(e){return o(u,e),null}let s=`${t?`${t.compositeName.fullName}/`:''}${e}`,a=d(`${s}.set`),l=d(`${s}.open`),c=d(`${s}.close`),f=p(Boolean(0),{name:`${s}.status`}).on(l,(()=>Boolean(1))).on(c,(()=>Boolean(0))),i=p(r,{name:`${s}.state`}).on(a,((e,t)=>t)).reset(c);if(t){let{hooks:e}=t;g({target:[e.store,e.store,e.event,e.event,e.event],params:[f,i,l,c,a]})}return u.open=l,u.close=c,u.status=f,u.state=i,u.set=a,n(`Gate:${s}`,u)})({name:e,domain:r,defaultState:t,hook:a})}function c(e){return e}import f from'react';import{is as i,createStore as p,clearNode as m,combine as y,createEvent as d,launch as g}from'effector/effector.mjs';let k='undefined'!=typeof window?f.useLayoutEffect:f.useEffect,h=e=>{throw Error(e)},b=(t,r,o)=>n(`${t.shortName||'Unknown'}.ContextComponent`,(n=>{let u=f.useContext(r),s=e(t);return o(n,s,u)})),S=e=>t=>{let n=e;return'function'!=typeof e&&(n=t,t=e),s(t,n)};export{S as connect,r as createComponent,b as createContextComponent,l as createGate,s as createReactState,o as createStoreConsumer,c as useEvent,a as useGate,u as useList,e as useStore,t as useStoreMap};
//# sourceMappingURL=effector-react.mjs.map
