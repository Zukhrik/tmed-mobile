function e(e){k.store(e)||w('expect useStore argument to be a store');let t=e.getState(),r=g.useReducer((e=>e+1),0)[1],n=g.useRef({store:e,value:t,pending:0});return S((()=>{let t=e.updates.watch((e=>{let t=n.current;t.pending||(t.value=e,t.pending=1,r(),t.pending=0)})),o=e.getState(),u=n.current;return u.store===e&&u.value!==o&&(u.value=o,u.pending=1,r(),u.pending=0),u.store=e,t}),[e]),t}function t(t,r){let n,o,u,s;r?(n=r,u=t,s=[]):(n=t.fn,u=t.store,s=t.keys,o=t.updateFilter),k.store(u)||w('useStoreMap expects a store'),Array.isArray(s)||w('useStoreMap expects an array as keys'),'function'!=typeof n&&w('useStoreMap expects a function');let a=g.useMemo((()=>h(n(u.getState(),s),{updateFilter:o}).on(u,((e,t)=>n(t,s)))),s),l=e(a);return S((()=>()=>{a.off(u),x(a,{deep:1})}),s),l}function r(e,t){return t.displayName=e,t}function n(e){let t=g.useContext(j);if(!t)throw Error('No scope found, consider adding <Provider> to app root');return t.find(e).meta.wrapped}function o(e){if(!e||!k.domain(e.domain))throw Error('config.domain should exists');return(({name:e="gate",domain:t,defaultState:n,hook:o})=>{function u(e){return o(u,e),null}let s=`${t?`${t.compositeName.fullName}/`:''}${e}`,a=b(`${s}.set`),l=b(`${s}.open`),i=b(`${s}.close`),f=h(Boolean(0),{name:`${s}.status`}).on(l,(()=>Boolean(1))).on(i,(()=>Boolean(0))),c=h(n,{name:`${s}.state`}).on(a,((e,t)=>t)).reset(i);if(t){let{hooks:e}=t;v({target:[e.store,e.store,e.event,e.event,e.event],params:[f,c,l,i,a]})}return u.open=l,u.close=i,u.status=f,u.state=c,u.set=a,r(`Gate:${s}`,u)})({domain:e.domain,name:e.name,defaultState:'defaultState'in e?e.defaultState:{},hook:u})}function u(e,t={}){let r=y(e.open),n=y(e.close),o=y(e.set);((e,t={})=>{let r=g.useRef(null);S((()=>(e.open(r.current),()=>e.close(r.current))),[e]),((e,t)=>{if(e===t)return 1;if('object'==typeof e&&null!==e&&'object'==typeof t&&null!==t){let r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return 0;for(let n=0;n<r.length;n++){let o=r[n];if(e[o]!==t[o])return 0}return 1}return 0})(r.current,t)||(r.current=t,e.set(t))})(g.useMemo((()=>({open:r,close:n,set:o})),[e,r]),t)}function s(e){return t=>{let r=c(e);return t.children(r)}}function a(e,t,r){return n=>{let o=g.useContext(t),u=c(e);return r(n,u,o)}}function l(){throw new Error('not implemented')}function i(e,t){return r(`Connect(${t.displayName||t.name||'Unknown'})`,(r=>g.createElement(t,Object.assign({},r,c(e)))))}function f(e){return t=>i(t,e)}function c(t){return e(n(t))}function p(o,u){return((n,o)=>{let u,s,a=[];'object'==typeof o&&null!==o?(o.keys&&(a=o.keys),u=o.fn,o.getKey&&(s=o.getKey)):u=o,k.store(n)||w('expect useList first argument to be a store'),'function'!=typeof u&&w("expect useList's renderItem to be a function"),Array.isArray(a)||w("expect useList's keys to be an array");let l=g.useMemo((()=>{let e=r(`${n.shortName||'Unknown'}.Item`,(e=>{let{index:r,keys:o,keyVal:u,value:s}=e;if(i.current[1])return i.current[0](s,u);let a=t({store:n,keys:[r,...o],fn:(e,t)=>e[t[0]]});return i.current[0](a,r)}));return g.memo(e)}),[n,!!s]),i=g.useRef([u,s]);i.current=[u,s];let f=g.useMemo((()=>a),a);if(s)return e(n).map((e=>{let t=i.current[1](e);return g.createElement(l,{keyVal:t,key:t,keys:f,value:e})}));{let e=t({store:n,keys:[n],fn:e=>e.length});return Array.from({length:e},((e,t)=>g.createElement(l,{index:t,key:t,keys:f})))}})(n(o),u)}function m(e,r){return r?t(n(e),r):t({store:n(e.store),keys:e.keys,fn:e.fn,updateFilter:e.updateFilter})}function d(e,t){let r=t.find(e);return k.effect(e)?e=>{let n=(()=>{let e={};return e.req=new Promise(((t,r)=>{e.rs=t,e.rj=r})),e.req.catch((()=>{})),e})();return v({target:r,params:{params:e,req:n},forkPage:t}),n.req}:e=>(v({target:r,params:e,forkPage:t}),e)}function y(e){let t=g.useContext(j),r=k.unit(e)||'object'!=typeof e?{event:e}:e;return g.useMemo((()=>{if(k.unit(e))return d(e,t);let r=Array.isArray(e)?[]:{};for(let n in e)r[n]=d(e[n],t);return r}),[t,...Object.keys(r),...Object.values(r)])}import g from'react';import{is as k,createStore as h,clearNode as x,createEvent as b,launch as v}from'effector/effector.mjs';let S='undefined'!=typeof window?g.useLayoutEffect:g.useEffect,w=e=>{throw Error(e)};const j=g.createContext(null);let{Provider:$}=j;export{$ as Provider,f as connect,l as createComponent,a as createContextComponent,o as createGate,i as createReactState,s as createStoreConsumer,y as useEvent,u as useGate,p as useList,c as useStore,m as useStoreMap};
//# sourceMappingURL=ssr.mjs.map
